<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MD Planner</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;600;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Roboto', 'system-ui', 'sans-serif'],
                        mono: ['Roboto Mono', 'monospace'],
                    },
                    colors: {
                        primary: '#111827',
                        secondary: '#6b7280'
                    }
                }
            }
        }
    </script>
    <!-- External CSS (new theme system) -->
    <link rel="stylesheet" href="/css/index.css">
</head>
<body class="bg-gray-100 dark:bg-gray-900 min-h-screen transition-colors">
    <!-- Skip Link for Keyboard Navigation -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Header -->
    <header class="bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800">
        <div class="max-w-7xl mx-auto px-4">
            <!-- Mobile header -->
            <div class="flex items-center justify-between h-14 lg:hidden">
                <h1 class="text-base font-semibold text-gray-900 dark:text-gray-100">MD Planner</h1>
                <div class="flex items-center gap-2">
                    <button id="addTaskBtnMobile" class="btn-primary px-3 py-1.5">+</button>
                    <button id="mobileMenuToggle" class="p-2 text-gray-600 dark:text-gray-400">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Desktop header - Row 1: Logo, Project, Actions -->
            <div class="hidden lg:flex items-center justify-between h-12">
                <div class="flex items-center gap-4">
                    <h1 class="text-base font-semibold text-gray-900 dark:text-gray-100">MD Planner</h1>
                    <span id="currentViewLabel" class="hidden">Summary</span>
                    <select id="projectSelector" class="text-sm bg-gray-100 dark:bg-gray-800 border-0 rounded px-2 py-1 text-gray-700 dark:text-gray-300 focus:outline-none focus:ring-1 focus:ring-gray-400 cursor-pointer max-w-[200px]">
                        <option value="">Loading...</option>
                    </select>
                </div>

                <!-- Right: Actions -->
                <div class="flex items-center gap-2">
                    <!-- Search -->
                    <div class="relative">
                        <input type="text" id="searchInput" placeholder="Search..." class="w-40 pl-8 pr-3 py-1.5 text-sm bg-gray-100 dark:bg-gray-800 border-0 rounded text-gray-900 dark:text-gray-100 placeholder-gray-400 focus:outline-none focus:ring-1 focus:ring-gray-300 dark:focus:ring-gray-600">
                        <svg class="absolute left-2.5 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                    </div>

                    <!-- Pomodoro -->
                    <div class="relative">
                        <button id="pomodoroBtn" class="p-2 flex items-center justify-center gap-1.5 text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white" title="Pomodoro">
                            <svg class="w-5 h-5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                            <span id="pomodoroDisplay" class="text-xs font-mono font-medium hidden">25:00</span>
                        </button>
                        <div id="pomodoroDropdown" class="absolute right-0 mt-2 w-56 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 hidden z-50 p-4">
                            <div class="flex justify-center mb-2">
                                <span class="help-tip" data-tip="Pomodoro: 25 min focus, then 5 min short break. After 4 cycles, take a 15 min long break.">?</span>
                            </div>
                            <div class="text-center mb-4">
                                <div id="pomodoroTimer" class="text-3xl font-mono font-bold text-gray-900 dark:text-gray-100">25:00</div>
                                <div id="pomodoroLabel" class="text-xs text-gray-500 dark:text-gray-400 mt-1">Focus Time</div>
                            </div>
                            <div class="flex justify-center gap-2 mb-3">
                                <button id="pomodoroStartBtn" class="btn-primary">Start</button>
                                <button id="pomodoroStopBtn" class="btn-primary hidden">Stop</button>
                            </div>
                            <div class="flex justify-center gap-1 mb-3">
                                <button id="pomodoroFocusBtn" class="px-2 py-1 rounded text-xs font-medium bg-gray-900 text-white dark:bg-white dark:text-gray-900">Focus</button>
                                <button id="pomodoroShortBtn" class="px-2 py-1 rounded text-xs text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700">Short</button>
                                <button id="pomodoroLongBtn" class="px-2 py-1 rounded text-xs text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700">Long</button>
                                <button id="pomodoroDebugBtn" class="px-2 py-1 rounded text-xs text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700">5s</button>
                            </div>
                            <div class="text-center text-xs text-gray-400"><span id="pomodoroCount">0</span> completed</div>
                            <div class="flex items-center justify-center gap-2 mt-3 pt-3 border-t border-gray-100 dark:border-gray-700">
                                <label class="flex items-center gap-1.5 text-xs text-gray-500 dark:text-gray-400 cursor-pointer">
                                    <input type="checkbox" id="pomodoroSoundToggle" class="rounded border-gray-300 w-3 h-3"> Sound
                                </label>
                            </div>
                            <div id="pomodoroNotifStatus" class="text-center text-xs mt-2"></div>
                        </div>
                    </div>

                    <!-- Import/Export -->
                    <div class="relative">
                        <button id="importExportBtn" class="p-2 text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white" title="Import/Export">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"></path></svg>
                        </button>
                        <div id="importExportDropdown" class="absolute right-0 mt-2 w-40 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 hidden z-50 py-1">
                            <button id="exportTasksBtn" class="w-full text-left px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">Export CSV</button>
                            <button id="importTasksBtn" class="w-full text-left px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">Import CSV</button>
                            <button id="exportReportBtn" class="w-full text-left px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">Export PDF</button>
                        </div>
                    </div>

                    <!-- Dark mode -->
                    <button id="darkModeToggle" class="p-2 text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white" title="Toggle theme">
                        <svg class="w-5 h-5 dark:hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>
                        <svg class="w-5 h-5 hidden dark:block" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                    </button>

                    <!-- Fullscreen -->
                    <button id="fullscreenToggle" class="p-2 text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white" title="Fullscreen">
                        <svg id="fullscreenIcon" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"></path></svg>
                        <svg id="exitFullscreenIcon" class="w-5 h-5 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 9V4.5M9 9H4.5M9 9L3.5 3.5M15 9h4.5M15 9V4.5M15 9l5.5-5.5M9 15H4.5M9 15v4.5M9 15l-5.5 5.5M15 15h4.5M15 15v4.5m0-4.5l5.5 5.5"></path></svg>
                    </button>

                    <!-- Help -->
                    <button id="helpBtn" class="p-2 text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white" title="Help (?)">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    </button>

                    <!-- Settings -->
                    <button id="configViewBtn" class="p-2 text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white" title="Settings">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                    </button>

                    <!-- Add Task -->
                    <button id="addTaskBtn" class="btn-primary">+ Task</button>
                </div>
            </div>

            <!-- Desktop header - Row 2: Category Navigation -->
            <div class="hidden lg:flex items-center gap-1 h-10 border-t border-gray-100 dark:border-gray-800">
                <!-- Tasks -->
                <div class="relative nav-dropdown">
                    <button class="nav-dropdown-btn flex items-center gap-1 px-3 py-1.5 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white rounded hover:bg-gray-100 dark:hover:bg-gray-800">
                        Tasks
                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="nav-dropdown-menu absolute left-0 mt-1 w-36 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 hidden z-50 py-1">
                        <button id="summaryViewBtn" data-view="summary" class="w-full text-left px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">Summary</button>
                        <button id="listViewBtn" data-view="list" class="w-full text-left px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">List</button>
                        <button id="boardViewBtn" data-view="board" class="w-full text-left px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">Board</button>
                        <button id="timelineViewBtn" data-view="timeline" class="w-full text-left px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">Timeline</button>
                    </div>
                </div>

                <!-- Planning -->
                <div class="relative nav-dropdown">
                    <button class="nav-dropdown-btn flex items-center gap-1 px-3 py-1.5 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white rounded hover:bg-gray-100 dark:hover:bg-gray-800">
                        Planning
                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="nav-dropdown-menu absolute left-0 mt-1 w-40 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 hidden z-50 py-1">
                        <button id="goalsViewBtn" data-view="goals" class="w-full text-left px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">Goals</button>
                        <button id="milestonesViewBtn" data-view="milestones" class="w-full text-left px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">Milestones</button>
                        <button id="ideasViewBtn" data-view="ideas" class="w-full text-left px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">Ideas</button>
                        <button id="retrospectivesViewBtn" data-view="retrospectives" class="w-full text-left px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">Retrospectives</button>
                    </div>
                </div>

                <!-- Analysis -->
                <div class="relative nav-dropdown">
                    <button class="nav-dropdown-btn flex items-center gap-1 px-3 py-1.5 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white rounded hover:bg-gray-100 dark:hover:bg-gray-800">
                        Analysis
                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="nav-dropdown-menu absolute left-0 mt-1 w-40 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 hidden z-50 py-1">
                        <button id="swotViewBtn" data-view="swot" class="w-full text-left px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">SWOT</button>
                        <button id="riskAnalysisViewBtn" data-view="riskAnalysis" class="w-full text-left px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">Risk</button>
                        <button id="leanCanvasViewBtn" data-view="leanCanvas" class="w-full text-left px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">Lean Canvas</button>
                        <button id="businessModelViewBtn" data-view="businessModel" class="w-full text-left px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">Business Model</button>
                        <button id="projectValueViewBtn" data-view="projectValue" class="w-full text-left px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">Value Board</button>
                        <button id="briefViewBtn" data-view="brief" class="w-full text-left px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">Brief</button>
                    </div>
                </div>

                <!-- Diagrams -->
                <div class="relative nav-dropdown">
                    <button class="nav-dropdown-btn flex items-center gap-1 px-3 py-1.5 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white rounded hover:bg-gray-100 dark:hover:bg-gray-800">
                        Diagrams
                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="nav-dropdown-menu absolute left-0 mt-1 w-40 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 hidden z-50 py-1">
                        <button id="canvasViewBtn" data-view="canvas" class="w-full text-left px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">Canvas</button>
                        <button id="mindmapViewBtn" data-view="mindmap" class="w-full text-left px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">Mindmap</button>
                        <button id="c4ViewBtn" data-view="c4" class="w-full text-left px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">C4 Architecture</button>
                    </div>
                </div>

                <!-- Resources -->
                <div class="relative nav-dropdown">
                    <button class="nav-dropdown-btn flex items-center gap-1 px-3 py-1.5 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white rounded hover:bg-gray-100 dark:hover:bg-gray-800">
                        Resources
                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="nav-dropdown-menu absolute left-0 mt-1 w-40 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 hidden z-50 py-1">
                        <button id="timeTrackingViewBtn" data-view="timeTracking" class="w-full text-left px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">Time Tracking</button>
                        <button id="capacityViewBtn" data-view="capacity" class="w-full text-left px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">Capacity</button>
                        <button id="billingViewBtn" data-view="billing" class="w-full text-left px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">Billing</button>
                        <button id="crmViewBtn" data-view="crm" class="w-full text-left px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">CRM</button>
                    </div>
                </div>

                <!-- Other -->
                <div class="relative nav-dropdown">
                    <button class="nav-dropdown-btn flex items-center gap-1 px-3 py-1.5 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white rounded hover:bg-gray-100 dark:hover:bg-gray-800">
                        Other
                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="nav-dropdown-menu absolute left-0 mt-1 w-40 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 hidden z-50 py-1">
                        <button id="notesViewBtn" data-view="notes" class="w-full text-left px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">Notes</button>
                        <button id="strategicLevelsViewBtn" data-view="strategicLevels" class="w-full text-left px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">Strategic Levels</button>
                    </div>
                </div>

                <!-- Portfolio - Top level button -->
                <button id="portfolioViewBtn" data-view="portfolio" class="px-3 py-1.5 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white rounded hover:bg-gray-100 dark:hover:bg-gray-800">
                    Portfolio
                </button>
            </div>
        </div>

        <!-- Mobile menu -->
        <div id="mobileMenu" class="hidden lg:hidden border-t border-gray-200 dark:border-gray-800 bg-white dark:bg-gray-900 max-h-[80vh] overflow-y-auto">
            <div class="py-2">
                <!-- Project selector -->
                <div class="px-4 py-2 border-b border-gray-100 dark:border-gray-800">
                    <select id="projectSelectorMobile" class="w-full text-sm bg-gray-100 dark:bg-gray-800 border-0 rounded px-3 py-2 text-gray-900 dark:text-gray-100">
                        <option value="">Loading...</option>
                    </select>
                </div>

                <!-- Search -->
                <div class="px-4 py-2 border-b border-gray-100 dark:border-gray-800">
                    <input type="text" id="searchInputMobile" placeholder="Search tasks..." class="w-full text-sm bg-gray-100 dark:bg-gray-800 border-0 rounded px-3 py-2 text-gray-900 dark:text-gray-100 placeholder-gray-400">
                </div>

                <!-- Navigation -->
                <div class="py-1">
                    <div class="px-4 py-1 text-xs font-medium text-gray-400 dark:text-gray-500 uppercase">Tasks</div>
                    <button id="summaryViewBtnMobile" class="w-full text-left px-4 py-2.5 text-sm text-gray-900 dark:text-white bg-gray-100 dark:bg-gray-800">Summary</button>
                    <button id="listViewBtnMobile" class="w-full text-left px-4 py-2.5 text-sm text-gray-600 dark:text-gray-300">List</button>
                    <button id="boardViewBtnMobile" class="w-full text-left px-4 py-2.5 text-sm text-gray-600 dark:text-gray-300">Board</button>
                    <button id="timelineViewBtnMobile" class="w-full text-left px-4 py-2.5 text-sm text-gray-600 dark:text-gray-300">Timeline</button>
                </div>
                <div class="py-1 border-t border-gray-100 dark:border-gray-800">
                    <div class="px-4 py-1 text-xs font-medium text-gray-400 dark:text-gray-500 uppercase">Planning</div>
                    <button id="goalsViewBtnMobile" class="w-full text-left px-4 py-2.5 text-sm text-gray-600 dark:text-gray-300">Goals</button>
                    <button id="milestonesViewBtnMobile" class="w-full text-left px-4 py-2.5 text-sm text-gray-600 dark:text-gray-300">Milestones</button>
                    <button id="ideasViewBtnMobile" class="w-full text-left px-4 py-2.5 text-sm text-gray-600 dark:text-gray-300">Ideas</button>
                    <button id="retrospectivesViewBtnMobile" class="w-full text-left px-4 py-2.5 text-sm text-gray-600 dark:text-gray-300">Retrospectives</button>
                </div>
                <div class="py-1 border-t border-gray-100 dark:border-gray-800">
                    <div class="px-4 py-1 text-xs font-medium text-gray-400 dark:text-gray-500 uppercase">Analysis</div>
                    <button id="swotViewBtnMobile" class="w-full text-left px-4 py-2.5 text-sm text-gray-600 dark:text-gray-300">SWOT</button>
                    <button id="riskAnalysisViewBtnMobile" class="w-full text-left px-4 py-2.5 text-sm text-gray-600 dark:text-gray-300">Risk</button>
                    <button id="leanCanvasViewBtnMobile" class="w-full text-left px-4 py-2.5 text-sm text-gray-600 dark:text-gray-300">Lean Canvas</button>
                    <button id="businessModelViewBtnMobile" class="w-full text-left px-4 py-2.5 text-sm text-gray-600 dark:text-gray-300">Business Model</button>
                    <button id="projectValueViewBtnMobile" class="w-full text-left px-4 py-2.5 text-sm text-gray-600 dark:text-gray-300">Value Board</button>
                    <button id="briefViewBtnMobile" class="w-full text-left px-4 py-2.5 text-sm text-gray-600 dark:text-gray-300">Brief</button>
                </div>
                <div class="py-1 border-t border-gray-100 dark:border-gray-800">
                    <div class="px-4 py-1 text-xs font-medium text-gray-400 dark:text-gray-500 uppercase">Diagrams</div>
                    <button id="canvasViewBtnMobile" class="w-full text-left px-4 py-2.5 text-sm text-gray-600 dark:text-gray-300">Canvas</button>
                    <button id="mindmapViewBtnMobile" class="w-full text-left px-4 py-2.5 text-sm text-gray-600 dark:text-gray-300">Mindmap</button>
                    <button id="c4ViewBtnMobile" class="w-full text-left px-4 py-2.5 text-sm text-gray-600 dark:text-gray-300">C4 Architecture</button>
                </div>
                <div class="py-1 border-t border-gray-100 dark:border-gray-800">
                    <div class="px-4 py-1 text-xs font-medium text-gray-400 dark:text-gray-500 uppercase">Resources</div>
                    <button id="timeTrackingViewBtnMobile" class="w-full text-left px-4 py-2.5 text-sm text-gray-600 dark:text-gray-300">Time Tracking</button>
                    <button id="capacityViewBtnMobile" class="w-full text-left px-4 py-2.5 text-sm text-gray-600 dark:text-gray-300">Capacity</button>
                    <button id="billingViewBtnMobile" class="w-full text-left px-4 py-2.5 text-sm text-gray-600 dark:text-gray-300">Billing</button>
                    <button id="crmViewBtnMobile" class="w-full text-left px-4 py-2.5 text-sm text-gray-600 dark:text-gray-300">CRM</button>
                </div>
                <div class="py-1 border-t border-gray-100 dark:border-gray-800">
                    <div class="px-4 py-1 text-xs font-medium text-gray-400 dark:text-gray-500 uppercase">Other</div>
                    <button id="notesViewBtnMobile" class="w-full text-left px-4 py-2.5 text-sm text-gray-600 dark:text-gray-300">Notes</button>
                    <button id="strategicLevelsViewBtnMobile" class="w-full text-left px-4 py-2.5 text-sm text-gray-600 dark:text-gray-300">Strategic Levels</button>
                    <button id="portfolioViewBtnMobile" class="w-full text-left px-4 py-2.5 text-sm text-gray-600 dark:text-gray-300">Portfolio</button>
                    <button id="configViewBtnMobile" class="w-full text-left px-4 py-2.5 text-sm text-gray-600 dark:text-gray-300">Settings</button>
                    <button id="helpBtnMobile" class="w-full text-left px-4 py-2.5 text-sm text-gray-600 dark:text-gray-300">Help</button>
                </div>
                <!-- Quick Actions -->
                <div class="py-2 px-4 border-t border-gray-100 dark:border-gray-800 flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <button id="darkModeToggleMobile" class="p-2 text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800" title="Toggle theme">
                            <svg class="w-5 h-5 dark:hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>
                            <svg class="w-5 h-5 hidden dark:block" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                        </button>
                        <button id="pomodoroBtnMobile" class="p-2 text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800" title="Pomodoro">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        </button>
                        <button id="importExportBtnMobile" class="p-2 text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800" title="Import/Export">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"></path></svg>
                        </button>
                    </div>
                    <span class="text-xs text-gray-400">v1.0</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main id="main-content" class="max-w-7xl mx-auto px-2 sm:px-4 lg:px-8 py-4 sm:py-8 pb-16">
        <!-- Breadcrumb Navigation -->
        <div id="breadcrumb"></div>

        <!-- Loading State -->
        <div id="loading" class="flex justify-center items-center h-64">
            <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary"></div>
        </div>

        <!-- Portfolio View -->
        <div id="portfolioView" class="hidden pb-16">
            <!-- Summary Cards -->
            <div id="portfolioSummaryCards" class="grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                <!-- Cards rendered by JS -->
            </div>

            <!-- Filter Bar -->
            <div id="portfolioFilterBar" class="flex flex-wrap items-center gap-2 mb-4">
                <!-- Filters rendered by JS -->
            </div>

            <!-- Project Grid -->
            <div id="portfolioGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <!-- Cards rendered by JS -->
            </div>

            <!-- Empty State -->
            <div id="portfolioEmpty" class="hidden text-center py-12">
                <svg class="w-16 h-16 mx-auto text-gray-300 dark:text-gray-600 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
                </svg>
                <p class="text-gray-500 dark:text-gray-400 text-lg mb-2">No projects found</p>
                <p class="text-gray-400 dark:text-gray-500 text-sm">Create a new project to get started</p>
            </div>
        </div>

        <!-- Summary View -->
        <div id="summaryView" class="hidden pb-16">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 lg:gap-8">
                <!-- Project Info -->
                <div class="lg:col-span-2 space-y-4">
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-4 sm:p-6">
                        <div class="flex flex-wrap items-start justify-between gap-3 mb-4">
                            <h2 id="projectName" class="text-xl sm:text-2xl font-bold text-gray-900 dark:text-gray-100">Project Name</h2>
                            <div class="flex items-center gap-1">
                                <select id="projectStatus" class="text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-2 py-1 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                                    <option value="active">Active</option>
                                    <option value="on-track">On Track</option>
                                    <option value="at-risk">At Risk</option>
                                    <option value="late">Late</option>
                                    <option value="on-hold">On Hold</option>
                                    <option value="completed">Completed</option>
                                </select>
                                <span class="help-tip" data-tip="Track your project health. On Track = progressing well, At Risk = potential issues, Late = behind schedule.">?</span>
                            </div>
                        </div>
                        <div id="projectStatusComment" class="hidden mb-4">
                            <textarea id="statusCommentText" rows="2" placeholder="Status comment (optional)" class="w-full text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent"></textarea>
                        </div>
                        <div id="projectDescription" class="prose prose-gray dark:prose-invert max-w-none">
                            <p class="text-gray-600 dark:text-gray-400">Loading project description...</p>
                        </div>

                        <!-- Project Dates -->
                        <div class="mt-4 pt-4 border-t border-gray-200 dark:border-gray-700 flex flex-wrap gap-4 text-sm text-gray-600 dark:text-gray-400">
                            <div>
                                <span class="font-medium">Started:</span>
                                <span id="summaryStartDate">-</span>
                            </div>
                            <div>
                                <span class="font-medium">Last Updated:</span>
                                <span id="summaryLastUpdated">-</span>
                            </div>
                        </div>
                    </div>

                    <!-- Useful Links -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-4 sm:p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100">Useful Links</h3>
                            <button id="addLinkBtn" class="text-sm text-gray-900 dark:text-gray-100 hover:text-gray-600 dark:hover:text-gray-300 underline">+ Add Link</button>
                        </div>
                        <div id="projectLinks" class="space-y-2">
                            <p class="text-sm text-gray-500 dark:text-gray-400 italic">No links added yet.</p>
                        </div>

                        <!-- Add Link Form (hidden by default) -->
                        <div id="addLinkForm" class="hidden mt-4 pt-4 border-t border-gray-200 dark:border-gray-700">
                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                                <input type="text" id="linkTitle" placeholder="Title" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                                <input type="url" id="linkUrl" placeholder="https://..." class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                            </div>
                            <div class="flex justify-end gap-2 mt-3">
                                <button id="cancelLinkBtn" type="button" class="px-3 py-1.5 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200">Cancel</button>
                                <button id="saveLinkBtn" type="button" class="px-3 py-1.5 text-sm bg-gray-900 text-white rounded-md hover:bg-gray-700 dark:bg-gray-600 dark:text-white dark:hover:bg-gray-500">Save</button>
                            </div>
                        </div>
                    </div>

                    <!-- Task Deadlines -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-4 sm:p-6">
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">Task Deadlines</h3>
                        <div id="taskDeadlines" class="space-y-4">
                            <p class="text-sm text-gray-500 dark:text-gray-400 italic">No upcoming deadlines.</p>
                        </div>
                    </div>
                </div>

                <!-- Project Stats -->
                <div class="space-y-4 sm:space-y-6">
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-4 sm:p-6">
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">Task Overview</h3>
                        <div class="space-y-4">
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-600 dark:text-gray-400">Total Tasks</span>
                                <span id="totalTasks" class="text-lg font-semibold text-gray-900 dark:text-gray-100">0</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-600 dark:text-gray-400">Completed</span>
                                <span id="completedTasks" class="text-lg font-semibold text-green-600 dark:text-green-400">0</span>
                            </div>
                            <div id="dynamicSectionCounts">
                                <!-- Dynamic section counts will be populated here -->
                            </div>
                        </div>
                        
                        <!-- Progress Bar -->
                        <div class="mt-6">
                            <div class="flex justify-between text-sm text-gray-600 dark:text-gray-400 mb-2">
                                <span>Progress</span>
                                <span id="progressPercent">0%</span>
                            </div>
                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                                <div id="progressBar" class="bg-green-600 dark:bg-green-500 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Section Breakdown -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">Section Breakdown</h3>
                        <div id="sectionBreakdown" class="space-y-3">
                            <!-- Section counts will be populated dynamically -->
                        </div>
                    </div>

                    <!-- Milestones -->
                    <div id="milestonesSection" class="bg-white dark:bg-gray-800 rounded-lg shadow p-6 hidden">
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">Milestones</h3>
                        <div id="milestoneBreakdown" class="space-y-3">
                            <!-- Milestone counts will be populated dynamically -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- List View -->
        <div id="listView" class="hidden pb-16">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <div class="flex flex-wrap items-center justify-between gap-3">
                        <h2 class="text-lg font-medium text-gray-900 dark:text-gray-100">Tasks</h2>
                        <div class="flex flex-wrap items-center gap-2">
                            <select id="filterSection" class="text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-2 py-1">
                                <option value="">All Sections</option>
                            </select>
                            <select id="filterAssignee" class="text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-2 py-1">
                                <option value="">All Assignees</option>
                            </select>
                            <select id="filterMilestone" class="text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-2 py-1">
                                <option value="">All Milestones</option>
                            </select>
                            <select id="filterStatus" class="text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-2 py-1">
                                <option value="">All Status</option>
                                <option value="incomplete">Incomplete</option>
                                <option value="completed">Completed</option>
                            </select>
                            <select id="sortTasks" class="text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-2 py-1">
                                <option value="default">Default Order</option>
                                <option value="due_date">Due Date</option>
                                <option value="priority">Priority</option>
                                <option value="title">Title (A-Z)</option>
                            </select>
                            <button id="clearFilters" class="text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 hidden">Clear</button>
                        </div>
                    </div>
                </div>
                <div class="divide-y divide-gray-200 dark:divide-gray-700">
                    <div id="listContainer"></div>
                </div>
            </div>
        </div>

        <!-- Board View -->
        <div id="boardView" class="hidden pb-16">
            <div id="boardContainer" class="grid gap-4 lg:gap-6 auto-cols-min grid-flow-col overflow-x-auto pb-4">
                <!-- Columns will be generated dynamically -->
            </div>
        </div>

        <!-- Config View -->
        <div id="configView" class="hidden pb-16">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 dark:text-gray-100">Project Configuration</h2>
                    <button id="saveProjectConfig" class="btn-primary py-2 rounded-lg">
                        Save Configuration
                    </button>
                </div>
                
                <!-- Basic Project Settings -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 lg:gap-8 mb-6 lg:mb-8">
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">Project Settings</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Project Start Date</label>
                                <input type="date" id="projectStartDate" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                            </div>
                            <div>
                                <label class="flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                                    Working Days per Week
                                    <span class="help-tip" data-tip="Used for timeline calculations. Effort is measured in working days, not calendar days.">?</span>
                                </label>
                                <select id="workingDays" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                                    <option value="5">5 days (Mon-Fri)</option>
                                    <option value="6">6 days (Mon-Sat)</option>
                                    <option value="7">7 days (Mon-Sun)</option>
                                    <option value="custom">Custom schedule</option>
                                </select>
                            </div>
                            <div id="customDaysContainer" class="hidden">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Select Working Days</label>
                                <div class="flex flex-wrap gap-2">
                                    <label class="inline-flex items-center">
                                        <input type="checkbox" value="Mon" class="working-day-checkbox rounded border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 focus:ring-gray-500">
                                        <span class="ml-1 text-sm text-gray-700 dark:text-gray-300">Mon</span>
                                    </label>
                                    <label class="inline-flex items-center">
                                        <input type="checkbox" value="Tue" class="working-day-checkbox rounded border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 focus:ring-gray-500">
                                        <span class="ml-1 text-sm text-gray-700 dark:text-gray-300">Tue</span>
                                    </label>
                                    <label class="inline-flex items-center">
                                        <input type="checkbox" value="Wed" class="working-day-checkbox rounded border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 focus:ring-gray-500">
                                        <span class="ml-1 text-sm text-gray-700 dark:text-gray-300">Wed</span>
                                    </label>
                                    <label class="inline-flex items-center">
                                        <input type="checkbox" value="Thu" class="working-day-checkbox rounded border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 focus:ring-gray-500">
                                        <span class="ml-1 text-sm text-gray-700 dark:text-gray-300">Thu</span>
                                    </label>
                                    <label class="inline-flex items-center">
                                        <input type="checkbox" value="Fri" class="working-day-checkbox rounded border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 focus:ring-gray-500">
                                        <span class="ml-1 text-sm text-gray-700 dark:text-gray-300">Fri</span>
                                    </label>
                                    <label class="inline-flex items-center">
                                        <input type="checkbox" value="Sat" class="working-day-checkbox rounded border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 focus:ring-gray-500">
                                        <span class="ml-1 text-sm text-gray-700 dark:text-gray-300">Sat</span>
                                    </label>
                                    <label class="inline-flex items-center">
                                        <input type="checkbox" value="Sun" class="working-day-checkbox rounded border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 focus:ring-gray-500">
                                        <span class="ml-1 text-sm text-gray-700 dark:text-gray-300">Sun</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Project Stats -->
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">Project Overview</h3>
                        <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4 space-y-3">
                            <div class="flex justify-between">
                                <span class="text-sm text-gray-600 dark:text-gray-400">Total Tasks</span>
                                <span id="configTotalTasks" class="font-medium text-gray-900 dark:text-gray-100">0</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-sm text-gray-600 dark:text-gray-400">Sections</span>
                                <span id="configTotalSections" class="font-medium text-gray-900 dark:text-gray-100">0</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-sm text-gray-600 dark:text-gray-400">Assignees</span>
                                <span id="configTotalAssignees" class="font-medium text-gray-900 dark:text-gray-100">0</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-sm text-gray-600 dark:text-gray-400">Tags</span>
                                <span id="configTotalTags" class="font-medium text-gray-900 dark:text-gray-100">0</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Configuration Management -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 lg:gap-8">
                    <!-- Sections Management -->
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">Board Sections</h3>
                        <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">Sections are read from your markdown board structure. Add new sections below to automatically create them in your markdown.</p>
                        <div id="sectionsContainer" class="space-y-2 mb-4">
                            <!-- Sections will be populated here -->
                        </div>
                        <div class="flex gap-2">
                            <input type="text" id="newSectionInput" placeholder="New section name" class="flex-1 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                            <button type="button" id="addSectionBtn" class="px-3 py-2 text-sm bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors">
                                Add
                            </button>
                        </div>
                    </div>
                    
                    <!-- Assignees Management -->
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">Team Members</h3>
                        <div id="assigneesContainer" class="flex flex-wrap gap-2 mb-4">
                            <!-- Assignees will be populated here -->
                        </div>
                        <div class="flex gap-2">
                            <input type="text" id="newAssigneeInput" placeholder="New assignee name" class="flex-1 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                            <button type="button" id="addAssigneeBtn" class="px-3 py-2 text-sm bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors">
                                Add
                            </button>
                        </div>
                    </div>
                    
                    <!-- Tags Management -->
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">Project Tags</h3>
                        <div id="tagsContainer" class="flex flex-wrap gap-2 mb-4">
                            <!-- Tags will be populated here -->
                        </div>
                        <div class="flex gap-2">
                            <input type="text" id="newTagInput" placeholder="New tag name" class="flex-1 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                            <button type="button" id="addTagBtn" class="px-3 py-2 text-sm bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors">
                                Add
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Accessibility Settings -->
                <div class="mt-8 pt-8 border-t border-gray-200 dark:border-gray-700">
                    <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">Accessibility</h3>
                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">Customize the interface for reduced cognitive load and better focus.</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Reduced Motion -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Reduced Motion</label>
                            <select id="accessibilityReducedMotion" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                                <option value="system">System Default</option>
                                <option value="on">Always On</option>
                                <option value="off">Always Off</option>
                            </select>
                            <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Disable animations and transitions</p>
                        </div>

                        <!-- High Contrast -->
                        <div>
                            <label class="flex items-center space-x-3 cursor-pointer">
                                <input type="checkbox" id="accessibilityHighContrast" class="rounded border-gray-300 dark:border-gray-600 text-gray-900 focus:ring-gray-500 w-5 h-5">
                                <div>
                                    <span class="block text-sm font-medium text-gray-700 dark:text-gray-300">High Contrast</span>
                                    <span class="block text-xs text-gray-500 dark:text-gray-400">Stronger borders and text contrast</span>
                                </div>
                            </label>
                        </div>

                        <!-- Large Touch Targets -->
                        <div>
                            <label class="flex items-center space-x-3 cursor-pointer">
                                <input type="checkbox" id="accessibilityLargeTargets" class="rounded border-gray-300 dark:border-gray-600 text-gray-900 focus:ring-gray-500 w-5 h-5">
                                <div>
                                    <span class="block text-sm font-medium text-gray-700 dark:text-gray-300">Large Touch Targets</span>
                                    <span class="block text-xs text-gray-500 dark:text-gray-400">44px minimum for buttons and links</span>
                                </div>
                            </label>
                        </div>

                        <!-- Show Breadcrumbs -->
                        <div>
                            <label class="flex items-center space-x-3 cursor-pointer">
                                <input type="checkbox" id="accessibilityShowBreadcrumbs" class="rounded border-gray-300 dark:border-gray-600 text-gray-900 focus:ring-gray-500 w-5 h-5" checked>
                                <div>
                                    <span class="block text-sm font-medium text-gray-700 dark:text-gray-300">Show Breadcrumbs</span>
                                    <span class="block text-xs text-gray-500 dark:text-gray-400">Navigation path indicator</span>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notes View -->
        <div id="notesView" class="hidden pb-16">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                    <h2 class="text-lg font-medium text-gray-900 dark:text-gray-100">Notes</h2>
                    <div class="flex space-x-2">
                        <button id="openMarkdownBtn" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors">
                            Open MD
                        </button>
                        <button id="addNoteBtn" class="btn-primary py-2 rounded-lg">
                            + Add Note
                        </button>
                    </div>
                </div>
                
                <!-- Notes Tab Navigation -->
                <div class="border-b border-gray-200 dark:border-gray-700">
                    <div class="flex items-center px-4">
                        <nav class="-mb-px flex items-center gap-1 overflow-x-auto scrollbar-hide flex-1 py-2" id="notesTabNav">
                            <!-- Note tabs will be generated dynamically -->
                        </nav>
                        <button id="addNoteTabBtn" class="ml-2 p-1.5 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-gray-200 dark:hover:bg-gray-700 transition-colors flex-shrink-0" title="Add Note">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                            </svg>
                        </button>
                    </div>
                </div>
                
                <!-- Notes Content -->
                <div class="p-6">
                    <div id="notesContent" class="min-h-96">
                        <div id="emptyNotesState" class="text-center py-12">
                            <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                            </svg>
                            <h3 class="mt-2 text-sm font-medium text-gray-900 dark:text-gray-100">No notes</h3>
                            <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Get started by creating a new note.</p>
                        </div>
                        <div id="activeNoteContent" class="hidden">
                            <div class="flex justify-between items-start mb-4">
                                <input id="activeNoteTitle" class="text-xl font-semibold text-gray-900 dark:text-gray-100 bg-transparent border-none outline-none flex-1" placeholder="Note title..." readonly>
                                <div class="flex items-center space-x-2 ml-4">
                                    <!-- Save Status -->
                                    <div id="noteSaveStatus" class="flex items-center text-xs text-gray-500 dark:text-gray-400">
                                        <span id="noteSaveText" class="hidden">Saved</span>
                                    </div>
                                    <div class="w-px h-4 bg-gray-300 dark:bg-gray-600"></div>
                                    <!-- Mode Toggle -->
                                    <div class="flex items-center border border-gray-300 dark:border-gray-600 rounded-md overflow-hidden">
                                        <button id="toggleModeBtn" class="px-3 py-1.5 text-xs font-medium transition-colors" title="Toggle Enhanced Mode">
                                            <span id="toggleModeText">Basic</span>
                                        </button>
                                    </div>
                                    <!-- Edit Toggle -->
                                    <button id="toggleEditBtn" class="p-1.5 rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors" title="Toggle Edit Mode">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                                        </svg>
                                    </button>
                                    <!-- Delete -->
                                    <button id="deleteNoteBtn" class="p-1.5 rounded hover:bg-red-50 dark:hover:bg-red-900/20 text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 transition-colors" title="Delete Note">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                        </svg>
                                    </button>
                                </div>
                            </div>

                            <!-- Note metadata -->
                            <div id="noteMetadata" class="text-xs text-gray-500 dark:text-gray-400 mb-4 flex flex-wrap gap-4">
                                <span id="noteCreatedAt"></span>
                                <span id="noteUpdatedAt"></span>
                                <span id="noteRevision"></span>
                            </div>

                            <!-- Enhanced View Mode (rendered content) -->
                            <div id="enhancedNoteView" class="hidden">
                                <!-- Beautifully rendered enhanced note content -->
                            </div>

                            <!-- Enhanced Editor Mode -->
                            <div id="enhancedNoteEditor" class="hidden">
                                <div class="flex justify-between items-center mb-4 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                    <div class="flex space-x-2">
                                        <button id="addParagraphBtn" class="btn-primary px-3 py-1">
                                            + Paragraph
                                        </button>
                                        <button id="addCodeBlockBtn" class="bg-gray-600 text-white px-3 py-1 rounded text-sm hover:bg-gray-700">
                                            + Code
                                        </button>
                                        <button id="addCustomSectionBtn" class="bg-purple-600 text-white px-3 py-1 rounded text-sm hover:bg-purple-700">
                                            + Custom
                                        </button>
                                        <button id="enableMultiSelectBtn" class="bg-orange-600 text-white px-3 py-1 rounded text-sm hover:bg-orange-700">
                                            Multi-Select
                                        </button>
                                    </div>
                                    <div class="text-sm text-gray-600 dark:text-gray-400">
                                        Enhanced Mode
                                    </div>
                                </div>
                                
                                <!-- Drag and Drop Zone -->
                                <div id="fileDropZone" class="border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center mb-4 hidden">
                                    <p class="text-gray-500 dark:text-gray-400">Drop files here to add them to your note</p>
                                </div>
                                
                                <!-- Paragraphs Container -->
                                <div id="paragraphsContainer" class="space-y-4">
                                    <!-- Paragraphs will be rendered here -->
                                </div>
                                
                                <!-- Custom Sections Container -->
                                <div id="customSectionsContainer" class="mt-6 space-y-6">
                                    <!-- Custom sections will be rendered here -->
                                </div>
                            </div>
                            
                            <!-- Simple Editor Mode (existing) -->
                            <div id="activeNoteBodyContainer" class="relative">
                                <div id="activeNoteBody" class="max-w-none">
                                    <!-- Note content will be rendered here -->
                                </div>
                                <textarea id="activeNoteEditor" class="w-full min-h-96 p-4 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent hidden resize-none" placeholder="Write your note content here... (Markdown supported)"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Goals View -->
        <div id="goalsView" class="hidden pb-16">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                    <h2 class="text-lg font-medium text-gray-900 dark:text-gray-100">Goals</h2>
                    <button id="addGoalBtn" class="btn-primary py-2 rounded-lg">
                        + Add Goal
                    </button>
                </div>
                
                <!-- Goals Filter -->
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <div class="flex space-x-4">
                        <button id="allGoalsFilter" class="px-3 py-1 rounded-md text-sm font-medium bg-gray-900 text-white dark:bg-gray-600 dark:text-white">
                            All Goals
                        </button>
                        <button id="enterpriseGoalsFilter" class="px-3 py-1 rounded-md text-sm font-medium text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100">
                            Enterprise
                        </button>
                        <button id="projectGoalsFilter" class="px-3 py-1 rounded-md text-sm font-medium text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100">
                            Project
                        </button>
                    </div>
                </div>
                
                <!-- Goals Content -->
                <div class="p-6">
                    <div id="emptyGoalsState" class="text-center py-12">
                        <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                        </svg>
                        <h3 class="mt-2 text-sm font-medium text-gray-900 dark:text-gray-100">No goals</h3>
                        <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Get started by creating a new goal.</p>
                    </div>
                    <div id="goalsContainer" class="space-y-4">
                    </div>
                </div>
            </div>
        </div>

        <!-- Milestones View -->
        <div id="milestonesView" class="hidden pb-16">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                    <h2 class="text-lg font-medium text-gray-900 dark:text-gray-100">Milestones</h2>
                    <button id="addMilestoneBtn" class="btn-primary py-2 rounded-lg">
                        + Add Milestone
                    </button>
                </div>
                <div class="p-6">
                    <div id="emptyMilestonesState" class="text-center py-12 hidden">
                        <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" />
                        </svg>
                        <h3 class="mt-2 text-sm font-medium text-gray-900 dark:text-gray-100">No milestones</h3>
                        <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Get started by creating a new milestone.</p>
                    </div>
                    <div id="milestonesContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    </div>
                </div>
            </div>
        </div>

        <!-- Ideas View -->
        <div id="ideasView" class="hidden pb-16">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                    <h2 class="text-lg font-medium text-gray-900 dark:text-gray-100">Ideas</h2>
                    <button id="addIdeaBtn" class="btn-primary py-2 rounded-lg">
                        + Add Idea
                    </button>
                </div>
                <div class="p-6">
                    <div id="emptyIdeasState" class="text-center py-12 hidden">
                        <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                        </svg>
                        <h3 class="mt-2 text-sm font-medium text-gray-900 dark:text-gray-100">No ideas yet</h3>
                        <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Start collecting your ideas.</p>
                    </div>
                    <div id="ideasContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
                </div>
            </div>
        </div>

        <!-- Retrospectives View -->
        <div id="retrospectivesView" class="hidden pb-16">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                    <h2 class="text-lg font-medium text-gray-900 dark:text-gray-100">Retrospectives</h2>
                    <button id="addRetrospectiveBtn" class="btn-primary py-2 rounded-lg">
                        + Add Retrospective
                    </button>
                </div>
                <div class="p-6">
                    <div id="emptyRetrospectivesState" class="text-center py-12 hidden">
                        <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
                        </svg>
                        <h3 class="mt-2 text-sm font-medium text-gray-900 dark:text-gray-100">No retrospectives yet</h3>
                        <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Start reflecting on your sprints.</p>
                    </div>
                    <div id="retrospectivesContainer" class="grid grid-cols-1 lg:grid-cols-2 gap-6"></div>
                </div>
            </div>
        </div>

        <!-- SWOT Analysis View -->
        <div id="swotView" class="hidden pb-16">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                    <div class="flex items-center gap-4">
                        <h2 class="text-lg font-medium text-gray-900 dark:text-gray-100">SWOT Analysis</h2>
                        <select id="swotSelector" class="text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-1.5 focus:outline-none focus:ring-2 focus:ring-gray-500">
                            <option value="">Select Analysis</option>
                        </select>
                    </div>
                    <div class="flex items-center gap-2">
                        <button id="editSwotBtn" class="btn-secondary py-1.5 rounded hidden">Edit</button>
                        <button id="deleteSwotBtn" class="btn-danger py-1.5 rounded hidden">Delete</button>
                        <button id="addSwotBtn" class="btn-primary py-2 rounded-lg">+ New SWOT</button>
                    </div>
                </div>
                <div class="p-6">
                    <div id="emptySwotState" class="text-center py-12">
                        <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2" />
                        </svg>
                        <h3 class="mt-2 text-sm font-medium text-gray-900 dark:text-gray-100">No SWOT analyses yet</h3>
                        <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Create a SWOT analysis to evaluate strengths, weaknesses, opportunities, and threats.</p>
                    </div>
                    <div id="swotGrid" class="hidden grid grid-cols-2 gap-4">
                        <!-- Strengths -->
                        <div class="bg-green-50 dark:bg-green-900/20 rounded-lg p-4 border border-green-200 dark:border-green-800">
                            <div class="flex justify-between items-center mb-3">
                                <h3 class="font-medium text-green-800 dark:text-green-300">Strengths</h3>
                                <button data-quadrant="strengths" class="swot-add-btn text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-200 text-sm">+ Add</button>
                            </div>
                            <ul id="swotStrengths" class="space-y-2 text-sm text-green-900 dark:text-green-100"></ul>
                        </div>
                        <!-- Weaknesses -->
                        <div class="bg-red-50 dark:bg-red-900/20 rounded-lg p-4 border border-red-200 dark:border-red-800">
                            <div class="flex justify-between items-center mb-3">
                                <h3 class="font-medium text-red-800 dark:text-red-300">Weaknesses</h3>
                                <button data-quadrant="weaknesses" class="swot-add-btn text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-200 text-sm">+ Add</button>
                            </div>
                            <ul id="swotWeaknesses" class="space-y-2 text-sm text-red-900 dark:text-red-100"></ul>
                        </div>
                        <!-- Opportunities -->
                        <div class="bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 border border-blue-200 dark:border-blue-800">
                            <div class="flex justify-between items-center mb-3">
                                <h3 class="font-medium text-blue-800 dark:text-blue-300">Opportunities</h3>
                                <button data-quadrant="opportunities" class="swot-add-btn text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200 text-sm">+ Add</button>
                            </div>
                            <ul id="swotOpportunities" class="space-y-2 text-sm text-blue-900 dark:text-blue-100"></ul>
                        </div>
                        <!-- Threats -->
                        <div class="bg-amber-50 dark:bg-amber-900/20 rounded-lg p-4 border border-amber-200 dark:border-amber-800">
                            <div class="flex justify-between items-center mb-3">
                                <h3 class="font-medium text-amber-800 dark:text-amber-300">Threats</h3>
                                <button data-quadrant="threats" class="swot-add-btn text-amber-600 dark:text-amber-400 hover:text-amber-800 dark:hover:text-amber-200 text-sm">+ Add</button>
                            </div>
                            <ul id="swotThreats" class="space-y-2 text-sm text-amber-900 dark:text-amber-100"></ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- SWOT Modal -->
        <div id="swotModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 id="swotModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">New SWOT Analysis</h3>
                </div>
                <form id="swotForm">
                    <div class="p-6 space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Title</label>
                            <input type="text" id="swotTitle" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500" placeholder="e.g., Product Launch Analysis">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Date</label>
                            <input type="date" id="swotDate" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500">
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                        <button type="button" id="cancelSwotBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                        <button type="submit" class="btn-primary py-2 rounded-md">Save</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- SWOT Item Modal -->
        <div id="swotItemModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 id="swotItemModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">Add Item</h3>
                </div>
                <form id="swotItemForm">
                    <div class="p-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Item</label>
                            <input type="text" id="swotItemText" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500" placeholder="Enter item...">
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                        <button type="button" id="cancelSwotItemBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                        <button type="submit" class="btn-primary py-2 rounded-md">Add</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Risk Analysis View -->
        <div id="riskAnalysisView" class="hidden pb-16">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                    <div class="flex items-center gap-4">
                        <h2 class="text-lg font-medium text-gray-900 dark:text-gray-100">Risk Analysis</h2>
                        <select id="riskAnalysisSelector" class="text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-1.5 focus:outline-none focus:ring-2 focus:ring-gray-500">
                            <option value="">Select Analysis</option>
                        </select>
                    </div>
                    <div class="flex items-center gap-2">
                        <button id="editRiskAnalysisBtn" class="btn-secondary py-1.5 rounded hidden">Edit</button>
                        <button id="deleteRiskAnalysisBtn" class="btn-danger py-1.5 rounded hidden">Delete</button>
                        <button id="addRiskAnalysisBtn" class="btn-primary py-2 rounded-lg">+ New Risk Analysis</button>
                    </div>
                </div>
                <div class="p-6">
                    <div id="emptyRiskAnalysisState" class="text-center py-12">
                        <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                        </svg>
                        <h3 class="mt-2 text-sm font-medium text-gray-900 dark:text-gray-100">No risk analyses yet</h3>
                        <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Create a risk analysis to evaluate risks by impact and probability.</p>
                    </div>
                    <div id="riskAnalysisGrid" class="hidden grid grid-cols-2 gap-4">
                        <!-- Axis labels -->
                        <div class="col-span-2 flex justify-between text-xs text-gray-500 dark:text-gray-400 px-2">
                            <span>Low Impact</span>
                            <span>High Impact</span>
                        </div>
                        <!-- High Probability Row -->
                        <div class="relative">
                            <span class="absolute -left-6 top-1/2 -translate-y-1/2 -rotate-90 text-xs text-gray-500 dark:text-gray-400 whitespace-nowrap">High Prob</span>
                            <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600 h-full">
                                <div class="flex justify-between items-center mb-3">
                                    <h3 class="font-medium text-gray-900 dark:text-gray-100 text-sm">Low Impact / High Probability</h3>
                                    <button data-quadrant="lowImpactHighProb" class="risk-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-sm">+ Add</button>
                                </div>
                                <ul id="riskLowImpactHighProb" class="space-y-2 text-sm text-gray-700 dark:text-gray-300"></ul>
                            </div>
                        </div>
                        <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600">
                            <div class="flex justify-between items-center mb-3">
                                <h3 class="font-medium text-gray-900 dark:text-gray-100 text-sm">High Impact / High Probability</h3>
                                <button data-quadrant="highImpactHighProb" class="risk-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-sm">+ Add</button>
                            </div>
                            <ul id="riskHighImpactHighProb" class="space-y-2 text-sm text-gray-700 dark:text-gray-300"></ul>
                        </div>
                        <!-- Low Probability Row -->
                        <div class="relative">
                            <span class="absolute -left-6 top-1/2 -translate-y-1/2 -rotate-90 text-xs text-gray-500 dark:text-gray-400 whitespace-nowrap">Low Prob</span>
                            <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600 h-full">
                                <div class="flex justify-between items-center mb-3">
                                    <h3 class="font-medium text-gray-900 dark:text-gray-100 text-sm">Low Impact / Low Probability</h3>
                                    <button data-quadrant="lowImpactLowProb" class="risk-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-sm">+ Add</button>
                                </div>
                                <ul id="riskLowImpactLowProb" class="space-y-2 text-sm text-gray-700 dark:text-gray-300"></ul>
                            </div>
                        </div>
                        <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600">
                            <div class="flex justify-between items-center mb-3">
                                <h3 class="font-medium text-gray-900 dark:text-gray-100 text-sm">High Impact / Low Probability</h3>
                                <button data-quadrant="highImpactLowProb" class="risk-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-sm">+ Add</button>
                            </div>
                            <ul id="riskHighImpactLowProb" class="space-y-2 text-sm text-gray-700 dark:text-gray-300"></ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Risk Analysis Modal -->
        <div id="riskAnalysisModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 id="riskAnalysisModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">New Risk Analysis</h3>
                </div>
                <form id="riskAnalysisForm">
                    <div class="p-6 space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Title</label>
                            <input type="text" id="riskAnalysisTitle" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500" placeholder="e.g., Product Launch Risks">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Date</label>
                            <input type="date" id="riskAnalysisDate" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500">
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                        <button type="button" id="cancelRiskAnalysisBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                        <button type="submit" class="btn-primary py-2 rounded-md">Save</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Risk Analysis Item Modal -->
        <div id="riskAnalysisItemModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 id="riskAnalysisItemModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">Add Risk</h3>
                </div>
                <form id="riskAnalysisItemForm">
                    <div class="p-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Risk Description</label>
                            <input type="text" id="riskAnalysisItemText" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500" placeholder="Enter risk...">
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                        <button type="button" id="cancelRiskAnalysisItemBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                        <button type="submit" class="btn-primary py-2 rounded-md">Add</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Lean Canvas View -->
        <div id="leanCanvasView" class="hidden pb-16">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                    <div class="flex items-center gap-4">
                        <h2 class="text-lg font-medium text-gray-900 dark:text-gray-100">Lean Canvas</h2>
                        <select id="leanCanvasSelector" class="text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-1.5 focus:outline-none focus:ring-2 focus:ring-gray-500">
                            <option value="">Select Canvas</option>
                        </select>
                    </div>
                    <div class="flex items-center gap-2">
                        <button id="editLeanCanvasBtn" class="btn-secondary py-1.5 rounded hidden">Edit</button>
                        <button id="deleteLeanCanvasBtn" class="btn-danger py-1.5 rounded hidden">Delete</button>
                        <button id="addLeanCanvasBtn" class="btn-primary py-2 rounded-lg">+ New Canvas</button>
                    </div>
                </div>
                <div class="p-6">
                    <div id="emptyLeanCanvasState" class="text-center py-12">
                        <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2" />
                        </svg>
                        <h3 class="mt-2 text-sm font-medium text-gray-900 dark:text-gray-100">No Lean Canvas yet</h3>
                        <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Create a Lean Canvas to plan your startup or product.</p>
                    </div>
                    <div id="leanCanvasGrid" class="hidden">
                        <!-- Row 1: Problem, Solution, UVP, Unfair Advantage, Customer Segments -->
                        <div class="grid grid-cols-5 gap-2 mb-2">
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600 min-h-[140px]">
                                <div class="flex justify-between items-center mb-2">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-xs">Problem</h3>
                                    <button data-section="problem" class="lean-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-xs">+</button>
                                </div>
                                <ul id="leanProblem" class="space-y-1 text-xs text-gray-700 dark:text-gray-300"></ul>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600 min-h-[140px]">
                                <div class="flex justify-between items-center mb-2">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-xs">Solution</h3>
                                    <button data-section="solution" class="lean-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-xs">+</button>
                                </div>
                                <ul id="leanSolution" class="space-y-1 text-xs text-gray-700 dark:text-gray-300"></ul>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600 min-h-[140px]">
                                <div class="flex justify-between items-center mb-2">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-xs">Unique Value</h3>
                                    <button data-section="uniqueValueProp" class="lean-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-xs">+</button>
                                </div>
                                <ul id="leanUniqueValueProp" class="space-y-1 text-xs text-gray-700 dark:text-gray-300"></ul>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600 min-h-[140px]">
                                <div class="flex justify-between items-center mb-2">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-xs">Unfair Advantage</h3>
                                    <button data-section="unfairAdvantage" class="lean-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-xs">+</button>
                                </div>
                                <ul id="leanUnfairAdvantage" class="space-y-1 text-xs text-gray-700 dark:text-gray-300"></ul>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600 min-h-[140px]">
                                <div class="flex justify-between items-center mb-2">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-xs">Customer Segments</h3>
                                    <button data-section="customerSegments" class="lean-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-xs">+</button>
                                </div>
                                <ul id="leanCustomerSegments" class="space-y-1 text-xs text-gray-700 dark:text-gray-300"></ul>
                            </div>
                        </div>
                        <!-- Row 2: Existing Alternatives, Key Metrics, High-Level Concept, Channels, Early Adopters -->
                        <div class="grid grid-cols-5 gap-2 mb-2">
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600 min-h-[140px]">
                                <div class="flex justify-between items-center mb-2">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-xs">Existing Alternatives</h3>
                                    <button data-section="existingAlternatives" class="lean-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-xs">+</button>
                                </div>
                                <ul id="leanExistingAlternatives" class="space-y-1 text-xs text-gray-700 dark:text-gray-300"></ul>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600 min-h-[140px]">
                                <div class="flex justify-between items-center mb-2">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-xs">Key Metrics</h3>
                                    <button data-section="keyMetrics" class="lean-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-xs">+</button>
                                </div>
                                <ul id="leanKeyMetrics" class="space-y-1 text-xs text-gray-700 dark:text-gray-300"></ul>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600 min-h-[140px]">
                                <div class="flex justify-between items-center mb-2">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-xs">High-Level Concept</h3>
                                    <button data-section="highLevelConcept" class="lean-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-xs">+</button>
                                </div>
                                <ul id="leanHighLevelConcept" class="space-y-1 text-xs text-gray-700 dark:text-gray-300"></ul>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600 min-h-[140px]">
                                <div class="flex justify-between items-center mb-2">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-xs">Channels</h3>
                                    <button data-section="channels" class="lean-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-xs">+</button>
                                </div>
                                <ul id="leanChannels" class="space-y-1 text-xs text-gray-700 dark:text-gray-300"></ul>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600 min-h-[140px]">
                                <div class="flex justify-between items-center mb-2">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-xs">Early Adopters</h3>
                                    <button data-section="earlyAdopters" class="lean-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-xs">+</button>
                                </div>
                                <ul id="leanEarlyAdopters" class="space-y-1 text-xs text-gray-700 dark:text-gray-300"></ul>
                            </div>
                        </div>
                        <!-- Row 3: Cost Structure, Revenue Streams -->
                        <div class="grid grid-cols-2 gap-2">
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600 min-h-[100px]">
                                <div class="flex justify-between items-center mb-2">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-xs">Cost Structure</h3>
                                    <button data-section="costStructure" class="lean-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-xs">+</button>
                                </div>
                                <ul id="leanCostStructure" class="space-y-1 text-xs text-gray-700 dark:text-gray-300"></ul>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600 min-h-[100px]">
                                <div class="flex justify-between items-center mb-2">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-xs">Revenue Streams</h3>
                                    <button data-section="revenueStreams" class="lean-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-xs">+</button>
                                </div>
                                <ul id="leanRevenueStreams" class="space-y-1 text-xs text-gray-700 dark:text-gray-300"></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Lean Canvas Modal -->
        <div id="leanCanvasModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 id="leanCanvasModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">New Lean Canvas</h3>
                </div>
                <form id="leanCanvasForm">
                    <div class="p-6 space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Title</label>
                            <input type="text" id="leanCanvasTitle" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500" placeholder="e.g., Product MVP">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Date</label>
                            <input type="date" id="leanCanvasDate" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500">
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                        <button type="button" id="cancelLeanCanvasBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                        <button type="submit" class="btn-primary py-2 rounded-md">Save</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Lean Canvas Item Modal -->
        <div id="leanCanvasItemModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 id="leanCanvasItemModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">Add Item</h3>
                </div>
                <form id="leanCanvasItemForm">
                    <div class="p-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Item</label>
                            <input type="text" id="leanCanvasItemText" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500" placeholder="Enter item...">
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                        <button type="button" id="cancelLeanCanvasItemBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                        <button type="submit" class="btn-primary py-2 rounded-md">Add</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Business Model Canvas View -->
        <div id="businessModelView" class="hidden pb-16">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                    <div class="flex items-center gap-4">
                        <h2 class="text-lg font-medium text-gray-900 dark:text-gray-100">Business Model Canvas</h2>
                        <select id="businessModelSelector" class="text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-1.5 focus:outline-none focus:ring-2 focus:ring-gray-500">
                            <option value="">Select Canvas</option>
                        </select>
                    </div>
                    <div class="flex items-center gap-2">
                        <button id="editBusinessModelBtn" class="btn-secondary py-1.5 rounded hidden">Edit</button>
                        <button id="deleteBusinessModelBtn" class="btn-danger py-1.5 rounded hidden">Delete</button>
                        <button id="addBusinessModelBtn" class="btn-primary py-2 rounded-lg">+ New Canvas</button>
                    </div>
                </div>
                <div class="p-6">
                    <div id="emptyBusinessModelState" class="text-center py-12">
                        <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                        </svg>
                        <h3 class="mt-2 text-sm font-medium text-gray-900 dark:text-gray-100">No Business Model Canvas yet</h3>
                        <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Create a Business Model Canvas to map your business.</p>
                    </div>
                    <div id="businessModelGrid" class="hidden">
                        <!-- Row 1: Key Partners, Key Activities, Value Proposition, Customer Relationships, Customer Segments -->
                        <div class="grid grid-cols-5 gap-2 mb-2">
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600 min-h-[120px]">
                                <div class="flex justify-between items-center mb-2">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-xs">Key Partners</h3>
                                    <button data-section="keyPartners" class="bmc-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-xs">+</button>
                                </div>
                                <ul id="bmcKeyPartners" class="space-y-1 text-xs text-gray-700 dark:text-gray-300"></ul>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600 min-h-[120px]">
                                <div class="flex justify-between items-center mb-2">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-xs">Key Activities</h3>
                                    <button data-section="keyActivities" class="bmc-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-xs">+</button>
                                </div>
                                <ul id="bmcKeyActivities" class="space-y-1 text-xs text-gray-700 dark:text-gray-300"></ul>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600 min-h-[120px]">
                                <div class="flex justify-between items-center mb-2">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-xs">Value Proposition</h3>
                                    <button data-section="valueProposition" class="bmc-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-xs">+</button>
                                </div>
                                <ul id="bmcValueProposition" class="space-y-1 text-xs text-gray-700 dark:text-gray-300"></ul>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600 min-h-[120px]">
                                <div class="flex justify-between items-center mb-2">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-xs">Customer Relationships</h3>
                                    <button data-section="customerRelationships" class="bmc-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-xs">+</button>
                                </div>
                                <ul id="bmcCustomerRelationships" class="space-y-1 text-xs text-gray-700 dark:text-gray-300"></ul>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600 min-h-[120px]">
                                <div class="flex justify-between items-center mb-2">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-xs">Customer Segments</h3>
                                    <button data-section="customerSegments" class="bmc-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-xs">+</button>
                                </div>
                                <ul id="bmcCustomerSegments" class="space-y-1 text-xs text-gray-700 dark:text-gray-300"></ul>
                            </div>
                        </div>
                        <!-- Row 2: Key Resources, Channels -->
                        <div class="grid grid-cols-5 gap-2 mb-2">
                            <div class="col-span-2 bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600 min-h-[100px]">
                                <div class="flex justify-between items-center mb-2">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-xs">Key Resources</h3>
                                    <button data-section="keyResources" class="bmc-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-xs">+</button>
                                </div>
                                <ul id="bmcKeyResources" class="space-y-1 text-xs text-gray-700 dark:text-gray-300"></ul>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600 min-h-[100px]"></div>
                            <div class="col-span-2 bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600 min-h-[100px]">
                                <div class="flex justify-between items-center mb-2">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-xs">Channels</h3>
                                    <button data-section="channels" class="bmc-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-xs">+</button>
                                </div>
                                <ul id="bmcChannels" class="space-y-1 text-xs text-gray-700 dark:text-gray-300"></ul>
                            </div>
                        </div>
                        <!-- Row 3: Cost Structure, Revenue Streams -->
                        <div class="grid grid-cols-2 gap-2">
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600 min-h-[100px]">
                                <div class="flex justify-between items-center mb-2">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-xs">Cost Structure</h3>
                                    <button data-section="costStructure" class="bmc-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-xs">+</button>
                                </div>
                                <ul id="bmcCostStructure" class="space-y-1 text-xs text-gray-700 dark:text-gray-300"></ul>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600 min-h-[100px]">
                                <div class="flex justify-between items-center mb-2">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-xs">Revenue Streams</h3>
                                    <button data-section="revenueStreams" class="bmc-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-xs">+</button>
                                </div>
                                <ul id="bmcRevenueStreams" class="space-y-1 text-xs text-gray-700 dark:text-gray-300"></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Business Model Canvas Modal -->
        <div id="businessModelModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 id="businessModelModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">New Business Model Canvas</h3>
                </div>
                <form id="businessModelForm">
                    <div class="p-6 space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Title</label>
                            <input type="text" id="businessModelTitle" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500" placeholder="e.g., SaaS Business Model">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Date</label>
                            <input type="date" id="businessModelDate" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500">
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                        <button type="button" id="cancelBusinessModelBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                        <button type="submit" class="btn-primary py-2 rounded-md">Save</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Business Model Canvas Item Modal -->
        <div id="businessModelItemModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 id="businessModelItemModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">Add Item</h3>
                </div>
                <form id="businessModelItemForm">
                    <div class="p-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Item</label>
                            <input type="text" id="businessModelItemText" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500" placeholder="Enter item...">
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                        <button type="button" id="cancelBusinessModelItemBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                        <button type="submit" class="btn-primary py-2 rounded-md">Add</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Project Value Board View -->
        <div id="projectValueView" class="hidden pb-16">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                    <div class="flex items-center gap-4">
                        <h2 class="text-lg font-medium text-gray-900 dark:text-gray-100">Project Value Board</h2>
                        <select id="projectValueSelector" class="text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-1.5 focus:outline-none focus:ring-2 focus:ring-gray-500">
                            <option value="">Select Board</option>
                        </select>
                    </div>
                    <div class="flex items-center gap-2">
                        <button id="editProjectValueBtn" class="btn-secondary py-1.5 rounded hidden">Edit</button>
                        <button id="deleteProjectValueBtn" class="btn-danger py-1.5 rounded hidden">Delete</button>
                        <button id="addProjectValueBtn" class="btn-primary py-2 rounded-lg">+ New Board</button>
                    </div>
                </div>
                <div class="p-6">
                    <div id="emptyProjectValueState" class="text-center py-12">
                        <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z" />
                        </svg>
                        <h3 class="mt-2 text-sm font-medium text-gray-900 dark:text-gray-100">No Project Value Board yet</h3>
                        <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Create a board to map customer value.</p>
                    </div>
                    <div id="projectValueGrid" class="hidden">
                        <div class="grid grid-cols-2 gap-4">
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600 min-h-[180px]">
                                <div class="flex justify-between items-center mb-3">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-sm">Customer Segments</h3>
                                    <button data-section="customerSegments" class="pvb-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-sm">+</button>
                                </div>
                                <ul id="pvbCustomerSegments" class="space-y-2 text-sm text-gray-700 dark:text-gray-300"></ul>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600 min-h-[180px]">
                                <div class="flex justify-between items-center mb-3">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-sm">Problem</h3>
                                    <button data-section="problem" class="pvb-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-sm">+</button>
                                </div>
                                <ul id="pvbProblem" class="space-y-2 text-sm text-gray-700 dark:text-gray-300"></ul>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600 min-h-[180px]">
                                <div class="flex justify-between items-center mb-3">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-sm">Solution</h3>
                                    <button data-section="solution" class="pvb-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-sm">+</button>
                                </div>
                                <ul id="pvbSolution" class="space-y-2 text-sm text-gray-700 dark:text-gray-300"></ul>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600 min-h-[180px]">
                                <div class="flex justify-between items-center mb-3">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-sm">Benefit</h3>
                                    <button data-section="benefit" class="pvb-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-sm">+</button>
                                </div>
                                <ul id="pvbBenefit" class="space-y-2 text-sm text-gray-700 dark:text-gray-300"></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Project Value Board Modal -->
        <div id="projectValueModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 id="projectValueModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">New Project Value Board</h3>
                </div>
                <form id="projectValueForm">
                    <div class="p-6 space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Title</label>
                            <input type="text" id="projectValueTitle" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500" placeholder="e.g., Product Value Analysis">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Date</label>
                            <input type="date" id="projectValueDate" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500">
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                        <button type="button" id="cancelProjectValueBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                        <button type="submit" class="btn-primary py-2 rounded-md">Save</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Project Value Board Item Modal -->
        <div id="projectValueItemModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 id="projectValueItemModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">Add Item</h3>
                </div>
                <form id="projectValueItemForm">
                    <div class="p-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Item</label>
                            <input type="text" id="projectValueItemText" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500" placeholder="Enter item...">
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                        <button type="button" id="cancelProjectValueItemBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                        <button type="submit" class="btn-primary py-2 rounded-md">Add</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Brief View -->
        <div id="briefView" class="hidden pb-16">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                    <div class="flex items-center gap-4">
                        <h2 class="text-lg font-medium text-gray-900 dark:text-gray-100">Brief</h2>
                        <select id="briefSelector" class="text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-1.5 focus:outline-none focus:ring-2 focus:ring-gray-500">
                            <option value="">Select Brief</option>
                        </select>
                    </div>
                    <div class="flex items-center gap-2">
                        <button id="editBriefBtn" class="btn-secondary py-1.5 rounded hidden">Edit</button>
                        <button id="deleteBriefBtn" class="btn-danger py-1.5 rounded hidden">Delete</button>
                        <button id="addBriefBtn" class="btn-primary py-2 rounded-lg">+ New Brief</button>
                    </div>
                </div>
                <div class="p-6">
                    <div id="emptyBriefState" class="text-center py-12">
                        <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                        </svg>
                        <h3 class="mt-2 text-sm font-medium text-gray-900 dark:text-gray-100">No Brief yet</h3>
                        <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Create a brief to document project scope and RACI.</p>
                    </div>
                    <div id="briefGrid" class="hidden space-y-6">
                        <!-- Row 1: Summary -->
                        <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600">
                            <div class="flex justify-between items-center mb-3">
                                <h3 class="font-medium text-gray-800 dark:text-gray-200 text-sm">Summary</h3>
                                <button data-section="summary" class="brief-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-sm">+</button>
                            </div>
                            <ul id="briefSummary" class="space-y-2 text-sm text-gray-700 dark:text-gray-300"></ul>
                        </div>

                        <!-- Row 2: Mission -->
                        <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600">
                            <div class="flex justify-between items-center mb-3">
                                <h3 class="font-medium text-gray-800 dark:text-gray-200 text-sm">Mission</h3>
                                <button data-section="mission" class="brief-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-sm">+</button>
                            </div>
                            <ul id="briefMission" class="space-y-2 text-sm text-gray-700 dark:text-gray-300"></ul>
                        </div>

                        <!-- Row 3: RACI -->
                        <div class="grid grid-cols-4 gap-4">
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600 min-h-[140px]">
                                <div class="flex justify-between items-center mb-3">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-sm">Responsible</h3>
                                    <button data-section="responsible" class="brief-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-sm">+</button>
                                </div>
                                <ul id="briefResponsible" class="space-y-2 text-sm text-gray-700 dark:text-gray-300"></ul>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600 min-h-[140px]">
                                <div class="flex justify-between items-center mb-3">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-sm">Accountable</h3>
                                    <button data-section="accountable" class="brief-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-sm">+</button>
                                </div>
                                <ul id="briefAccountable" class="space-y-2 text-sm text-gray-700 dark:text-gray-300"></ul>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600 min-h-[140px]">
                                <div class="flex justify-between items-center mb-3">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-sm">Consulted</h3>
                                    <button data-section="consulted" class="brief-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-sm">+</button>
                                </div>
                                <ul id="briefConsulted" class="space-y-2 text-sm text-gray-700 dark:text-gray-300"></ul>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600 min-h-[140px]">
                                <div class="flex justify-between items-center mb-3">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-sm">Informed</h3>
                                    <button data-section="informed" class="brief-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-sm">+</button>
                                </div>
                                <ul id="briefInformed" class="space-y-2 text-sm text-gray-700 dark:text-gray-300"></ul>
                            </div>
                        </div>

                        <!-- Row 4: Budget & Timeline -->
                        <div class="grid grid-cols-2 gap-4">
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600 min-h-[140px]">
                                <div class="flex justify-between items-center mb-3">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-sm">High Level Budget</h3>
                                    <button data-section="highLevelBudget" class="brief-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-sm">+</button>
                                </div>
                                <ul id="briefBudget" class="space-y-2 text-sm text-gray-700 dark:text-gray-300"></ul>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600 min-h-[140px]">
                                <div class="flex justify-between items-center mb-3">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-sm">High Level Timeline</h3>
                                    <button data-section="highLevelTimeline" class="brief-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-sm">+</button>
                                </div>
                                <ul id="briefTimeline" class="space-y-2 text-sm text-gray-700 dark:text-gray-300"></ul>
                            </div>
                        </div>

                        <!-- Row 5: Culture & Change Capacity -->
                        <div class="grid grid-cols-2 gap-4">
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600 min-h-[140px]">
                                <div class="flex justify-between items-center mb-3">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-sm">Culture</h3>
                                    <button data-section="culture" class="brief-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-sm">+</button>
                                </div>
                                <ul id="briefCulture" class="space-y-2 text-sm text-gray-700 dark:text-gray-300"></ul>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600 min-h-[140px]">
                                <div class="flex justify-between items-center mb-3">
                                    <h3 class="font-medium text-gray-800 dark:text-gray-200 text-sm">Change Capacity</h3>
                                    <button data-section="changeCapacity" class="brief-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-sm">+</button>
                                </div>
                                <ul id="briefChangeCapacity" class="space-y-2 text-sm text-gray-700 dark:text-gray-300"></ul>
                            </div>
                        </div>

                        <!-- Row 6: Guiding Principles -->
                        <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600">
                            <div class="flex justify-between items-center mb-3">
                                <h3 class="font-medium text-gray-800 dark:text-gray-200 text-sm">Guiding Principles</h3>
                                <button data-section="guidingPrinciples" class="brief-add-btn text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 text-sm">+</button>
                            </div>
                            <ul id="briefGuidingPrinciples" class="space-y-2 text-sm text-gray-700 dark:text-gray-300"></ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Brief Modal -->
        <div id="briefModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 id="briefModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">New Brief</h3>
                </div>
                <form id="briefForm">
                    <div class="p-6 space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Title</label>
                            <input type="text" id="briefTitle" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500" placeholder="e.g., Q1 Project Brief">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Date</label>
                            <input type="date" id="briefDate" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500">
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                        <button type="button" id="cancelBriefBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                        <button type="submit" class="btn-primary py-2 rounded-md">Save</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Brief Item Modal -->
        <div id="briefItemModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100">Add to <span id="briefItemSectionTitle"></span></h3>
                </div>
                <form id="briefItemForm">
                    <div class="p-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Item</label>
                            <input type="text" id="briefItemText" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500" placeholder="Enter item...">
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                        <button type="button" id="cancelBriefItemBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                        <button type="submit" class="btn-primary py-2 rounded-md">Add</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Capacity Plan Modal -->
        <div id="capacityPlanModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 id="capacityPlanModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">New Capacity Plan</h3>
                </div>
                <form id="capacityPlanForm">
                    <div class="p-6 space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Title</label>
                            <input type="text" id="capacityPlanTitle" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500" placeholder="e.g., Q1 2026 Capacity">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Date</label>
                            <input type="date" id="capacityPlanDate" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Budget Hours (optional)</label>
                            <input type="number" id="capacityPlanBudget" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500" placeholder="e.g., 500">
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                        <button type="button" id="cancelCapacityPlanBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                        <button type="submit" class="btn-primary py-2 rounded-md">Save</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Team Member Modal -->
        <div id="teamMemberModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 id="teamMemberModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">Add Team Member</h3>
                </div>
                <form id="teamMemberForm">
                    <div class="p-6 space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Name</label>
                            <input type="text" id="teamMemberName" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500" placeholder="e.g., Alice">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Role (optional)</label>
                            <input type="text" id="teamMemberRole" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500" placeholder="e.g., Developer">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Hours Per Day</label>
                            <input type="number" id="teamMemberHours" value="8" min="1" max="24" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Working Days</label>
                            <div class="flex flex-wrap gap-2">
                                <label class="flex items-center gap-1 text-sm text-gray-600 dark:text-gray-400">
                                    <input type="checkbox" id="workMon" checked class="rounded"> Mon
                                </label>
                                <label class="flex items-center gap-1 text-sm text-gray-600 dark:text-gray-400">
                                    <input type="checkbox" id="workTue" checked class="rounded"> Tue
                                </label>
                                <label class="flex items-center gap-1 text-sm text-gray-600 dark:text-gray-400">
                                    <input type="checkbox" id="workWed" checked class="rounded"> Wed
                                </label>
                                <label class="flex items-center gap-1 text-sm text-gray-600 dark:text-gray-400">
                                    <input type="checkbox" id="workThu" checked class="rounded"> Thu
                                </label>
                                <label class="flex items-center gap-1 text-sm text-gray-600 dark:text-gray-400">
                                    <input type="checkbox" id="workFri" checked class="rounded"> Fri
                                </label>
                                <label class="flex items-center gap-1 text-sm text-gray-600 dark:text-gray-400">
                                    <input type="checkbox" id="workSat" class="rounded"> Sat
                                </label>
                                <label class="flex items-center gap-1 text-sm text-gray-600 dark:text-gray-400">
                                    <input type="checkbox" id="workSun" class="rounded"> Sun
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                        <button type="button" id="cancelTeamMemberBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                        <button type="submit" class="btn-primary py-2 rounded-md">Save</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Allocation Modal -->
        <div id="allocationModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 id="allocationModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">Set Allocation</h3>
                </div>
                <form id="allocationForm">
                    <div class="p-6 space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Hours</label>
                            <input type="number" id="allocationHours" required min="0" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500" placeholder="e.g., 32">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Target Type</label>
                            <select id="allocationTargetType" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500">
                                <option value="project">Project</option>
                                <option value="task">Task</option>
                                <option value="milestone">Milestone</option>
                            </select>
                        </div>
                        <div id="allocationTargetContainer">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Target (optional)</label>
                            <select id="allocationTargetId" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500">
                                <option value="">Select target...</option>
                            </select>
                            <p id="allocationTargetHint" class="text-xs text-gray-500 dark:text-gray-400 mt-1">Select a task or milestone to allocate time</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Notes (optional)</label>
                            <input type="text" id="allocationNotes" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500" placeholder="e.g., Sprint 1 work">
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                        <button type="button" id="deleteAllocationBtn" class="btn-danger py-2 rounded-md hidden">Delete</button>
                        <button type="button" id="cancelAllocationBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                        <button type="submit" class="btn-primary py-2 rounded-md">Save</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Auto-Assign Modal -->
        <div id="autoAssignModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-4">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100">Auto-Assign Suggestions</h3>
                </div>
                <div class="p-6">
                    <div id="autoAssignEmpty" class="text-center py-8 text-gray-500 dark:text-gray-400">
                        No unassigned tasks found or all team members at capacity.
                    </div>
                    <div id="autoAssignList" class="space-y-3 max-h-96 overflow-y-auto"></div>
                </div>
                <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                    <button type="button" id="cancelAutoAssignBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                    <button type="button" id="applyAutoAssignBtn" class="btn-primary py-2 rounded-md">Apply Selected</button>
                </div>
            </div>
        </div>

        <!-- Import Assignees Modal -->
        <div id="importAssigneesModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100">Import from Assignees</h3>
                    <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">Add team members from your project configuration</p>
                </div>
                <div class="p-6">
                    <div id="importAssigneesEmpty" class="text-center py-8 text-gray-500 dark:text-gray-400 hidden">
                        All assignees are already team members, or no assignees configured.
                    </div>
                    <div id="importAssigneesList" class="space-y-2 max-h-64 overflow-y-auto"></div>
                </div>
                <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                    <button type="button" id="cancelImportAssigneesBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                    <button type="button" id="applyImportAssigneesBtn" class="btn-primary py-2 rounded-md">Import Selected</button>
                </div>
            </div>
        </div>

        <!-- Time Tracking View -->
        <div id="timeTrackingView" class="hidden pb-16">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow mb-6">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                    <h2 class="text-lg font-medium text-gray-900 dark:text-gray-100">Time Tracking</h2>
                    <div class="flex items-center gap-4">
                        <div class="text-sm text-gray-600 dark:text-gray-400">
                            Total Hours: <span id="globalTotalHours" class="font-semibold text-gray-900 dark:text-gray-100">0</span>h
                        </div>
                    </div>
                </div>
                <div class="p-6">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-600">
                            <div class="text-sm text-gray-600 dark:text-gray-400">This Week</div>
                            <div class="text-2xl font-bold text-gray-900 dark:text-gray-100" id="weeklyHours">0h</div>
                        </div>
                        <div class="bg-green-50 dark:bg-green-900/30 rounded-lg p-4">
                            <div class="text-sm text-green-600 dark:text-green-400">This Month</div>
                            <div class="text-2xl font-bold text-green-700 dark:text-green-300" id="monthlyHours">0h</div>
                        </div>
                        <div class="bg-purple-50 dark:bg-purple-900/30 rounded-lg p-4">
                            <div class="text-sm text-purple-600 dark:text-purple-400">By Person</div>
                            <div id="hoursByPerson" class="text-sm text-purple-700 dark:text-purple-300 mt-1"></div>
                        </div>
                    </div>
                    <div id="emptyTimeTrackingState" class="text-center py-12 hidden">
                        <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <h3 class="mt-2 text-sm font-medium text-gray-900 dark:text-gray-100">No time entries yet</h3>
                        <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Log time on tasks to see your tracking data.</p>
                    </div>
                    <div id="timeTrackingContainer" class="space-y-4"></div>
                </div>
            </div>
        </div>

        <!-- Capacity Planning View -->
        <div id="capacityView" class="hidden pb-16">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                    <div class="flex items-center gap-4">
                        <h2 class="text-lg font-medium text-gray-900 dark:text-gray-100">Capacity Planning</h2>
                        <select id="capacityPlanSelector" class="text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-1.5 focus:outline-none focus:ring-2 focus:ring-gray-500">
                            <option value="">Select Plan</option>
                        </select>
                    </div>
                    <div class="flex items-center gap-2">
                        <button id="editCapacityPlanBtn" class="btn-secondary py-1.5 rounded hidden">Edit</button>
                        <button id="deleteCapacityPlanBtn" class="btn-danger py-1.5 rounded hidden">Delete</button>
                        <button id="addCapacityPlanBtn" class="btn-primary py-2 rounded-lg">+ New Plan</button>
                    </div>
                </div>

                <!-- Tabs -->
                <div class="border-b border-gray-200 dark:border-gray-700">
                    <nav class="flex px-6" aria-label="Tabs">
                        <button id="capacityTeamTab" class="py-3 px-4 text-sm font-medium border-b-2 border-gray-900 dark:border-gray-100 text-gray-900 dark:text-gray-100">Team Members</button>
                        <button id="capacityAllocTab" class="py-3 px-4 text-sm font-medium border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300">Allocations</button>
                        <button id="capacityUtilTab" class="py-3 px-4 text-sm font-medium border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300">Utilization</button>
                    </nav>
                </div>

                <div class="p-6">
                    <div id="emptyCapacityState" class="text-center py-12">
                        <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                        </svg>
                        <h3 class="mt-2 text-sm font-medium text-gray-900 dark:text-gray-100">No Capacity Plan yet</h3>
                        <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Create a capacity plan to manage team allocations.</p>
                    </div>

                    <!-- Team Members Tab Content -->
                    <div id="capacityTeamContent" class="hidden">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-sm font-medium text-gray-700 dark:text-gray-300">Team Members</h3>
                            <div class="flex items-center gap-3">
                                <button id="importAssigneesBtn" class="text-sm text-purple-600 dark:text-purple-400 hover:text-purple-800 dark:hover:text-purple-300">Import from Config</button>
                                <button id="addTeamMemberBtn" class="text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200">+ Add Member</button>
                            </div>
                        </div>
                        <div id="teamMembersGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
                    </div>

                    <!-- Allocations Tab Content -->
                    <div id="capacityAllocContent" class="hidden">
                        <div class="flex justify-between items-center mb-4">
                            <div class="flex items-center gap-4">
                                <h3 class="text-sm font-medium text-gray-700 dark:text-gray-300">Weekly Allocations</h3>
                                <div class="flex items-center gap-2">
                                    <button id="allocPrevWeek" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">&lt;</button>
                                    <span id="allocWeekRange" class="text-sm text-gray-600 dark:text-gray-400">Week</span>
                                    <button id="allocNextWeek" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">&gt;</button>
                                </div>
                            </div>
                            <button id="autoAssignBtn" class="btn-secondary py-1.5 rounded text-sm">Auto-Assign</button>
                        </div>
                        <div id="allocationsGrid" class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                <thead class="bg-gray-50 dark:bg-gray-700">
                                    <tr id="allocationsHeader">
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Member</th>
                                    </tr>
                                </thead>
                                <tbody id="allocationsBody" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"></tbody>
                            </table>
                        </div>
                        <div class="mt-4 flex items-center gap-4 text-xs text-gray-500 dark:text-gray-400">
                            <span class="flex items-center gap-1"><span class="w-3 h-3 rounded bg-green-100 dark:bg-green-900/30 border border-green-300 dark:border-green-700"></span> &lt;80%</span>
                            <span class="flex items-center gap-1"><span class="w-3 h-3 rounded bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-300 dark:border-yellow-700"></span> 80-100%</span>
                            <span class="flex items-center gap-1"><span class="w-3 h-3 rounded bg-red-100 dark:bg-red-900/30 border border-red-300 dark:border-red-700"></span> &gt;100%</span>
                        </div>
                    </div>

                    <!-- Utilization Tab Content -->
                    <div id="capacityUtilContent" class="hidden">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-sm font-medium text-gray-700 dark:text-gray-300">Utilization Overview</h3>
                        </div>
                        <div id="utilizationBars" class="space-y-4"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Strategic Levels View -->
        <div id="strategicLevelsView" class="hidden pb-16">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                    <div class="flex items-center gap-4">
                        <h2 class="text-lg font-medium text-gray-900 dark:text-gray-100">Strategic Levels</h2>
                        <select id="strategicLevelsSelector" class="text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-1.5 focus:outline-none focus:ring-2 focus:ring-gray-500">
                            <option value="">Select Strategy</option>
                        </select>
                        <div class="flex items-center border border-gray-300 dark:border-gray-600 rounded-md overflow-hidden">
                            <button onclick="taskManager.setStrategicViewMode('tree')" data-mode="tree"
                                    class="strategic-view-toggle px-3 py-1.5 text-sm text-gray-700 dark:text-gray-300 bg-gray-200 dark:bg-gray-600 hover:bg-gray-100 dark:hover:bg-gray-500">
                                Tree
                            </button>
                            <button onclick="taskManager.setStrategicViewMode('pyramid')" data-mode="pyramid"
                                    class="strategic-view-toggle px-3 py-1.5 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-500">
                                Pyramid
                            </button>
                        </div>
                    </div>
                    <div class="flex items-center gap-2">
                        <button id="editStrategicLevelsBtn" class="btn-secondary py-1.5 rounded hidden">Edit</button>
                        <button id="deleteStrategicLevelsBtn" class="btn-danger py-1.5 rounded hidden">Delete</button>
                        <button id="addStrategicLevelsBtn" class="btn-primary py-2 rounded-lg">+ New Strategy</button>
                    </div>
                </div>
                <div class="p-6">
                    <div id="emptyStrategicLevelsState" class="text-center py-12">
                        <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                        </svg>
                        <h3 class="mt-2 text-sm font-medium text-gray-900 dark:text-gray-100">No Strategic Levels yet</h3>
                        <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Create a strategy to define your hierarchy from Vision to Tactics.</p>
                    </div>
                    <div id="strategicLevelsTree" class="hidden pl-6">
                        <!-- Tree will be rendered here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Billing View -->
        <div id="billingView" class="hidden pb-16">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-lg font-medium text-gray-900 dark:text-gray-100">Billing</h2>
                    </div>
                    <!-- Billing Summary Cards -->
                    <div id="billingSummaryCards" class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
                        <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                            <p class="text-xs text-gray-500 dark:text-gray-400">Outstanding</p>
                            <p id="billingSummaryOutstanding" class="text-xl font-bold text-gray-900 dark:text-gray-100">$0.00</p>
                        </div>
                        <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                            <p class="text-xs text-gray-500 dark:text-gray-400">Overdue</p>
                            <p id="billingSummaryOverdue" class="text-xl font-bold text-red-600 dark:text-red-400">$0.00</p>
                        </div>
                        <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                            <p class="text-xs text-gray-500 dark:text-gray-400">Paid (YTD)</p>
                            <p id="billingSummaryPaid" class="text-xl font-bold text-green-600 dark:text-green-400">$0.00</p>
                        </div>
                        <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                            <p class="text-xs text-gray-500 dark:text-gray-400">Draft Invoices</p>
                            <p id="billingSummaryDraft" class="text-xl font-bold text-gray-600 dark:text-gray-300">0</p>
                        </div>
                    </div>
                    <!-- Billing Tabs -->
                    <nav class="flex space-x-4 border-b border-gray-200 dark:border-gray-700">
                        <button data-billing-tab="customers" class="billing-tab px-4 py-2 text-sm font-medium text-gray-900 dark:text-gray-100 border-b-2 border-gray-900 dark:border-gray-100">Customers</button>
                        <button data-billing-tab="rates" class="billing-tab px-4 py-2 text-sm font-medium text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300">Rates</button>
                        <button data-billing-tab="quotes" class="billing-tab px-4 py-2 text-sm font-medium text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300">Quotes</button>
                        <button data-billing-tab="invoices" class="billing-tab px-4 py-2 text-sm font-medium text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300">Invoices</button>
                    </nav>
                </div>
                <div class="p-6">
                    <!-- Customers Tab -->
                    <div id="customersTab" class="billing-tab-content">
                        <div class="flex justify-end mb-4">
                            <button id="addCustomerBtn" class="btn-primary py-2 rounded-lg">+ Add Customer</button>
                        </div>
                        <div id="emptyCustomersState" class="text-center py-12 hidden">
                            <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                            </svg>
                            <h3 class="mt-2 text-sm font-medium text-gray-900 dark:text-gray-100">No customers yet</h3>
                            <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Add your first customer to start billing.</p>
                        </div>
                        <div id="customersContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
                    </div>
                    <!-- Rates Tab -->
                    <div id="ratesTab" class="billing-tab-content hidden">
                        <div class="flex justify-end mb-4">
                            <button id="addBillingRateBtn" class="btn-primary py-2 rounded-lg">+ Add Rate</button>
                        </div>
                        <div id="emptyRatesState" class="text-center py-12 hidden">
                            <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            <h3 class="mt-2 text-sm font-medium text-gray-900 dark:text-gray-100">No billing rates</h3>
                            <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Define hourly rates for billing.</p>
                        </div>
                        <div id="billingRatesContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
                    </div>
                    <!-- Quotes Tab -->
                    <div id="quotesTab" class="billing-tab-content hidden">
                        <div class="flex justify-end mb-4">
                            <button id="addQuoteBtn" class="btn-primary py-2 rounded-lg">+ New Quote</button>
                        </div>
                        <div id="emptyQuotesState" class="text-center py-12 hidden">
                            <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                            </svg>
                            <h3 class="mt-2 text-sm font-medium text-gray-900 dark:text-gray-100">No quotes yet</h3>
                            <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Create quotes for your customers.</p>
                        </div>
                        <div id="quotesContainer" class="space-y-4"></div>
                    </div>
                    <!-- Invoices Tab -->
                    <div id="invoicesTab" class="billing-tab-content hidden">
                        <div class="flex justify-end gap-2 mb-4">
                            <button id="generateInvoiceBtn" class="btn-secondary py-2 rounded-lg">Generate from Time</button>
                            <button id="addInvoiceBtn" class="btn-primary py-2 rounded-lg">+ New Invoice</button>
                        </div>
                        <div id="emptyInvoicesState" class="text-center py-12 hidden">
                            <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 14l6-6m-5.5.5h.01m4.99 5h.01M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16l3.5-2 3.5 2 3.5-2 3.5 2zM10 8.5a.5.5 0 11-1 0 .5.5 0 011 0zm5 5a.5.5 0 11-1 0 .5.5 0 011 0z" />
                            </svg>
                            <h3 class="mt-2 text-sm font-medium text-gray-900 dark:text-gray-100">No invoices yet</h3>
                            <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Create invoices to bill your customers.</p>
                        </div>
                        <div id="invoicesContainer" class="space-y-4"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- CRM View -->
        <div id="crmView" class="hidden pb-16">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-lg font-medium text-gray-900 dark:text-gray-100">CRM</h2>
                    </div>
                    <!-- CRM Summary Cards -->
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
                        <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                            <p class="text-xs text-gray-500 dark:text-gray-400">Companies</p>
                            <p id="crmSummaryCompanies" class="text-xl font-bold text-gray-900 dark:text-gray-100">0</p>
                        </div>
                        <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                            <p class="text-xs text-gray-500 dark:text-gray-400">Contacts</p>
                            <p id="crmSummaryContacts" class="text-xl font-bold text-gray-900 dark:text-gray-100">0</p>
                        </div>
                        <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                            <p class="text-xs text-gray-500 dark:text-gray-400">Open Deals</p>
                            <p id="crmSummaryDeals" class="text-xl font-bold text-blue-600 dark:text-blue-400">0</p>
                        </div>
                        <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                            <p class="text-xs text-gray-500 dark:text-gray-400">Pipeline Value</p>
                            <p id="crmSummaryPipeline" class="text-xl font-bold text-green-600 dark:text-green-400">$0</p>
                        </div>
                    </div>
                    <!-- CRM Tabs -->
                    <nav class="flex space-x-4 border-b border-gray-200 dark:border-gray-700">
                        <button data-crm-tab="companies" class="crm-tab px-4 py-2 text-sm font-medium text-gray-900 dark:text-gray-100 border-b-2 border-gray-900 dark:border-gray-100">Companies</button>
                        <button data-crm-tab="contacts" class="crm-tab px-4 py-2 text-sm font-medium text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300">Contacts</button>
                        <button data-crm-tab="deals" class="crm-tab px-4 py-2 text-sm font-medium text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300">Deals</button>
                        <button data-crm-tab="interactions" class="crm-tab px-4 py-2 text-sm font-medium text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300">Interactions</button>
                    </nav>
                </div>
                <div class="p-6">
                    <!-- Companies Tab -->
                    <div id="companiesTab" class="crm-tab-content">
                        <div class="flex justify-end mb-4">
                            <button id="addCRMCompanyBtn" class="btn-primary py-2 rounded-lg">+ Add Company</button>
                        </div>
                        <div id="emptyCompaniesState" class="text-center py-12 hidden">
                            <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                            </svg>
                            <h3 class="mt-2 text-sm font-medium text-gray-900 dark:text-gray-100">No companies yet</h3>
                            <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Add your first company to get started.</p>
                        </div>
                        <div id="companiesContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
                    </div>
                    <!-- Contacts Tab -->
                    <div id="contactsTab" class="crm-tab-content hidden">
                        <div class="flex justify-end mb-4">
                            <button id="addCRMContactBtn" class="btn-primary py-2 rounded-lg">+ Add Contact</button>
                        </div>
                        <div id="emptyContactsState" class="text-center py-12 hidden">
                            <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                            </svg>
                            <h3 class="mt-2 text-sm font-medium text-gray-900 dark:text-gray-100">No contacts yet</h3>
                            <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Add contacts to your companies.</p>
                        </div>
                        <div id="contactsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
                    </div>
                    <!-- Deals Tab -->
                    <div id="dealsTab" class="crm-tab-content hidden">
                        <div class="flex justify-end mb-4">
                            <button id="addCRMDealBtn" class="btn-primary py-2 rounded-lg">+ Add Deal</button>
                        </div>
                        <div id="emptyDealsState" class="text-center py-12 hidden">
                            <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            <h3 class="mt-2 text-sm font-medium text-gray-900 dark:text-gray-100">No deals yet</h3>
                            <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Track your sales pipeline here.</p>
                        </div>
                        <div id="dealsContainer" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
                    </div>
                    <!-- Interactions Tab -->
                    <div id="interactionsTab" class="crm-tab-content hidden">
                        <div class="flex justify-end mb-4">
                            <button id="addCRMInteractionBtn" class="btn-primary py-2 rounded-lg">+ Log Interaction</button>
                        </div>
                        <div id="emptyInteractionsState" class="text-center py-12 hidden">
                            <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
                            </svg>
                            <h3 class="mt-2 text-sm font-medium text-gray-900 dark:text-gray-100">No interactions logged</h3>
                            <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Log calls, emails, and meetings with contacts.</p>
                        </div>
                        <div id="interactionsContainer" class="space-y-4"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- CRM Company Modal -->
        <div id="crmCompanyModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 id="crmCompanyModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">Add Company</h3>
                </div>
                <form id="crmCompanyForm">
                    <div class="p-6 space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Company Name *</label>
                            <input type="text" id="crmCompanyName" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Industry</label>
                                <input type="text" id="crmCompanyIndustry" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Phone</label>
                                <input type="tel" id="crmCompanyPhone" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Website</label>
                            <input type="url" id="crmCompanyWebsite" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2" placeholder="https://">
                        </div>
                        <fieldset class="border border-gray-300 dark:border-gray-600 rounded-md p-4">
                            <legend class="text-sm font-medium text-gray-700 dark:text-gray-300 px-2">Address</legend>
                            <div class="space-y-3">
                                <input type="text" id="crmCompanyStreet" placeholder="Street" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                                <div class="grid grid-cols-2 gap-3">
                                    <input type="text" id="crmCompanyCity" placeholder="City" class="border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                                    <input type="text" id="crmCompanyState" placeholder="State/Province" class="border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                                </div>
                                <div class="grid grid-cols-2 gap-3">
                                    <input type="text" id="crmCompanyPostalCode" placeholder="Postal Code" class="border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                                    <input type="text" id="crmCompanyCountry" placeholder="Country" class="border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                                </div>
                            </div>
                        </fieldset>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Notes</label>
                            <textarea id="crmCompanyNotes" rows="2" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2"></textarea>
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                        <button type="button" id="cancelCRMCompanyBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                        <button type="submit" class="btn-primary py-2 rounded-md">Save</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- CRM Contact Modal -->
        <div id="crmContactModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 id="crmContactModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">Add Contact</h3>
                </div>
                <form id="crmContactForm">
                    <div class="p-6 space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Company *</label>
                            <select id="crmContactCompany" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                                <option value="">Select company...</option>
                            </select>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">First Name *</label>
                                <input type="text" id="crmContactFirstName" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Last Name</label>
                                <input type="text" id="crmContactLastName" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Email</label>
                                <input type="email" id="crmContactEmail" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Phone</label>
                                <input type="tel" id="crmContactPhone" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Job Title</label>
                            <input type="text" id="crmContactTitle" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                        </div>
                        <div class="flex items-center">
                            <input type="checkbox" id="crmContactPrimary" class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                            <label for="crmContactPrimary" class="ml-2 text-sm text-gray-700 dark:text-gray-300">Primary contact for company</label>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Notes</label>
                            <textarea id="crmContactNotes" rows="2" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2"></textarea>
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                        <button type="button" id="cancelCRMContactBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                        <button type="submit" class="btn-primary py-2 rounded-md">Save</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- CRM Deal Modal -->
        <div id="crmDealModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 id="crmDealModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">Add Deal</h3>
                </div>
                <form id="crmDealForm">
                    <div class="p-6 space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Deal Title *</label>
                            <input type="text" id="crmDealTitle" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Company *</label>
                                <select id="crmDealCompany" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                                    <option value="">Select company...</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Contact</label>
                                <select id="crmDealContact" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                                    <option value="">Select contact...</option>
                                </select>
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Value ($)</label>
                                <input type="number" id="crmDealValue" min="0" step="0.01" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Probability (%)</label>
                                <input type="number" id="crmDealProbability" min="0" max="100" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Stage</label>
                                <select id="crmDealStage" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                                    <option value="lead">Lead</option>
                                    <option value="qualified">Qualified</option>
                                    <option value="proposal">Proposal</option>
                                    <option value="negotiation">Negotiation</option>
                                    <option value="won">Won</option>
                                    <option value="lost">Lost</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Expected Close</label>
                                <input type="date" id="crmDealExpectedClose" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Notes</label>
                            <textarea id="crmDealNotes" rows="2" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2"></textarea>
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                        <button type="button" id="cancelCRMDealBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                        <button type="submit" class="btn-primary py-2 rounded-md">Save</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- CRM Interaction Modal -->
        <div id="crmInteractionModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 id="crmInteractionModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">Log Interaction</h3>
                </div>
                <form id="crmInteractionForm">
                    <div class="p-6 space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Type *</label>
                            <select id="crmInteractionType" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                                <option value="note">Note</option>
                                <option value="email">Email</option>
                                <option value="call">Call</option>
                                <option value="meeting">Meeting</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Summary *</label>
                            <input type="text" id="crmInteractionSummary" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2" placeholder="Brief description of interaction">
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Company</label>
                                <select id="crmInteractionCompany" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                                    <option value="">Select company...</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Contact</label>
                                <select id="crmInteractionContact" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                                    <option value="">Select contact...</option>
                                </select>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Related Deal</label>
                            <select id="crmInteractionDeal" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                                <option value="">Select deal...</option>
                            </select>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Date *</label>
                                <input type="date" id="crmInteractionDate" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Duration (min)</label>
                                <input type="number" id="crmInteractionDuration" min="0" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Next Follow-up</label>
                            <input type="date" id="crmInteractionFollowUp" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Notes</label>
                            <textarea id="crmInteractionNotes" rows="3" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2"></textarea>
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                        <button type="button" id="cancelCRMInteractionBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                        <button type="submit" class="btn-primary py-2 rounded-md">Save</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Customer Modal -->
        <div id="customerModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 id="customerModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">Add Customer</h3>
                </div>
                <form id="customerForm">
                    <div class="p-6 space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Name *</label>
                            <input type="text" id="customerName" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Email</label>
                                <input type="email" id="customerEmail" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Phone</label>
                                <input type="tel" id="customerPhone" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Company</label>
                            <input type="text" id="customerCompany" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                        </div>
                        <fieldset class="border border-gray-300 dark:border-gray-600 rounded-md p-4">
                            <legend class="text-sm font-medium text-gray-700 dark:text-gray-300 px-2">Billing Address</legend>
                            <div class="space-y-3">
                                <input type="text" id="customerStreet" placeholder="Street" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                                <div class="grid grid-cols-2 gap-3">
                                    <input type="text" id="customerCity" placeholder="City" class="border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                                    <input type="text" id="customerState" placeholder="State/Province" class="border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                                </div>
                                <div class="grid grid-cols-2 gap-3">
                                    <input type="text" id="customerPostalCode" placeholder="Postal Code" class="border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                                    <input type="text" id="customerCountry" placeholder="Country" class="border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                                </div>
                            </div>
                        </fieldset>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Notes</label>
                            <textarea id="customerNotes" rows="2" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2"></textarea>
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                        <button type="button" id="cancelCustomerBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                        <button type="submit" class="btn-primary py-2 rounded-md">Save</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Billing Rate Modal -->
        <div id="billingRateModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 id="billingRateModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">Add Billing Rate</h3>
                </div>
                <form id="billingRateForm">
                    <div class="p-6 space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Name *</label>
                            <input type="text" id="billingRateName" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2" placeholder="e.g., Senior Developer">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Hourly Rate *</label>
                            <input type="number" id="billingRateHourly" required step="0.01" min="0" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Assignee</label>
                            <input type="text" id="billingRateAssignee" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2" placeholder="Person this rate applies to">
                        </div>
                        <div class="flex items-center">
                            <input type="checkbox" id="billingRateDefault" class="h-4 w-4 text-gray-900 border-gray-300 rounded">
                            <label for="billingRateDefault" class="ml-2 text-sm text-gray-700 dark:text-gray-300">Default rate</label>
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                        <button type="button" id="cancelBillingRateBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                        <button type="submit" class="btn-primary py-2 rounded-md">Save</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Quote Modal -->
        <div id="quoteModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 id="quoteModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">New Quote</h3>
                </div>
                <form id="quoteForm">
                    <div class="p-6 space-y-4">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Title *</label>
                                <input type="text" id="quoteTitle" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Customer *</label>
                                <select id="quoteCustomer" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                                    <option value="">Select customer...</option>
                                </select>
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Valid Until</label>
                                <input type="date" id="quoteValidUntil" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tax Rate (%)</label>
                                <input type="number" id="quoteTaxRate" step="0.01" min="0" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2" value="0">
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between items-center mb-2">
                                <label class="text-sm font-medium text-gray-700 dark:text-gray-300">Line Items</label>
                                <button type="button" id="addQuoteLineBtn" class="text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200">+ Add Item</button>
                            </div>
                            <div id="quoteLineItems" class="space-y-2"></div>
                        </div>
                        <div class="border-t border-gray-200 dark:border-gray-700 pt-4 space-y-2">
                            <div class="flex justify-between text-sm"><span class="text-gray-500">Subtotal:</span><span id="quoteSubtotal" class="font-medium">$0.00</span></div>
                            <div class="flex justify-between text-sm"><span class="text-gray-500">Tax:</span><span id="quoteTax" class="font-medium">$0.00</span></div>
                            <div class="flex justify-between text-base font-bold"><span>Total:</span><span id="quoteTotal">$0.00</span></div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Notes</label>
                            <textarea id="quoteNotes" rows="2" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2"></textarea>
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                        <button type="button" id="cancelQuoteBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                        <button type="submit" class="btn-primary py-2 rounded-md">Save</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Invoice Modal -->
        <div id="invoiceModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 id="invoiceModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">New Invoice</h3>
                </div>
                <form id="invoiceForm">
                    <div class="p-6 space-y-4">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Title *</label>
                                <input type="text" id="invoiceTitle" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Customer *</label>
                                <select id="invoiceCustomer" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                                    <option value="">Select customer...</option>
                                </select>
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Due Date</label>
                                <input type="date" id="invoiceDueDate" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tax Rate (%)</label>
                                <input type="number" id="invoiceTaxRate" step="0.01" min="0" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2" value="0">
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between items-center mb-2">
                                <label class="text-sm font-medium text-gray-700 dark:text-gray-300">Line Items</label>
                                <button type="button" id="addInvoiceLineBtn" class="text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200">+ Add Item</button>
                            </div>
                            <div id="invoiceLineItems" class="space-y-2"></div>
                        </div>
                        <div class="border-t border-gray-200 dark:border-gray-700 pt-4 space-y-2">
                            <div class="flex justify-between text-sm"><span class="text-gray-500">Subtotal:</span><span id="invoiceSubtotal" class="font-medium">$0.00</span></div>
                            <div class="flex justify-between text-sm"><span class="text-gray-500">Tax:</span><span id="invoiceTaxDisplay" class="font-medium">$0.00</span></div>
                            <div class="flex justify-between text-base font-bold"><span>Total:</span><span id="invoiceTotal">$0.00</span></div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Notes</label>
                            <textarea id="invoiceNotes" rows="2" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2"></textarea>
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                        <button type="button" id="cancelInvoiceBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                        <button type="submit" class="btn-primary py-2 rounded-md">Save</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Generate Invoice Modal -->
        <div id="generateInvoiceModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100">Generate Invoice from Time Entries</h3>
                </div>
                <form id="generateInvoiceForm">
                    <div class="p-6 space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Customer *</label>
                            <select id="generateInvoiceCustomer" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                                <option value="">Select customer...</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Title</label>
                            <input type="text" id="generateInvoiceTitle" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2" placeholder="Time Entry Invoice">
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Start Date</label>
                                <input type="date" id="generateInvoiceStartDate" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">End Date</label>
                                <input type="date" id="generateInvoiceEndDate" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Hourly Rate *</label>
                            <input type="number" id="generateInvoiceRate" required step="0.01" min="0" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Select Tasks *</label>
                            <div id="generateInvoiceTasks" class="max-h-48 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md p-2 space-y-1"></div>
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                        <button type="button" id="cancelGenerateInvoiceBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                        <button type="submit" class="btn-primary py-2 rounded-md">Generate Invoice</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Payment Modal -->
        <div id="paymentModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100">Record Payment</h3>
                </div>
                <form id="paymentForm">
                    <div class="p-6 space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Amount *</label>
                            <input type="number" id="paymentAmount" required step="0.01" min="0" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Date *</label>
                            <input type="date" id="paymentDate" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Method</label>
                            <select id="paymentMethod" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2">
                                <option value="">Select...</option>
                                <option value="bank">Bank Transfer</option>
                                <option value="card">Card</option>
                                <option value="cash">Cash</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Reference</label>
                            <input type="text" id="paymentReference" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2" placeholder="Transaction ID, check number, etc.">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Notes</label>
                            <textarea id="paymentNotes" rows="2" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2"></textarea>
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                        <button type="button" id="cancelPaymentBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                        <button type="submit" class="btn-primary py-2 rounded-md">Record Payment</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Strategic Levels Builder Modal -->
        <div id="strategicLevelsModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 id="strategicLevelsModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">New Strategy</h3>
                </div>
                <form id="strategicLevelsForm">
                    <div class="p-6 space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Title</label>
                            <input type="text" id="strategicLevelsTitle" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500" placeholder="e.g., Product Strategy 2026">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Date</label>
                            <input type="date" id="strategicLevelsDate" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500">
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                        <button type="button" id="cancelStrategicLevelsBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                        <button type="submit" class="btn-primary py-2 rounded-md">Save</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Strategic Level Item Modal -->
        <div id="strategicLevelModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 id="strategicLevelModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">Add Level</h3>
                </div>
                <form id="strategicLevelForm">
                    <div class="p-6 space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Title</label>
                            <input type="text" id="strategicLevelTitle" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500" placeholder="e.g., Become market leader">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Description (optional)</label>
                            <textarea id="strategicLevelDescription" rows="3" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500" placeholder="Additional details..."></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Level Type</label>
                            <select id="strategicLevelType" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500">
                                <option value="vision">Vision</option>
                                <option value="mission">Mission</option>
                                <option value="goals">Goals</option>
                                <option value="objectives">Objectives</option>
                                <option value="strategies">Strategies</option>
                                <option value="tactics">Tactics</option>
                            </select>
                        </div>
                        <div id="strategicLevelParentGroup">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Parent</label>
                            <select id="strategicLevelParent" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500">
                                <option value="">None (Root)</option>
                            </select>
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                        <button type="button" id="cancelStrategicLevelBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                        <button type="submit" class="btn-primary py-2 rounded-md">Save</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Strategic Level Link Modal -->
        <div id="strategicLinkModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[80vh] flex flex-col">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h3 id="strategicLinkModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">Link Items</h3>
                </div>
                <div class="p-6 space-y-4 overflow-y-auto flex-1">
                    <div>
                        <h4 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Tasks</h4>
                        <div id="strategicLinkTasks" class="space-y-2 max-h-48 overflow-y-auto border border-gray-200 dark:border-gray-600 rounded-md p-2">
                            <!-- Task checkboxes will be rendered here -->
                        </div>
                    </div>
                    <div>
                        <h4 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Milestones</h4>
                        <div id="strategicLinkMilestones" class="space-y-2 max-h-48 overflow-y-auto border border-gray-200 dark:border-gray-600 rounded-md p-2">
                            <!-- Milestone checkboxes will be rendered here -->
                        </div>
                    </div>
                </div>
                <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                    <button type="button" id="cancelStrategicLinkBtn" class="btn-secondary py-2 rounded-md">Cancel</button>
                    <button type="button" id="saveStrategicLinkBtn" class="btn-primary py-2 rounded-md">Save Links</button>
                </div>
            </div>
        </div>

        <!-- Canvas View -->
        <div id="canvasView" class="hidden pb-16">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                    <h2 class="text-lg font-medium text-gray-900 dark:text-gray-100">Canvas</h2>
                    <div class="flex space-x-2">
                        <button id="addStickyNoteBtn" class="btn-primary py-2 rounded-lg">
                            + Add Sticky Note
                        </button>
                    </div>
                </div>
                
                <!-- Canvas Controls -->
                <div class="px-6 py-3 bg-gray-50 dark:bg-gray-700 border-b border-gray-200 dark:border-gray-600">
                    <div class="flex items-center space-x-4">
                        <div class="flex items-center space-x-2">
                            <label class="text-sm text-gray-600 dark:text-gray-400">Zoom:</label>
                            <input type="range" id="canvasZoom" min="0.25" max="2" step="0.25" value="1" class="w-20">
                            <span id="zoomLevel" class="text-sm text-gray-600 dark:text-gray-400">100%</span>
                        </div>
                    </div>
                </div>
                
                <!-- Canvas Container -->
                <div id="canvasContainer" class="relative overflow-hidden bg-gray-50 dark:bg-gray-800 canvas-height">
                    <div id="canvasViewport" class="absolute inset-0 cursor-grab">
                        <div id="canvasGrid" class="absolute inset-0 opacity-20 hidden">
                            <!-- Grid pattern will be generated here -->
                        </div>
                        <div id="canvasContent" class="relative w-full h-full">
                            <!-- Sticky notes will be positioned here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mindmap View -->
        <div id="mindmapView" class="hidden pb-16">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                    <h2 class="text-lg font-medium text-gray-900 dark:text-gray-100">Mindmap</h2>
                    <div class="flex space-x-2">
                        <select id="mindmapSelector" class="border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 text-sm">
                            <option value="">Select Mindmap</option>
                        </select>
                        <button id="addMindmapBtn" class="btn-primary py-2 rounded-lg">
                            + Add Mindmap
                        </button>
                        <button id="editMindmapBtn" class="bg-green-600 text-white px-3 py-2 rounded-lg hover:bg-green-700 transition-colors" style="display: none;">
                            Edit
                        </button>
                        <button id="deleteMindmapBtn" class="btn-danger py-2 rounded-lg" style="display: none;">
                            Delete
                        </button>
                    </div>
                </div>
                
                <!-- Mindmap Controls -->
                <div class="px-6 py-3 bg-gray-50 dark:bg-gray-700 border-b border-gray-200 dark:border-gray-600">
                    <div class="flex items-center space-x-4">
                        <div class="flex items-center space-x-2">
                            <label class="text-sm text-gray-600 dark:text-gray-400">Zoom:</label>
                            <input type="range" id="mindmapZoom" min="0.25" max="2" step="0.25" value="1" class="w-20">
                            <span id="mindmapZoomLevel" class="text-sm text-gray-600 dark:text-gray-400">100%</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <label class="text-sm text-gray-600 dark:text-gray-400">Layout:</label>
                            <select id="mindmapLayout" class="text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-2 py-1">
                                <option value="horizontal" selected>Left to Right</option>
                                <option value="vertical">Top to Bottom</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- Mindmap Container -->
                <div id="mindmapContainer" class="relative overflow-hidden bg-gray-50 dark:bg-gray-800 canvas-height">
                    <div id="mindmapViewport" class="absolute inset-0 cursor-grab">
                        <div id="mindmapContent" class="relative w-full h-full">
                            <div id="mindmapEmptyState" class="flex items-center justify-center h-full">
                                <div class="text-center">
                                    <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                                    </svg>
                                    <h3 class="mt-2 text-sm font-medium text-gray-900 dark:text-gray-100">No mindmap data</h3>
                                    <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Add a Mindmap section with ul>li lists to your markdown.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- C4 Architecture View -->
        <div id="c4View" class="hidden pb-16">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                    <div class="flex items-center space-x-4">
                        <h2 class="text-lg font-medium text-gray-900 dark:text-gray-100">C4 Architecture</h2>
                        <div id="c4Breadcrumb" class="flex items-center space-x-2 text-sm text-gray-500 dark:text-gray-400">
                            <!-- Breadcrumb will be populated here -->
                        </div>
                    </div>
                    <div class="flex space-x-2">
                        <button id="c4BackBtn" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors hidden">
                             Back
                        </button>
                        <button id="c4AutoLayoutBtn" class="btn-primary py-2 rounded-lg">
                            Auto Layout
                        </button>
                        <button id="addC4ComponentBtn" class="btn-primary py-2 rounded-lg">
                            + Add Component
                        </button>
                    </div>
                </div>
                
                <!-- C4 Controls -->
                <div class="px-6 py-3 bg-gray-50 dark:bg-gray-700 border-b border-gray-200 dark:border-gray-600">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-4">
                            <div class="flex items-center space-x-2">
                                <label class="text-sm text-gray-600 dark:text-gray-400">View:</label>
                                <select id="c4ViewMode" class="text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 rounded-md px-2 py-1">
                                    <option value="diagram">Diagram</option>
                                    <option value="list">List</option>
                                </select>
                            </div>
                            <div id="c4DiagramControls" class="flex items-center space-x-2">
                                <label class="text-sm text-gray-600 dark:text-gray-400">Zoom:</label>
                                <input type="range" id="c4Zoom" min="0.5" max="2" step="0.1" value="1" class="w-20">
                                <span id="c4ZoomLevel" class="text-sm text-gray-600 dark:text-gray-400">100%</span>
                            </div>
                        </div>
                        <div id="c4DiagramOptions" class="flex items-center space-x-4">
                            <label class="flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400">
                                <input type="checkbox" id="c4PhysicsToggle" class="rounded">
                                <span>Physics</span>
                            </label>
                            <div class="text-sm text-gray-600 dark:text-gray-400">
                                Click components to drill down
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- C4 Container -->
                <div id="c4Container" class="relative overflow-hidden bg-gray-50 dark:bg-gray-800 canvas-height cursor-grab">
                    <div id="c4Viewport" class="absolute inset-0">
                        <div id="c4Content" class="relative w-full h-full">
                            <div id="c4EmptyState" class="flex items-center justify-center h-full">
                                <div class="text-center">
                                    <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 9a2 2 0 012-2m0 0V5a2 2 0 012 2v2M7 7h10" />
                                    </svg>
                                    <h3 class="mt-2 text-sm font-medium text-gray-900 dark:text-gray-100">No C4 components</h3>
                                    <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Add components to start building your architecture diagram.</p>
                                </div>
                            </div>
                            <div id="c4ComponentsContainer" class="hidden">
                                <!-- C4 components will be rendered here -->
                            </div>
                            <!-- Connections canvas -->
                            <svg id="c4Connections" class="absolute inset-0 pointer-events-none w-full h-full" style="z-index: 1;">
                                <!-- Connection lines will be drawn here -->
                            </svg>
                        </div>
                    </div>
                    
                    <!-- Reset View Button - Outside the viewport -->
                    <button id="c4ResetViewBtn" class="absolute top-4 right-4 bg-gray-600 text-white p-2 rounded-full hover:bg-gray-700 transition-colors z-20" title="Reset View">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"></path>
                        </svg>
                    </button>
                </div>

                <!-- C4 List View -->
                <div id="c4ListView" class="hidden p-6 max-h-[600px] overflow-y-auto">
                    <div id="c4ListContent">
                        <!-- List view will be rendered here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Timeline View -->
        <div id="timelineView" class="hidden pb-16">

            <!-- Timeline Configuration -->
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow mb-6 p-4 sm:p-6">
                <h2 class="text-lg font-medium text-gray-900 dark:text-gray-100 mb-4">Timeline Settings</h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Project Start Date</label>
                        <input type="date" id="timelineStartDate" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent" readonly>
                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Configure in Config tab</p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Working Days per Week</label>
                        <select id="timelineWorkingDays" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent bg-gray-100 dark:bg-gray-600 cursor-not-allowed" disabled>
                            <option value="5">5 days (Mon-Fri)</option>
                            <option value="6">6 days (Mon-Sat)</option>
                            <option value="7">7 days (Mon-Sun)</option>
                        </select>
                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Configure in Config tab</p>
                    </div>
                </div>
            </div>

            <!-- Timeline Chart -->
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow">
                <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                    <h2 class="text-lg font-medium text-gray-900 dark:text-gray-100">Project Timeline</h2>
                    <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">Tasks scheduled based on dependencies and effort</p>
                </div>
                

                <!-- Timeline Content -->
                <div class="p-6">
                    <div id="timelineChart" class="overflow-x-auto">
                        <div id="timelineContent" class="min-w-full">
                            <!-- Timeline will be generated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Hidden File Input for CSV Import -->
    <input type="file" id="csvFileInput" accept=".csv" style="display: none;">
    
    <!-- Hidden File Input for Markdown Import -->
    <input type="file" id="markdownFileInput" accept=".md,.markdown" style="display: none;">
    
    <!-- Auto-save Indicator -->
    <div id="autoSaveIndicator" class="auto-save-indicator">
        Auto-saved
    </div>

    <!-- Custom Section Modal -->
    <div id="customSectionModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100">Add Custom Section</h3>
            </div>
            <div class="p-6">
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Section Type</label>
                    <select id="customSectionType" class="w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100">
                        <option value="tabs">Tabs - Organize content in tabs</option>
                        <option value="timeline">Timeline - Track progress with status</option>
                        <option value="split-view">Split View - Multi-column layout</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Section Title</label>
                    <input type="text" id="customSectionTitle" placeholder="Enter section title..." 
                           class="w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100">
                </div>
            </div>
            <div class="px-6 py-4 bg-gray-50 dark:bg-gray-700 flex justify-end space-x-3">
                <button id="cancelCustomSectionBtn" class="px-4 py-2 text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100">Cancel</button>
                <button id="createCustomSectionBtn" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700">Create Section</button>
            </div>
        </div>
    </div>

    <!-- Note Modal -->
    <div id="noteModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                <h3 id="noteModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">New Note</h3>
            </div>
            <form id="noteForm">
                <div class="p-6 space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Title</label>
                        <input type="text" id="noteTitle" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent" placeholder="Enter note title...">
                    </div>
                    <input type="hidden" id="noteContent" value="">

                    <div class="p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                        <div class="flex items-center gap-2 mb-2">
                            <span class="text-sm font-medium text-gray-700 dark:text-gray-300">Mode</span>
                        </div>
                        <div class="flex gap-2">
                            <button type="button" id="noteModeBasic" class="flex-1 px-3 py-2 text-sm font-medium rounded-md transition-colors bg-gray-900 dark:bg-gray-100 text-white dark:text-gray-900">
                                Basic
                            </button>
                            <button type="button" id="noteModeEnhanced" class="flex-1 px-3 py-2 text-sm font-medium rounded-md transition-colors bg-white dark:bg-gray-600 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-500 hover:bg-gray-100 dark:hover:bg-gray-500">
                                Enhanced
                            </button>
                        </div>
                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-2">Enhanced: structured blocks, timelines, custom sections</p>
                    </div>
                    <input type="hidden" id="noteEnhancedMode" value="">
                </div>

                <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900 rounded-b-lg">
                    <button type="button" id="cancelNoteBtn" class="px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors">
                        Cancel
                    </button>
                    <button type="submit" class="px-4 py-2 text-sm font-medium text-white bg-gray-900 rounded-md hover:bg-gray-700 dark:bg-gray-600 dark:text-white dark:hover:bg-gray-500 transition-colors">
                        Create & Edit
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Goal Modal -->
    <div id="goalModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] flex flex-col">
            <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex-shrink-0">
                <h3 id="goalModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">Add Goal</h3>
            </div>
            <form id="goalForm" class="flex flex-col flex-1 overflow-hidden">
                <div class="p-6 space-y-4 overflow-y-auto flex-1">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Title</label>
                        <input type="text" id="goalTitle" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Type</label>
                            <select id="goalType" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                                <option value="project">Project</option>
                                <option value="enterprise">Enterprise</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                            <select id="goalStatus" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                                <option value="planning">Planning</option>
                                <option value="on-track">On Track</option>
                                <option value="at-risk">At Risk</option>
                                <option value="late">Late</option>
                                <option value="success">Success</option>
                                <option value="failed">Failed</option>
                            </select>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">KPI (Key Performance Indicator)</label>
                        <input type="text" id="goalKpi" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent" placeholder="e.g., 25% increase in sales, 100% feature completion">
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Start Date</label>
                            <input type="date" id="goalStartDate" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">End Date</label>
                            <input type="date" id="goalEndDate" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Description</label>
                        <textarea id="goalDescription" rows="4" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent" placeholder="Describe the goal and what success looks like..."></textarea>
                    </div>
                </div>

                <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900 flex-shrink-0">
                    <button type="button" id="cancelGoalBtn" class="px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors">
                        Cancel
                    </button>
                    <button type="submit" class="px-4 py-2 text-sm font-medium text-white bg-gray-900 rounded-md hover:bg-gray-700 dark:bg-gray-600 dark:text-white dark:hover:bg-gray-500 transition-colors">
                        Save Goal
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Milestone Modal -->
    <div id="milestoneModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                <h3 id="milestoneModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">Add Milestone</h3>
            </div>
            <form id="milestoneForm">
                <div class="p-6 space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Name</label>
                        <input type="text" id="milestoneName" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Target Date</label>
                        <input type="date" id="milestoneTarget" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                        <select id="milestoneStatus" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                            <option value="open">Open</option>
                            <option value="completed">Completed</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Description</label>
                        <textarea id="milestoneDescription" rows="3" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent"></textarea>
                    </div>
                </div>
                <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                    <button type="button" id="cancelMilestoneBtn" class="px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors">
                        Cancel
                    </button>
                    <button type="submit" class="px-4 py-2 text-sm font-medium text-white bg-gray-900 rounded-md hover:bg-gray-700 dark:bg-gray-600 dark:text-white dark:hover:bg-gray-500 transition-colors">
                        Save
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Idea Modal -->
    <div id="ideaModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                <h3 id="ideaModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">Add Idea</h3>
            </div>
            <form id="ideaForm">
                <div class="p-6 space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Title</label>
                        <input type="text" id="ideaTitle" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                            <select id="ideaStatus" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                                <option value="new">New</option>
                                <option value="considering">Considering</option>
                                <option value="planned">Planned</option>
                                <option value="approved">Approved</option>
                                <option value="rejected">Rejected</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Category</label>
                            <input type="text" id="ideaCategory" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent" placeholder="e.g. feature, bug">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Description</label>
                        <textarea id="ideaDescription" rows="4" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent"></textarea>
                    </div>
                    <div id="ideaLinksSection" class="hidden">
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Linked Ideas</label>
                        <div id="ideaLinksDisplay" class="flex flex-wrap gap-2 min-h-[32px] p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-700"></div>
                        <button type="button" id="openIdeaLinkPickerBtn" class="mt-2 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100">+ Add Links</button>
                    </div>
                </div>
                <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                    <button type="button" id="cancelIdeaBtn" class="px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors">Cancel</button>
                    <button type="submit" class="px-4 py-2 text-sm font-medium text-white bg-gray-900 rounded-md hover:bg-gray-700 dark:bg-gray-600 dark:text-white dark:hover:bg-gray-500 transition-colors">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Idea Link Picker Modal -->
    <div id="ideaLinkPickerModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[80vh] flex flex-col">
            <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100">Link Ideas (Zettelkasten)</h3>
                <input type="text" id="ideaLinkSearch" placeholder="Search ideas..." class="mt-2 w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-gray-500">
            </div>
            <div id="ideaLinkList" class="flex-1 overflow-y-auto p-4 space-y-2"></div>
            <div class="px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900 flex justify-end space-x-3">
                <button type="button" id="cancelIdeaLinkPickerBtn" class="px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600">Cancel</button>
                <button type="button" id="saveIdeaLinksBtn" class="px-4 py-2 text-sm font-medium text-white bg-gray-900 rounded-md hover:bg-gray-700 dark:bg-gray-600 dark:hover:bg-gray-500">Save Links</button>
            </div>
        </div>
    </div>

    <!-- Retrospective Modal -->
    <div id="retrospectiveModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] flex flex-col">
            <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                <h3 id="retrospectiveModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">Add Retrospective</h3>
            </div>
            <form id="retrospectiveForm" class="flex flex-col flex-1 overflow-hidden">
                <div class="p-6 space-y-4 overflow-y-auto flex-1">
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Title</label>
                            <input type="text" id="retrospectiveTitle" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent" placeholder="e.g., Sprint 1 Retrospective">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Date</label>
                            <input type="date" id="retrospectiveDate" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                        <select id="retrospectiveStatus" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                            <option value="open">Open</option>
                            <option value="closed">Closed</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-green-700 dark:text-green-400 mb-1">Continue (what went well)</label>
                        <textarea id="retrospectiveContinue" rows="3" class="w-full border border-green-300 dark:border-green-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent" placeholder="One item per line"></textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-red-700 dark:text-red-400 mb-1">Stop (what should stop)</label>
                        <textarea id="retrospectiveStop" rows="3" class="w-full border border-red-300 dark:border-red-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent" placeholder="One item per line"></textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1">Start (what to start doing)</label>
                        <textarea id="retrospectiveStart" rows="3" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent" placeholder="One item per line"></textarea>
                    </div>
                </div>
                <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900">
                    <button type="button" id="cancelRetrospectiveBtn" class="px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors">Cancel</button>
                    <button type="submit" class="px-4 py-2 text-sm font-medium text-white bg-gray-900 rounded-md hover:bg-gray-700 dark:bg-gray-600 dark:text-white dark:hover:bg-gray-500 transition-colors">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Mindmap Modal -->
    <div id="mindmapModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-3xl w-full mx-4 flex flex-col max-h-[90vh]">
            <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex-shrink-0">
                <h3 id="mindmapModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">Add Mindmap</h3>
            </div>
            <form id="mindmapForm" class="flex flex-col flex-1 overflow-hidden">
                <div class="p-6 space-y-4 overflow-y-auto flex-1">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Title</label>
                        <input type="text" id="mindmapTitle" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent" placeholder="Enter mindmap title...">
                    </div>

                    <div class="flex gap-4">
                        <!-- Editor Panel -->
                        <div class="flex-1">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Structure</label>

                            <!-- Toolbar -->
                            <div class="flex flex-wrap gap-1 mb-2 p-2 bg-gray-50 dark:bg-gray-900 rounded-t-md border border-b-0 border-gray-300 dark:border-gray-600">
                                <button type="button" id="mmAddRootBtn" class="px-2 py-1 text-xs font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-100 dark:hover:bg-gray-600" title="Add root node">
                                    + Root
                                </button>
                                <button type="button" id="mmAddChildBtn" class="px-2 py-1 text-xs font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-100 dark:hover:bg-gray-600" title="Add child node (Tab)">
                                    + Child
                                </button>
                                <button type="button" id="mmAddSiblingBtn" class="px-2 py-1 text-xs font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-100 dark:hover:bg-gray-600" title="Add sibling node (Enter)">
                                    + Sibling
                                </button>
                                <div class="w-px bg-gray-300 dark:bg-gray-600 mx-1"></div>
                                <button type="button" id="mmIndentBtn" class="px-2 py-1 text-xs font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-100 dark:hover:bg-gray-600" title="Indent (Tab)">
                                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5l7 7-7 7M5 5l7 7-7 7"/></svg>
                                </button>
                                <button type="button" id="mmUnindentBtn" class="px-2 py-1 text-xs font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-100 dark:hover:bg-gray-600" title="Unindent (Shift+Tab)">
                                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 19l-7-7 7-7M19 19l-7-7 7-7"/></svg>
                                </button>
                                <div class="w-px bg-gray-300 dark:bg-gray-600 mx-1"></div>
                                <button type="button" id="mmMoveUpBtn" class="px-2 py-1 text-xs font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-100 dark:hover:bg-gray-600" title="Move line up (Alt+Up)">
                                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"/></svg>
                                </button>
                                <button type="button" id="mmMoveDownBtn" class="px-2 py-1 text-xs font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-100 dark:hover:bg-gray-600" title="Move line down (Alt+Down)">
                                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
                                </button>
                                <button type="button" id="mmDeleteLineBtn" class="px-2 py-1 text-xs font-medium text-red-600 dark:text-red-400 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded hover:bg-red-50 dark:hover:bg-red-900/20" title="Delete current line">
                                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg>
                                </button>
                            </div>

                            <textarea id="mindmapStructure" required rows="10" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-b-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent font-mono text-sm" placeholder="- Main Topic&#10;  - Subtopic 1&#10;  - Subtopic 2&#10;    - Detail 1&#10;    - Detail 2"></textarea>

                            <!-- Keyboard shortcuts -->
                            <div class="mt-2 text-xs text-gray-500 dark:text-gray-400 space-y-1">
                                <div class="flex flex-wrap gap-x-4 gap-y-1">
                                    <span><kbd class="px-1 py-0.5 bg-gray-100 dark:bg-gray-700 rounded text-[10px]">Tab</kbd> Indent</span>
                                    <span><kbd class="px-1 py-0.5 bg-gray-100 dark:bg-gray-700 rounded text-[10px]">Shift+Tab</kbd> Unindent</span>
                                    <span><kbd class="px-1 py-0.5 bg-gray-100 dark:bg-gray-700 rounded text-[10px]">Enter</kbd> New sibling</span>
                                    <span><kbd class="px-1 py-0.5 bg-gray-100 dark:bg-gray-700 rounded text-[10px]">Alt+Up/Down</kbd> Move line</span>
                                </div>
                            </div>
                        </div>

                        <!-- Preview Panel -->
                        <div class="w-48 flex-shrink-0">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Preview</label>
                            <div id="mindmapPreview" class="h-64 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-900 p-2 overflow-auto text-xs">
                                <div class="text-gray-400 dark:text-gray-500 italic">Enter structure to see preview</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900 flex-shrink-0">
                    <button type="button" id="cancelMindmapBtn" class="px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors">
                        Cancel
                    </button>
                    <button type="submit" class="px-4 py-2 text-sm font-medium text-white bg-gray-900 rounded-md hover:bg-gray-700 dark:bg-gray-600 dark:text-white dark:hover:bg-gray-500 transition-colors">
                        Save Mindmap
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Sticky Note Modal -->
    <div id="stickyNoteModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 flex flex-col max-h-[90vh]">
            <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex-shrink-0">
                <h3 id="stickyNoteModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">Add Sticky Note</h3>
            </div>
            <form id="stickyNoteForm" class="flex flex-col flex-1 overflow-hidden">
                <div class="p-6 space-y-4 overflow-y-auto flex-1">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Content</label>
                        <textarea id="stickyNoteContent" required rows="4" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent" placeholder="Enter sticky note content..."></textarea>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Color</label>
                        <div class="flex space-x-2">
                            <button type="button" class="color-option w-8 h-8 rounded border-2 border-gray-300" data-color="yellow" style="background-color: #fef3c7;"></button>
                            <button type="button" class="color-option w-8 h-8 rounded border-2 border-gray-300" data-color="pink" style="background-color: #fce7f3;"></button>
                            <button type="button" class="color-option w-8 h-8 rounded border-2 border-gray-300" data-color="blue" style="background-color: #dbeafe;"></button>
                            <button type="button" class="color-option w-8 h-8 rounded border-2 border-gray-300" data-color="green" style="background-color: #d1fae5;"></button>
                            <button type="button" class="color-option w-8 h-8 rounded border-2 border-gray-300" data-color="purple" style="background-color: #e9d5ff;"></button>
                            <button type="button" class="color-option w-8 h-8 rounded border-2 border-gray-300" data-color="orange" style="background-color: #fed7aa;"></button>
                        </div>
                    </div>
                </div>

                <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900 flex-shrink-0">
                    <button type="button" id="cancelStickyNoteBtn" class="px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors">
                        Cancel
                    </button>
                    <button type="submit" class="px-4 py-2 text-sm font-medium text-white bg-gray-900 rounded-md hover:bg-gray-700 dark:bg-gray-600 dark:text-white dark:hover:bg-gray-500 transition-colors">
                        Add Sticky Note
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- C4 Component Modal -->
    <div id="c4ComponentModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                <h3 id="c4ComponentModalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">Add C4 Component</h3>
                <div id="c4ComponentIdDisplay" class="text-xs text-gray-500 dark:text-gray-400 mt-1 hidden">ID: <span id="c4ComponentIdValue"></span></div>
            </div>
            <form id="c4ComponentForm" class="p-6 space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Component Name</label>
                    <input type="text" id="c4ComponentName" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent" placeholder="e.g., Web Application, Database, API Gateway">
                </div>
                
                <div class="grid grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Level</label>
                        <select id="c4ComponentLevel" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                            <option value="context">Context</option>
                            <option value="container">Container</option>
                            <option value="component">Component</option>
                            <option value="code">Code</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Type</label>
                        <input type="text" id="c4ComponentType" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent" placeholder="e.g., System, Container, Component">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Technology</label>
                        <input type="text" id="c4ComponentTechnology" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent" placeholder="e.g., React, PostgreSQL, Node.js">
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Description</label>
                    <textarea id="c4ComponentDescription" rows="3" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent" placeholder="Brief description of what this component does..."></textarea>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">X Position</label>
                        <input type="number" id="c4ComponentX" value="100" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Y Position</label>
                        <input type="number" id="c4ComponentY" value="100" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Connections</label>
                    <div class="space-y-2" id="c4ConnectionsForm">
                        <div class="flex space-x-2">
                            <div class="flex-1 relative">
                                <input type="text" placeholder="Target component name" class="c4-target-input w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 text-sm" autocomplete="off">
                                <div class="c4-target-dropdown hidden absolute top-full left-0 right-0 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-b-md max-h-32 overflow-y-auto z-50"></div>
                            </div>
                            <input type="text" placeholder="Relationship label" class="flex-1 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 text-sm">
                            <button type="button" class="px-2 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 text-sm"></button>
                        </div>
                    </div>
                    <button type="button" id="addC4ConnectionBtn" class="mt-2 px-3 py-1 bg-green-600 text-white rounded-md hover:bg-green-700 text-sm">+ Add Connection</button>
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" id="cancelC4ComponentBtn" class="px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors">
                        Cancel
                    </button>
                    <button type="submit" class="px-4 py-2 text-sm font-medium text-white bg-gray-900 rounded-md hover:bg-gray-700 dark:bg-gray-600 dark:text-white dark:hover:bg-gray-500 transition-colors">
                        Add Component
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Task Modal -->
    <div id="taskModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] flex flex-col">
            <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex-shrink-0">
                <h3 id="modalTitle" class="text-lg font-medium text-gray-900 dark:text-gray-100">Add Task</h3>
            </div>
            <form id="taskForm" class="flex flex-col flex-1 overflow-hidden">
            <div class="p-6 space-y-4 overflow-y-auto flex-1">
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Title</label>
                    <input type="text" id="taskTitle" required class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                </div>
                
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Section</label>
                        <select id="taskSection" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                            <!-- Options will be populated dynamically -->
                        </select>
                    </div>
                    <div>
                        <label class="flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                            Priority
                            <span class="help-tip" data-tip="P1 (red) = Critical/Blocker. P2 (orange) = High priority. P3 (yellow) = Normal. P4 (blue) = Low. P5 (gray) = Nice to have.">?</span>
                        </label>
                        <select id="taskPriority" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                            <option value="">Select Priority</option>
                            <option value="1">1 - Highest</option>
                            <option value="2">2 - High</option>
                            <option value="3">3 - Medium</option>
                            <option value="4">4 - Low</option>
                            <option value="5">5 - Lowest</option>
                        </select>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Assignee</label>
                        <select id="taskAssignee" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                            <option value="">Select Assignee</option>
                            <!-- Options will be populated dynamically -->
                        </select>
                    </div>
                    <div>
                        <label class="flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                            Effort (days)
                            <span class="help-tip" data-tip="Estimated working days to complete. Used for timeline calculations.">?</span>
                        </label>
                        <input type="number" id="taskEffort" min="1" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Due Date</label>
                    <input type="datetime-local" id="taskDueDate" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Planned Start</label>
                        <input type="date" id="taskPlannedStart" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Planned End</label>
                        <input type="date" id="taskPlannedEnd" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                    </div>
                </div>

                <div id="timeEntriesSection" class="hidden border-t border-gray-200 dark:border-gray-700 pt-4 mt-4">
                    <div class="flex justify-between items-center mb-3">
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Time Entries</label>
                        <button type="button" id="addTimeEntryBtn" class="text-sm text-gray-900 dark:text-gray-100 hover:text-gray-600 dark:hover:text-gray-300 underline">+ Add Entry</button>
                    </div>
                    <div id="timeEntriesList" class="space-y-2 max-h-40 overflow-y-auto">
                    </div>
                    <div id="addTimeEntryForm" class="hidden mt-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-md">
                        <div class="grid grid-cols-4 gap-2 mb-2">
                            <input type="date" id="timeEntryDate" class="border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 rounded px-2 py-1 text-sm">
                            <input type="number" id="timeEntryHours" step="0.5" min="0" placeholder="Hours" class="border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 rounded px-2 py-1 text-sm">
                            <input type="text" id="timeEntryPerson" placeholder="Person" class="border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 rounded px-2 py-1 text-sm">
                            <input type="text" id="timeEntryDescription" placeholder="Description" class="border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 rounded px-2 py-1 text-sm">
                        </div>
                        <div class="flex justify-end gap-2">
                            <button type="button" id="cancelTimeEntryBtn" class="text-xs text-gray-500 hover:text-gray-700 dark:hover:text-gray-300">Cancel</button>
                            <button type="button" id="saveTimeEntryBtn" class="text-xs text-gray-900 dark:text-gray-100 hover:text-gray-600 dark:hover:text-gray-300 underline">Save</button>
                        </div>
                    </div>
                    <div id="totalHoursDisplay" class="mt-2 text-sm text-gray-600 dark:text-gray-400">
                        Total: <span id="totalHoursValue">0</span>h logged
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Milestone</label>
                    <input type="text" id="taskMilestone" placeholder="e.g., v1.0, Sprint 2, Alpha" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent">
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tags</label>
                    <select id="taskTags" multiple class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent" style="min-height: 80px;">
                        <!-- Options will be populated dynamically -->
                    </select>
                </div>

                <div>
                    <label class="flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                        Blocked By
                        <span class="help-tip" data-tip="Tasks that must be completed before this one can start. Used for timeline scheduling.">?</span>
                    </label>
                    <div class="space-y-2">
                        <div class="relative">
                            <input type="text" id="taskBlockedBy" placeholder="Type to search tasks..." class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent" autocomplete="off">
                            <div id="dependencyDropdown" class="absolute z-10 w-full bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-lg mt-1 max-h-48 overflow-y-auto hidden">
                                <!-- Autocomplete options will appear here -->
                            </div>
                        </div>
                        <div id="selectedDependencies" class="flex flex-wrap gap-2">
                            <!-- Selected dependencies will appear here as chips -->
                        </div>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Description</label>
                    <textarea id="taskDescription" rows="3" class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent"></textarea>
                </div>
            </div>

                <div class="flex justify-end space-x-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900 flex-shrink-0">
                    <button type="button" id="cancelBtn" class="px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors">
                        Cancel
                    </button>
                    <button type="submit" class="px-4 py-2 text-sm font-medium text-white bg-gray-900 rounded-md hover:bg-gray-700 dark:bg-gray-600 dark:text-white dark:hover:bg-gray-500 transition-colors">
                        Save Task
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Task Sidenav Panel -->
    <div id="taskSidenav" class="sidenav-panel sidenav-md">
        <div class="sidenav-header">
            <h2 id="sidenavTaskTitle" class="sidenav-title">Add Task</h2>
            <button type="button" id="sidenavTaskClose" class="sidenav-close" aria-label="Close">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </div>
        <form id="sidenavTaskForm" class="flex flex-col flex-1 overflow-hidden">
            <div class="sidenav-content">
                <div class="sidenav-section">
                    <div class="form-group">
                        <label class="form-label">Title</label>
                        <input type="text" id="sidenavTaskTitleInput" required class="form-input">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Description</label>
                        <textarea id="sidenavTaskDescription" rows="3" class="form-textarea"></textarea>
                    </div>
                </div>

                <div class="sidenav-section">
                    <div class="sidenav-section-title">Details</div>
                    <div class="sidenav-grid">
                        <div class="form-group">
                            <label class="form-label">Section</label>
                            <select id="sidenavTaskSection" class="form-select"></select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Priority</label>
                            <select id="sidenavTaskPriority" class="form-select">
                                <option value="">None</option>
                                <option value="1">P1 - Critical</option>
                                <option value="2">P2 - High</option>
                                <option value="3">P3 - Medium</option>
                                <option value="4">P4 - Low</option>
                                <option value="5">P5 - Minor</option>
                            </select>
                        </div>
                    </div>
                    <div class="sidenav-grid">
                        <div class="form-group">
                            <label class="form-label">Assignee</label>
                            <select id="sidenavTaskAssignee" class="form-select"></select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Effort (days)</label>
                            <input type="number" id="sidenavTaskEffort" min="1" class="form-input">
                        </div>
                    </div>
                </div>

                <div class="sidenav-section">
                    <div class="sidenav-section-title">Schedule</div>
                    <div class="form-group">
                        <label class="form-label">Due Date</label>
                        <input type="datetime-local" id="sidenavTaskDueDate" class="form-input">
                    </div>
                    <div class="sidenav-grid">
                        <div class="form-group">
                            <label class="form-label">Planned Start</label>
                            <input type="date" id="sidenavTaskPlannedStart" class="form-input">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Planned End</label>
                            <input type="date" id="sidenavTaskPlannedEnd" class="form-input">
                        </div>
                    </div>
                </div>

                <div class="sidenav-section">
                    <div class="sidenav-section-title">Organization</div>
                    <div class="form-group">
                        <label class="form-label">Milestone</label>
                        <input type="text" id="sidenavTaskMilestone" placeholder="e.g., v1.0, Sprint 2" class="form-input">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Tags</label>
                        <select id="sidenavTaskTags" multiple class="form-select" style="min-height: 80px;"></select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Blocked By</label>
                        <input type="text" id="sidenavTaskBlockedBy" placeholder="Search tasks..." class="form-input" autocomplete="off">
                        <div id="sidenavDependencyDropdown" class="absolute z-10 w-full bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-lg mt-1 max-h-48 overflow-y-auto hidden"></div>
                        <div id="sidenavSelectedDependencies" class="flex flex-wrap gap-2 mt-2"></div>
                    </div>
                </div>
            </div>

            <div class="sidenav-footer">
                <button type="button" id="sidenavTaskCancel" class="px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600">
                    Cancel
                </button>
                <button type="submit" class="px-4 py-2 text-sm font-medium text-white bg-gray-900 dark:bg-gray-600 rounded-md hover:bg-gray-700 dark:hover:bg-gray-500">
                    Save Task
                </button>
            </div>
        </form>
    </div>

    <!-- Footer -->
    <footer id="app-footer" class="fixed bottom-0 left-0 right-0 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 py-2 px-4 text-xs text-gray-500 dark:text-gray-400 flex justify-between items-center z-40">
        <div class="flex items-center gap-2">
            <span id="versionDisplay">MD Planner v0.1.0</span>
            <span id="updateBadge" class="hidden px-1.5 py-0.5 bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 rounded text-xs cursor-pointer hover:bg-green-200 dark:hover:bg-green-800" onclick="window.open('https://github.com/studiowebux/mdplanner/releases', '_blank')">Update available</span>
        </div>
        <a href="https://github.com/studiowebux/mdplanner" target="_blank" rel="noopener noreferrer" class="hover:text-gray-900 dark:text-gray-100 dark:hover:text-gray-300 underline transition-colors">GitHub</a>
    </footer>

    <!-- Focus Mode Container -->
    <div id="focusModeContainer" class="hidden"></div>

    <!-- Portfolio Detail Panel -->
    <div id="portfolioDetailPanel" class="sidenav-panel sidenav-md">
        <div class="sidenav-header">
            <h2 class="sidenav-title" id="portfolioDetailTitle">Project Details</h2>
            <button type="button" id="portfolioDetailClose" class="sidenav-close" aria-label="Close">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </div>
        <div class="sidenav-content" id="portfolioDetailContent">
            <!-- Content rendered by JS -->
        </div>
        <div class="sidenav-footer">
            <button type="button" id="portfolioDetailSave" class="btn btn-primary">Save Changes</button>
        </div>
    </div>

    <!-- Help Panel -->
    <div id="helpPanel" class="sidenav-panel sidenav-sm">
        <div class="sidenav-header">
            <h2 class="sidenav-title">Help</h2>
            <button type="button" id="helpPanelClose" class="sidenav-close" aria-label="Close">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </div>
        <div class="sidenav-content">
            <section id="helpContextSection" class="sidenav-section"></section>
            <section id="helpTipsSection" class="sidenav-section"></section>
            <section id="helpShortcutsSection" class="sidenav-section"></section>
            <section id="helpDocsSection" class="sidenav-section"></section>
        </div>
        <div class="sidenav-footer help-footer">
            <span class="help-footer-hint">Press <kbd class="help-kbd">?</kbd> to toggle help</span>
        </div>
    </div>

    <script type="module" src="app.js"></script>
</body>
</html>