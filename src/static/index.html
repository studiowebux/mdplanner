<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>MD Planner</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;600;700&family=Roboto+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    >
    <!-- CSS theme system -->
    <link rel="stylesheet" href="/css/index.css">
  </head>
  <body class="bg-secondary min-h-screen transition-colors">
    <!-- Skip Link for Keyboard Navigation -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Header -->
    <header
      class="bg-primary border-b border-default"
    >
      <div class="max-w-7xl mx-auto px-4">
        <!-- Mobile header -->
        <div class="flex items-center justify-between h-14 lg:hidden">
          <h1 class="text-base font-semibold text-primary">
            MD Planner
          </h1>
          <div class="flex items-center gap-2">
            <button id="addTaskBtnMobile" class="btn-primary px-3 py-1.5">
              +
            </button>
            <button
              id="mobileMenuToggle"
              class="p-2 text-secondary"
            >
              <svg
                class="w-6 h-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="1.5"
                  d="M4 6h16M4 12h16M4 18h16"
                >
                </path>
              </svg>
            </button>
          </div>
        </div>

        <!-- Desktop header - Row 1: Logo, Project, Actions -->
        <div class="hidden lg:flex items-center justify-between h-12">
          <div class="flex items-center gap-4">
            <h1
              class="text-base font-semibold text-primary"
            >
              MD Planner
            </h1>
            <span id="currentViewLabel" class="hidden">Summary</span>
            <span
              id="projectName"
              class="text-sm text-secondary max-w-[200px] truncate"
            >Loading...</span>
          </div>

          <!-- Right: Actions -->
          <div class="flex items-center gap-2">
            <!-- Search -->
            <button id="globalSearchBtn" class="search-trigger-btn" title="Search (⌘K)">
              <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
              </svg>
              Search
              <span class="search-trigger-kbd">⌘K</span>
            </button>

            <!-- Pomodoro -->
            <div class="relative">
              <button
                id="pomodoroBtn"
                class="p-2 flex items-center justify-center gap-1.5 text-muted hover:text-primary"
                title="Pomodoro"
              >
                <svg
                  class="w-5 h-5 flex-shrink-0"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="1.5"
                    d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"
                  >
                  </path>
                </svg>
                <span
                  id="pomodoroDisplay"
                  class="text-xs font-mono font-medium hidden"
                >25:00</span>
              </button>
              <div
                id="pomodoroDropdown"
                class="absolute right-0 mt-2 w-56 bg-primary rounded-lg shadow-lg border border-default hidden z-50 p-4"
              >
                <div class="flex justify-center mb-2">
                  <span
                    class="help-tip"
                    data-tip="Pomodoro: 25 min focus, then 5 min short break. After 4 cycles, take a 15 min long break."
                  >?</span>
                </div>
                <div class="text-center mb-4">
                  <div
                    id="pomodoroTimer"
                    class="text-3xl font-mono font-bold text-primary"
                  >
                    25:00
                  </div>
                  <div
                    id="pomodoroLabel"
                    class="text-xs text-muted mt-1"
                  >
                    Focus Time
                  </div>
                </div>
                <div class="flex justify-center gap-2 mb-3">
                  <button id="pomodoroStartBtn" class="btn-primary">
                    Start
                  </button>
                  <button id="pomodoroStopBtn" class="btn-primary hidden">
                    Stop
                  </button>
                </div>
                <div class="flex justify-center gap-1 mb-3">
                  <button
                    id="pomodoroFocusBtn"
                    class="px-2 py-1 rounded text-xs font-medium bg-inverse text-inverse"
                  >
                    Focus
                  </button>
                  <button
                    id="pomodoroShortBtn"
                    class="px-2 py-1 rounded text-xs text-secondary hover:bg-tertiary"
                  >
                    Short
                  </button>
                  <button
                    id="pomodoroLongBtn"
                    class="px-2 py-1 rounded text-xs text-secondary hover:bg-tertiary"
                  >
                    Long
                  </button>
                  <button
                    id="pomodoroDebugBtn"
                    class="px-2 py-1 rounded text-xs text-secondary hover:bg-tertiary"
                  >
                    5s
                  </button>
                </div>
                <div class="text-center text-xs text-muted">
                  <span id="pomodoroCount">0</span> completed
                </div>
                <div
                  class="flex items-center justify-center gap-2 mt-3 pt-3 border-t border-default"
                >
                  <label
                    class="flex items-center gap-1.5 text-xs text-muted cursor-pointer"
                  >
                    <input
                      type="checkbox"
                      id="pomodoroSoundToggle"
                      class="rounded border-strong w-3 h-3"
                    > Sound
                  </label>
                </div>
                <div id="pomodoroNotifStatus" class="text-center text-xs mt-2">
                </div>
              </div>
            </div>

            <!-- Import/Export -->
            <div class="relative">
              <button
                id="importExportBtn"
                class="p-2 text-muted hover:text-primary"
                title="Import/Export"
              >
                <svg
                  class="w-5 h-5"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="1.5"
                    d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"
                  >
                  </path>
                </svg>
              </button>
              <div
                id="importExportDropdown"
                class="absolute right-0 mt-2 w-40 bg-primary rounded-lg shadow-lg border border-default hidden z-50 py-1"
              >
                <button
                  id="exportTasksBtn"
                  class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
                >
                  Export CSV
                </button>
                <button
                  id="importTasksBtn"
                  class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
                >
                  Import CSV
                </button>
                <button
                  id="exportReportBtn"
                  class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
                >
                  Export PDF
                </button>
              </div>
            </div>

            <!-- Dark mode -->
            <button
              id="darkModeToggle"
              class="p-2 text-muted hover:text-primary"
              title="Toggle theme"
            >
              <svg
                class="w-5 h-5 dark-hidden"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="1.5"
                  d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"
                >
                </path>
              </svg>
              <svg
                class="w-5 h-5 hidden dark-visible"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="1.5"
                  d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"
                >
                </path>
              </svg>
            </button>

            <!-- Fullscreen -->
            <button
              id="fullscreenToggle"
              class="p-2 text-muted hover:text-primary"
              title="Fullscreen"
            >
              <svg
                id="fullscreenIcon"
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="1.5"
                  d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"
                >
                </path>
              </svg>
              <svg
                id="exitFullscreenIcon"
                class="w-5 h-5 hidden"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="1.5"
                  d="M9 9V4.5M9 9H4.5M9 9L3.5 3.5M15 9h4.5M15 9V4.5M15 9l5.5-5.5M9 15H4.5M9 15v4.5M9 15l-5.5 5.5M15 15h4.5M15 15v4.5m0-4.5l5.5 5.5"
                >
                </path>
              </svg>
            </button>

            <!-- Help -->
            <button
              id="helpBtn"
              class="p-2 text-muted hover:text-primary"
              title="Help (?)"
            >
              <svg
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="1.5"
                  d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                >
                </path>
              </svg>
            </button>

            <!-- Settings -->
            <button
              id="configViewBtn"
              class="p-2 text-muted hover:text-primary"
              title="Settings"
            >
              <svg
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="1.5"
                  d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"
                >
                </path>
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="1.5"
                  d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
                >
                </path>
              </svg>
            </button>

            <!-- Add Task -->
            <button id="addTaskBtn" class="btn-primary">+ Task</button>
          </div>
        </div>

        <!-- Desktop header - Row 2: Category Navigation -->
        <div
          class="hidden lg:flex items-center gap-1 h-10 border-t border-default"
        >
          <!-- Summary - Top level button -->
          <button
            id="summaryViewBtn"
            data-view="summary"
            class="nav-dropdown-btn"
          >
            Summary
          </button>

          <!-- Tasks -->
          <div class="relative nav-dropdown">
            <button
              class="nav-dropdown-btn flex items-center gap-1"
            >
              Tasks
              <svg
                class="w-3 h-3"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"
                >
                </path>
              </svg>
            </button>
            <div
              class="nav-dropdown-menu absolute left-0 mt-1 w-36 hidden z-50 py-1"
            >
              <button
                id="listViewBtn"
                data-view="list"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                List
              </button>
              <button
                id="boardViewBtn"
                data-view="board"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                Board
              </button>
              <button
                id="timelineViewBtn"
                data-view="timeline"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                Timeline
              </button>
            </div>
          </div>

          <!-- Planning -->
          <div class="relative nav-dropdown">
            <button
              class="nav-dropdown-btn flex items-center gap-1"
            >
              Planning
              <svg
                class="w-3 h-3"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"
                >
                </path>
              </svg>
            </button>
            <div
              class="nav-dropdown-menu absolute left-0 mt-1 w-40 hidden z-50 py-1"
            >
              <button
                id="goalsViewBtn"
                data-view="goals"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                Goals
              </button>
              <button
                id="milestonesViewBtn"
                data-view="milestones"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                Milestones
              </button>
              <button
                id="ideasViewBtn"
                data-view="ideas"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                Ideas
              </button>
              <button
                id="retrospectivesViewBtn"
                data-view="retrospectives"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                Retrospectives
              </button>
              <button
                id="moscowViewBtn"
                data-view="moscow"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                MoSCoW
              </button>
              <button
                id="eisenhowerViewBtn"
                data-view="eisenhower"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                Eisenhower
              </button>
              <button
                id="ideaSorterViewBtn"
                data-view="ideaSorter"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                Idea Sorter
              </button>
            </div>
          </div>

          <!-- Strategy -->
          <div class="relative nav-dropdown">
            <button
              class="nav-dropdown-btn flex items-center gap-1"
            >
              Strategy
              <svg
                class="w-3 h-3"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"
                >
                </path>
              </svg>
            </button>
            <div
              class="nav-dropdown-menu absolute left-0 mt-1 w-40 hidden z-50 py-1"
            >
              <button
                id="swotViewBtn"
                data-view="swot"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                SWOT
              </button>
              <button
                id="riskAnalysisViewBtn"
                data-view="riskAnalysis"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                Risk
              </button>
              <button
                id="leanCanvasViewBtn"
                data-view="leanCanvas"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                Lean Canvas
              </button>
              <button
                id="businessModelViewBtn"
                data-view="businessModel"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                Business Model
              </button>
              <button
                id="projectValueViewBtn"
                data-view="projectValue"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                Value Board
              </button>
              <button
                id="briefViewBtn"
                data-view="brief"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                Brief
              </button>
            </div>
          </div>

          <!-- Finances -->
          <div class="relative nav-dropdown">
            <button
              class="nav-dropdown-btn flex items-center gap-1"
            >
              Finances
              <svg
                class="w-3 h-3"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"
                >
                </path>
              </svg>
            </button>
            <div
              class="nav-dropdown-menu absolute left-0 mt-1 w-40 hidden z-50 py-1"
            >
              <button
                id="fundraisingViewBtn"
                data-view="fundraising"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                Fundraising
              </button>
              <button
                id="billingViewBtn"
                data-view="billing"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                Billing
              </button>
              <button
                id="financesViewBtn"
                data-view="finances"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                Finances
              </button>
            </div>
          </div>

          <!-- Diagrams -->
          <div class="relative nav-dropdown">
            <button
              class="nav-dropdown-btn flex items-center gap-1"
            >
              Diagrams
              <svg
                class="w-3 h-3"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"
                >
                </path>
              </svg>
            </button>
            <div
              class="nav-dropdown-menu absolute left-0 mt-1 w-40 hidden z-50 py-1"
            >
              <button
                id="canvasViewBtn"
                data-view="canvas"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                Canvas
              </button>
              <button
                id="mindmapViewBtn"
                data-view="mindmap"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                Mindmap
              </button>
              <button
                id="c4ViewBtn"
                data-view="c4"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                C4 Architecture
              </button>
            </div>
          </div>

          <!-- Team -->
          <div class="relative nav-dropdown">
            <button
              class="nav-dropdown-btn flex items-center gap-1"
            >
              Team
              <svg
                class="w-3 h-3"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"
                >
                </path>
              </svg>
            </button>
            <div
              class="nav-dropdown-menu absolute left-0 mt-1 w-40 hidden z-50 py-1"
            >
              <button
                id="orgchartViewBtn"
                data-view="orgchart"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                Org Chart
              </button>
              <button
                id="peopleViewBtn"
                data-view="people"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                People
              </button>
              <button
                id="capacityViewBtn"
                data-view="capacity"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                Capacity
              </button>
              <button
                id="timeTrackingViewBtn"
                data-view="timeTracking"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                Time Tracking
              </button>
              <button
                id="crmViewBtn"
                data-view="crm"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                CRM
              </button>
              <button
                id="onboardingViewBtn"
                data-view="onboarding"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                Onboarding
              </button>
            </div>
          </div>

          <!-- Other -->
          <div class="relative nav-dropdown">
            <button
              class="nav-dropdown-btn flex items-center gap-1"
            >
              Notes
              <svg
                class="w-3 h-3"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"
                >
                </path>
              </svg>
            </button>
            <div
              class="nav-dropdown-menu absolute left-0 mt-1 w-40 hidden z-50 py-1"
            >
              <button
                id="notesViewBtn"
                data-view="notes"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                Notes
              </button>
              <button
                id="strategicLevelsViewBtn"
                data-view="strategicLevels"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                Strategic Levels
              </button>
              <button
                id="meetingsViewBtn"
                data-view="meetings"
                class="w-full text-left px-3 py-2 text-sm text-secondary hover:bg-secondary"
              >
                Meetings
              </button>
            </div>
          </div>

          <!-- Portfolio - Top level button -->
          <button
            id="portfolioViewBtn"
            data-view="portfolio"
            class="nav-dropdown-btn"
          >
            Portfolio
          </button>
          <button
            id="uploadsViewBtn"
            data-view="uploads"
            class="nav-dropdown-btn"
          >
            Uploads
          </button>
          <button
            id="ollamaViewBtn"
            data-view="ollama"
            class="nav-dropdown-btn"
          >
            AI Chat
          </button>
        </div>
      </div>

      <!-- Mobile menu -->
      <div
        id="mobileMenu"
        class="hidden lg:hidden border-t border-default bg-primary max-h-[80vh] overflow-y-auto"
      >
        <div class="py-2">
          <!-- Project name -->
          <div class="px-4 py-2 border-b border-default">
            <span
              id="projectNameMobile"
              class="text-sm font-medium text-primary"
            >Loading...</span>
          </div>

          <!-- Search -->
          <div class="px-4 py-2 border-b border-default">
            <button id="globalSearchBtnMobile" class="search-trigger-btn" style="width:100%;justify-content:flex-start;">
              <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
              </svg>
              Search…
            </button>
          </div>

          <!-- Navigation -->
          <div class="py-1">
            <button
              id="summaryViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-primary bg-tertiary"
            >
              Summary
            </button>
          </div>
          <div class="py-1 border-t border-default">
            <div
              class="px-4 py-1 text-xs font-medium text-muted uppercase"
            >
              Tasks
            </div>
            <button
              id="listViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              List
            </button>
            <button
              id="boardViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              Board
            </button>
            <button
              id="timelineViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              Timeline
            </button>
          </div>
          <div class="py-1 border-t border-default">
            <div
              class="px-4 py-1 text-xs font-medium text-muted uppercase"
            >
              Planning
            </div>
            <button
              id="goalsViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              Goals
            </button>
            <button
              id="milestonesViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              Milestones
            </button>
            <button
              id="ideasViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              Ideas
            </button>
            <button
              id="retrospectivesViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              Retrospectives
            </button>
            <button
              id="moscowViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              MoSCoW
            </button>
            <button
              id="eisenhowerViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              Eisenhower
            </button>
            <button
              id="ideaSorterViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              Idea Sorter
            </button>
          </div>
          <div class="py-1 border-t border-default">
            <div
              class="px-4 py-1 text-xs font-medium text-muted uppercase"
            >
              Strategy
            </div>
            <button
              id="swotViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              SWOT
            </button>
            <button
              id="riskAnalysisViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              Risk
            </button>
            <button
              id="leanCanvasViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              Lean Canvas
            </button>
            <button
              id="businessModelViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              Business Model
            </button>
            <button
              id="projectValueViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              Value Board
            </button>
            <button
              id="briefViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              Brief
            </button>
          </div>
          <div class="py-1 border-t border-default">
            <div
              class="px-4 py-1 text-xs font-medium text-muted uppercase"
            >
              Finances
            </div>
            <button
              id="fundraisingViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              Fundraising
            </button>
            <button
              id="billingViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              Billing
            </button>
            <button
              id="financesViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              Finances
            </button>
          </div>
          <div class="py-1 border-t border-default">
            <div
              class="px-4 py-1 text-xs font-medium text-muted uppercase"
            >
              Diagrams
            </div>
            <button
              id="canvasViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              Canvas
            </button>
            <button
              id="mindmapViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              Mindmap
            </button>
            <button
              id="c4ViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              C4 Architecture
            </button>
          </div>
          <div class="py-1 border-t border-default">
            <div
              class="px-4 py-1 text-xs font-medium text-muted uppercase"
            >
              Team
            </div>
            <button
              id="orgchartViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              Org Chart
            </button>
            <button
              id="peopleViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              People
            </button>
            <button
              id="capacityViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              Capacity
            </button>
            <button
              id="timeTrackingViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              Time Tracking
            </button>
            <button
              id="crmViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              CRM
            </button>
            <button
              id="onboardingViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              Onboarding
            </button>
          </div>
          <div class="py-1 border-t border-default">
            <div
              class="px-4 py-1 text-xs font-medium text-muted uppercase"
            >
              Notes
            </div>
            <button
              id="notesViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              Notes
            </button>
            <button
              id="strategicLevelsViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              Strategic Levels
            </button>
            <button
              id="meetingsViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              Meetings
            </button>
            <button
              id="portfolioViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              Portfolio
            </button>
            <button
              id="uploadsViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              Uploads
            </button>
            <button
              id="ollamaViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              AI Chat
            </button>
            <button
              id="configViewBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              Settings
            </button>
            <button
              id="helpBtnMobile"
              class="w-full text-left px-4 py-2.5 text-sm text-secondary"
            >
              Help
            </button>
          </div>
          <!-- Quick Actions -->
          <div
            class="py-2 px-4 border-t border-default flex items-center justify-between"
          >
            <div class="flex items-center gap-3">
              <button
                id="darkModeToggleMobile"
                class="p-2 text-muted hover:text-primary rounded-lg hover:bg-tertiary"
                title="Toggle theme"
              >
                <svg
                  class="w-5 h-5 dark-hidden"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="1.5"
                    d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"
                  >
                  </path>
                </svg>
                <svg
                  class="w-5 h-5 hidden dark-visible"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="1.5"
                    d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"
                  >
                  </path>
                </svg>
              </button>
              <button
                id="pomodoroBtnMobile"
                class="p-2 text-muted hover:text-primary rounded-lg hover:bg-tertiary"
                title="Pomodoro"
              >
                <svg
                  class="w-5 h-5"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="1.5"
                    d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"
                  >
                  </path>
                </svg>
              </button>
              <button
                id="importExportBtnMobile"
                class="p-2 text-muted hover:text-primary rounded-lg hover:bg-tertiary"
                title="Import/Export"
              >
                <svg
                  class="w-5 h-5"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="1.5"
                    d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"
                  >
                  </path>
                </svg>
              </button>
            </div>
            <span class="text-xs text-muted">v1.0</span>
          </div>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main
      id="main-content"
      class="max-w-7xl mx-auto px-2 sm:px-4 lg:px-8 py-4 sm:py-8 pb-16"
    >
      <!-- Breadcrumb Navigation -->
      <div id="breadcrumb"></div>

      <!-- Loading State -->
      <div id="loading" class="hidden">
        <div class="flex justify-center items-center h-64">
          <div
            class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary"
          ></div>
        </div>
      </div>

      <!-- Portfolio View -->
      <div id="portfolioView" class="hidden pb-16">
        <!-- Summary Cards -->
        <div
          id="portfolioSummaryCards"
          class="grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6"
        >
          <!-- Cards rendered by JS -->
        </div>

        <!-- Search + Filter Bar -->
        <div class="flex flex-wrap items-center gap-2 mb-2">
          <input
            type="search"
            id="portfolioSearch"
            class="form-input"
            placeholder="Search projects…"
            style="max-width: 18rem"
          >
        </div>
        <div class="flex flex-wrap items-center justify-between gap-2 mb-4">
          <div
            id="portfolioFilterBar"
            class="flex flex-wrap items-center gap-2"
          >
            <!-- Filters rendered by JS -->
          </div>
          <button
            id="portfolioAddBtn"
            class="btn-ghost"
            title="Add project"
          >
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display:inline-block;vertical-align:middle;margin-right:0.25rem"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
            Add Project
          </button>
        </div>

        <!-- Project Grid -->
        <div
          id="portfolioGrid"
          class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"
        >
          <!-- Cards rendered by JS -->
        </div>

        <!-- Empty State -->
        <div id="portfolioEmpty" class="hidden text-center py-12">
          <svg
            class="w-16 h-16 mx-auto text-muted mb-4"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="1"
              d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"
            >
            </path>
          </svg>
          <p class="text-muted text-lg mb-2">
            No projects found
          </p>
          <p class="text-muted text-sm">
            Create a new project to get started
          </p>
        </div>
      </div>

      <!-- Summary View -->
      <div id="summaryView" class="hidden pb-16">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 lg:gap-8">
          <!-- Project Info -->
          <div class="lg:col-span-2 space-y-4">
            <div class="bg-primary rounded-lg shadow p-4 sm:p-6">
              <div
                class="flex flex-wrap items-start justify-between gap-3 mb-4"
              >
                <h2
                  id="projectName"
                  class="text-xl sm:text-2xl font-bold text-primary"
                >
                  Project Name
                </h2>
                <div class="flex items-center gap-1">
                  <select
                    id="projectStatus"
                    class="text-sm border border-strong rounded-md px-2 py-1 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                  >
                    <option value="active">Active</option>
                    <option value="on-track">On Track</option>
                    <option value="at-risk">At Risk</option>
                    <option value="late">Late</option>
                    <option value="on-hold">On Hold</option>
                    <option value="completed">Completed</option>
                  </select>
                  <span
                    class="help-tip"
                    data-tip="Track your project health. On Track = progressing well, At Risk = potential issues, Late = behind schedule."
                  >?</span>
                </div>
              </div>
              <div id="projectStatusComment" class="hidden mb-4">
                <textarea
                  id="statusCommentText"
                  rows="2"
                  placeholder="Status comment (optional)"
                  class="w-full text-sm border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                ></textarea>
              </div>
              <div class="summary-description-header">
                <button
                  id="editDescriptionBtn"
                  type="button"
                  class="summary-edit-btn"
                  title="Edit description"
                >Edit</button>
              </div>
              <div
                id="projectDescription"
                class="prose prose-gray max-w-none"
              >
                <p class="text-secondary">
                  Loading project description...
                </p>
              </div>
              <div id="projectDescriptionEditor" class="hidden">
                <textarea
                  rows="5"
                  class="summary-description-textarea"
                  placeholder="Project description (markdown supported)"
                ></textarea>
                <div class="summary-description-actions">
                  <button
                    id="cancelDescriptionBtn"
                    type="button"
                    class="btn-ghost"
                  >Cancel</button>
                  <button
                    id="saveDescriptionBtn"
                    type="button"
                    class="btn-secondary"
                  >Save</button>
                </div>
              </div>

              <!-- Project Dates -->
              <div
                class="mt-4 pt-4 border-t border-default flex flex-wrap gap-4 text-sm text-secondary"
              >
                <div>
                  <span class="font-medium">Started:</span>
                  <span id="summaryStartDate">-</span>
                </div>
                <div>
                  <span class="font-medium">Last Updated:</span>
                  <span id="summaryLastUpdated">-</span>
                </div>
              </div>
            </div>

            <!-- Useful Links -->
            <div class="bg-primary rounded-lg shadow p-4 sm:p-6">
              <div class="flex justify-between items-center mb-4">
                <h3
                  class="text-lg font-semibold text-primary"
                >
                  Useful Links
                </h3>
                <button
                  id="addLinkBtn"
                  class="text-sm text-primary hover:text-secondary underline"
                >
                  + Add Link
                </button>
              </div>
              <div id="projectLinks" class="space-y-2">
                <p class="text-sm text-muted italic">
                  No links added yet.
                </p>
              </div>

              <!-- Add Link Form (hidden by default) -->
              <div
                id="addLinkForm"
                class="hidden mt-4 pt-4 border-t border-default"
              >
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                  <input
                    type="text"
                    id="linkTitle"
                    placeholder="Title"
                    class="w-full border border-strong rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                  >
                  <input
                    type="url"
                    id="linkUrl"
                    placeholder="https://..."
                    class="w-full border border-strong rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                  >
                </div>
                <div class="flex justify-end gap-2 mt-3">
                  <button
                    id="cancelLinkBtn"
                    type="button"
                    class="px-3 py-1.5 text-sm text-secondary hover:text-primary"
                  >
                    Cancel
                  </button>
                  <button
                    id="saveLinkBtn"
                    type="button"
                    class="px-3 py-1.5 text-sm bg-inverse text-inverse rounded-md hover:bg-active"
                  >
                    Save
                  </button>
                </div>
              </div>
            </div>

            <!-- Task Deadlines -->
            <div class="bg-primary rounded-lg shadow p-4 sm:p-6">
              <h3
                class="text-lg font-semibold text-primary mb-4"
              >
                Task Deadlines
              </h3>
              <div id="taskDeadlines" class="space-y-4">
                <p class="text-sm text-muted italic">
                  No upcoming deadlines.
                </p>
              </div>
            </div>
          </div>

          <!-- Project Stats -->
          <div class="space-y-4 sm:space-y-6">
            <div class="bg-primary rounded-lg shadow p-4 sm:p-6">
              <h3
                class="text-lg font-semibold text-primary mb-4"
              >
                Task Overview
              </h3>
              <div class="space-y-4">
                <div class="flex justify-between items-center">
                  <span class="text-sm text-secondary"
                  >Total Tasks</span>
                  <span
                    id="totalTasks"
                    class="text-lg font-semibold text-primary"
                  >0</span>
                </div>
                <div class="flex justify-between items-center">
                  <span class="text-sm text-secondary"
                  >Completed</span>
                  <span
                    id="completedTasks"
                    class="text-lg font-semibold text-success"
                  >0</span>
                </div>
                <div id="dynamicSectionCounts">
                  <!-- Dynamic section counts will be populated here -->
                </div>
              </div>

              <!-- Progress Bar -->
              <div class="mt-6">
                <div
                  class="flex justify-between text-sm text-secondary mb-2"
                >
                  <span>Progress</span>
                  <span id="progressPercent">0%</span>
                </div>
                <div
                  class="w-full bg-active rounded-full h-2"
                >
                  <div
                    id="progressBar"
                    class="bg-success h-2 rounded-full transition-all duration-300"
                    style="width: 0%"
                  >
                  </div>
                </div>
              </div>
            </div>

            <!-- Section Breakdown -->
            <div class="bg-primary rounded-lg shadow p-6">
              <h3
                class="text-lg font-semibold text-primary mb-4"
              >
                Section Breakdown
              </h3>
              <div id="sectionBreakdown" class="space-y-3">
                <!-- Section counts will be populated dynamically -->
              </div>
            </div>

            <!-- Milestones -->
            <div
              id="milestonesSection"
              class="bg-primary rounded-lg shadow p-6 hidden"
            >
              <h3
                class="text-lg font-semibold text-primary mb-4"
              >
                Milestones
              </h3>
              <div id="milestoneBreakdown" class="space-y-3">
                <!-- Milestone counts will be populated dynamically -->
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- List View -->
      <div id="listView" class="hidden pb-16">
        <div
          class="bg-primary rounded-lg shadow overflow-hidden"
        >
          <div class="px-6 py-4 border-b border-default">
            <div class="flex flex-wrap items-center justify-between gap-3">
              <h2 class="text-lg font-medium text-primary">
                Tasks
              </h2>
              <div class="flex flex-wrap items-center gap-2">
                <select
                  id="filterSection"
                  class="text-sm border border-strong rounded-md px-2 py-1"
                >
                  <option value="">All Sections</option>
                </select>
                <select
                  id="filterAssignee"
                  class="text-sm border border-strong rounded-md px-2 py-1"
                >
                  <option value="">All Assignees</option>
                </select>
                <select
                  id="filterMilestone"
                  class="text-sm border border-strong rounded-md px-2 py-1"
                >
                  <option value="">All Milestones</option>
                </select>
                <select
                  id="filterStatus"
                  class="text-sm border border-strong rounded-md px-2 py-1"
                >
                  <option value="">All Status</option>
                  <option value="incomplete">Incomplete</option>
                  <option value="completed">Completed</option>
                </select>
                <select
                  id="sortTasks"
                  class="text-sm border border-strong rounded-md px-2 py-1"
                >
                  <option value="default">Default Order</option>
                  <option value="due_date">Due Date</option>
                  <option value="priority">Priority</option>
                  <option value="title">Title (A-Z)</option>
                </select>
                <button
                  id="clearFilters"
                  class="text-sm text-muted hover:text-secondary hidden"
                >
                  Clear
                </button>
              </div>
            </div>
          </div>
          <div class="divide-y divide-y border-default">
            <div id="listContainer"></div>
          </div>
        </div>
      </div>

      <!-- Board View -->
      <div id="boardView" class="hidden pb-16">
        <div
          id="boardContainer"
          class="grid gap-4 lg:gap-6 auto-cols-min grid-flow-col overflow-x-auto pb-4"
        >
          <!-- Columns will be generated dynamically -->
        </div>
      </div>

      <!-- Uploads Management View -->
      <div id="uploadsView" class="hidden pb-16">
        <div class="bg-primary rounded-lg shadow">
          <div class="view-header">
            <h2>Uploads</h2>
          </div>
          <div class="p-6">
            <div id="uploadsContent"></div>
          </div>
        </div>
      </div>

      <!-- Meetings View -->
      <div id="meetingsView" class="hidden pb-16">
        <div class="bg-primary rounded-lg shadow">
          <div class="px-6 py-4 border-b border-default flex justify-between items-center view-header">
            <h2 class="text-lg font-medium text-primary">Meetings</h2>
            <button id="addMeetingBtn" class="btn-primary py-2 rounded-lg">+ New Meeting</button>
          </div>
          <!-- Tab bar -->
          <nav class="view-tabs">
            <button id="meetingsTabMeetings" class="view-tab active">Meetings</button>
            <button id="meetingsTabActions" class="view-tab">Open Actions</button>
          </nav>
          <div class="p-6">
            <!-- Meetings list -->
            <div id="meetingsList">
              <div id="emptyMeetingsState" class="hidden">
                <p class="text-secondary text-sm">No meetings yet. Create your first meeting.</p>
              </div>
              <div id="meetingsContainer" class="meetings-grid"></div>
            </div>
            <!-- Actions list -->
            <div id="meetingsActionsList" class="hidden">
              <div class="meetings-actions-filter">
                <input id="meetingsOwnerFilter" type="text" placeholder="Filter by owner..." />
              </div>
              <div id="emptyMeetingsActionsState" class="hidden">
                <p class="text-secondary text-sm">No open action items.</p>
              </div>
              <div id="meetingsActionsContainer"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Onboarding View -->
      <div id="onboardingView" class="hidden pb-16">
        <div class="bg-primary rounded-lg shadow">
          <div class="px-6 py-4 border-b border-default flex justify-between items-center view-header">
            <h2 class="text-lg font-medium text-primary">Onboarding</h2>
            <div class="flex gap-2">
              <button id="addOnboardingTemplateBtn" class="btn-secondary py-2 rounded-lg">+ Template</button>
              <button id="addOnboardingBtn" class="btn-primary py-2 rounded-lg">+ New Onboarding</button>
            </div>
          </div>
          <nav class="view-tabs">
            <button id="onboardingTabRecords" class="view-tab active">Onboarding</button>
            <button id="onboardingTabTemplates" class="view-tab">Templates</button>
          </nav>
          <div class="p-6">
            <!-- Records -->
            <div id="onboardingRecordsList">
              <div id="emptyOnboardingState" class="hidden">
                <p class="text-secondary text-sm">No onboarding records yet. Create one to get started.</p>
              </div>
              <div id="onboardingContainer" class="onboarding-list"></div>
            </div>
            <!-- Templates -->
            <div id="onboardingTemplatesList" class="hidden">
              <div id="emptyOnboardingTemplatesState" class="hidden">
                <p class="text-secondary text-sm">No templates yet. Create a template to reuse onboarding steps.</p>
              </div>
              <div id="onboardingTemplatesContainer" class="onboarding-template-list"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Finances View -->
      <div id="financesView" class="hidden pb-16">
        <div class="bg-primary rounded-lg shadow">
          <div class="px-6 py-4 border-b border-default flex justify-between items-center view-header">
            <h2 class="text-lg font-medium text-primary">Finances</h2>
            <button id="addFinancesBtn" class="btn-primary py-2 rounded-lg">+ Add Period</button>
          </div>
          <nav class="view-tabs">
            <button id="financesTab-overview" class="view-tab active">Overview</button>
            <button id="financesTab-burnrate" class="view-tab">Burn Rate</button>
            <button id="financesTab-pl" class="view-tab">P&amp;L</button>
          </nav>
          <!-- Overview tab -->
          <div id="financesPanel-overview">
            <div id="emptyFinancesState" class="hidden">
              <p class="finances-empty-msg">No periods yet. Add your first monthly record to get started.</p>
            </div>
            <div id="financesOverviewContainer"></div>
          </div>
          <!-- Burn Rate tab -->
          <div id="financesPanel-burnrate" class="hidden">
            <div id="financesBurnRateContainer"></div>
          </div>
          <!-- P&L tab -->
          <div id="financesPanel-pl" class="hidden">
            <div id="financesPLContainer"></div>
          </div>
        </div>
      </div>

      <!-- AI Chat (Ollama) View -->
      <div id="ollamaView" class="hidden">
        <div class="ollama-view-root">

          <!-- Main chat area — centered, full height -->
          <div class="chat">

            <!-- Config panel — overlay from the right, inside the chat container -->
            <div class="config-panel" id="configPanel">
              <div class="config-panel-header">
                <span>Configuration</span>
                <button class="btn-ghost" onclick="App.toggleConfig()">Close</button>
              </div>
              <div class="config-panel-body">
                <div>
                  <label>Ollama Base URL</label>
                  <input id="configBaseUrl" placeholder="http://localhost:11434" />
                </div>
                <div class="config-row">
                  <div>
                    <label>Model</label>
                    <select id="configModelSelect"></select>
                  </div>
                  <div class="config-btn-row">
                    <button class="btn-ghost" onclick="App.loadModels()">Refresh</button>
                    <button class="btn-ghost" onclick="App.unloadModel()" title="Unload model from VRAM">Unload</button>
                  </div>
                </div>
                <div>
                  <label>System Prompt</label>
                  <textarea id="configSystemPrompt" rows="3" placeholder="Optional: set a system prompt..."></textarea>
                </div>
                <div class="slider-group">
                  <div>
                    <div class="slider-label">
                      <label>Temperature</label>
                      <span id="tempValue">0.7</span>
                    </div>
                    <input type="range" id="configTemperature" min="0" max="2" step="0.1" value="0.7" />
                  </div>
                  <div>
                    <div class="slider-label">
                      <label>Top P</label>
                      <span id="topPValue">0.9</span>
                    </div>
                    <input type="range" id="configTopP" min="0" max="1" step="0.05" value="0.9" />
                  </div>
                </div>
                <div>
                  <div class="slider-label">
                    <label>Context Size (num_ctx)</label>
                    <span id="numCtxValue">8192</span>
                  </div>
                  <input type="range" id="configNumCtx" min="2048" max="131072" step="1024" value="8192" />
                </div>
                <div>
                  <label>Search URL (SearXNG — optional)</label>
                  <input id="configSearchUrl" placeholder="http://localhost:8888" />
                </div>
                <div>
                  <label>Chatterbox TTS URL (optional)</label>
                  <input id="configChatterboxUrl" placeholder="http://localhost:8001" />
                </div>
                <div class="config-row">
                  <div>
                    <label>TTS Voice</label>
                    <select id="configChatterboxVoice"><option value="">-- select voice --</option></select>
                  </div>
                  <div class="config-tts-voice-refresh">
                    <button class="btn-ghost" onclick="App.loadChatterboxVoices()">Refresh</button>
                  </div>
                </div>
                <div>
                  <label class="ollama-tts-label">
                    <input type="checkbox" id="configChatterboxAutoUnload" class="ollama-checkbox" />
                    Auto-unload Ollama
                  </label>
                </div>
                <div>
                  <label class="ollama-tts-label">
                    <input type="checkbox" id="configChatterboxSplit" class="ollama-checkbox" />
                    Split text <input type="number" id="configChatterboxSplitChars" min="100" max="2000" step="50" value="400" class="ollama-split-chars" /> chars
                  </label>
                </div>
                <div class="slider-group">
                  <div>
                    <div class="slider-label">
                      <label>TTS Exaggeration</label>
                      <span id="ttsExagerationValue">0.5</span>
                    </div>
                    <input type="range" id="configChatterboxExageration" min="0" max="2" step="0.05" value="0.5" />
                  </div>
                  <div>
                    <div class="slider-label">
                      <label>TTS CFG Weight</label>
                      <span id="ttsCfgWeightValue">0.5</span>
                    </div>
                    <input type="range" id="configChatterboxCfgWeight" min="0" max="1" step="0.05" value="0.5" />
                  </div>
                </div>
                <div>
                  <label>Storage Key</label>
                  <input id="configStorageKey" placeholder="ollama-chat-history" />
                </div>
                <button class="btn-primary" onclick="App.saveConfig()">Save Config</button>
              </div>
            </div>

            <!-- Prompt panel — overlay from the right, inside the chat container -->
            <div class="prompt-panel" id="promptPanel" style="display:none">
              <div class="config-panel-header">
                <span>Saved Prompts</span>
                <button class="btn-ghost" onclick="App.togglePromptPanel()">Close</button>
              </div>
              <div class="config-panel-body">
                <div class="prompt-list" id="promptList"></div>
                <div class="prompt-add">
                  <input id="newPromptTitle" placeholder="Title" />
                  <textarea id="newPromptContent" rows="2" placeholder="Prompt content..."></textarea>
                  <div class="prompt-actions">
                    <button class="btn-ghost" onclick="App.addPrompt()">Add</button>
                    <button class="btn-ghost" onclick="App.exportPrompts()">Export JSON</button>
                    <label class="prompt-import-label">
                      Import
                      <input type="file" accept=".json" style="display:none" onchange="App.importPrompts(this)" />
                    </label>
                  </div>
                </div>
              </div>
            </div>
            <header>
              <div class="left">
                <span class="connection-dot" id="connectionDot" title="Connection status"></span>
                <span>Ollama Chat</span>
                <span class="badge" id="headerModel" style="display: none"></span>
                <span class="badge" id="headerCtx" style="display: none"></span>
                <span class="ctx-usage" id="ctxUsageWrap" style="display: none">
                  <span class="ctx-usage-text" id="ctxUsage"></span>
                  <span class="ctx-usage-track"><span class="ctx-usage-bar" id="ctxBar"></span></span>
                </span>
              </div>
              <div class="right">
                <button id="themeToggleBtn" onclick="App.toggleTheme()">Light</button>
                <button class="btn-ghost" onclick="App.exportChat()">Export</button>
                <button class="btn-ghost" onclick="App.togglePromptPanel()">Prompts</button>
                <button class="btn-ghost" onclick="App.toggleConfig()">Config</button>
                <button class="btn-ghost" onclick="App.clearChat()">Clear</button>
              </div>
            </header>

            <div class="branch-nav" id="branchNav" style="display:none">
              <button id="branchPrev" onclick="App.navigateBranch(-1)">&lt;</button>
              <span id="branchLabel"></span>
              <button id="branchNext" onclick="App.navigateBranch(1)">&gt;</button>
            </div>

            <div class="messages" id="messages"></div>
            <button class="scroll-bottom-btn" id="scrollBottomBtn">Bottom</button>
            <div class="typing" id="typing"></div>

            <div id="imagePreview" class="image-preview"></div>

            <div class="input-area" style="position:relative">
              <button class="search-toggle-btn" id="searchToggleBtn" onclick="App.toggleSearch()" title="Toggle web search">Search</button>
              <button class="attach-btn" id="attachBtn" title="Attach image">Attach</button>
              <textarea id="input" rows="1" placeholder="Type a message... (Enter to send, Shift+Enter for newline)"></textarea>
              <span id="charCount" class="char-count"></span>
              <button class="send-btn" id="sendBtn">Send</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Config View -->
      <div id="configView" class="hidden pb-16">
        <div class="bg-primary rounded-lg shadow p-6">
          <div class="flex items-center justify-between mb-6">
            <h2 class="text-2xl font-bold text-primary">
              Project Configuration
            </h2>
            <button id="saveProjectConfig" class="btn-primary py-2 rounded-lg">
              Save Configuration
            </button>
          </div>

          <!-- Basic Project Settings -->
          <div
            class="grid grid-cols-1 lg:grid-cols-2 gap-4 lg:gap-8 mb-6 lg:mb-8"
          >
            <div>
              <h3
                class="text-lg font-semibold text-primary mb-4"
              >
                Project Settings
              </h3>
              <div class="space-y-4">
                <div>
                  <label
                    class="block text-sm font-medium text-secondary mb-1"
                  >Project Start Date</label>
                  <input
                    type="date"
                    id="projectStartDate"
                    class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                  >
                </div>
                <div>
                  <label
                    class="flex items-center text-sm font-medium text-secondary mb-1"
                  >
                    Working Days per Week
                    <span
                      class="help-tip"
                      data-tip="Used for timeline calculations. Effort is measured in working days, not calendar days."
                    >?</span>
                  </label>
                  <select
                    id="workingDays"
                    class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                  >
                    <option value="5">5 days (Mon-Fri)</option>
                    <option value="6">6 days (Mon-Sat)</option>
                    <option value="7">7 days (Mon-Sun)</option>
                    <option value="custom">Custom schedule</option>
                  </select>
                </div>
                <div id="customDaysContainer" class="hidden">
                  <label
                    class="block text-sm font-medium text-secondary mb-2"
                  >Select Working Days</label>
                  <div class="flex flex-wrap gap-2">
                    <label class="inline-flex items-center">
                      <input
                        type="checkbox"
                        value="Mon"
                        class="working-day-checkbox rounded border-strong text-primary focus:ring-1"
                      >
                      <span
                        class="ml-1 text-sm text-secondary"
                      >Mon</span>
                    </label>
                    <label class="inline-flex items-center">
                      <input
                        type="checkbox"
                        value="Tue"
                        class="working-day-checkbox rounded border-strong text-primary focus:ring-1"
                      >
                      <span
                        class="ml-1 text-sm text-secondary"
                      >Tue</span>
                    </label>
                    <label class="inline-flex items-center">
                      <input
                        type="checkbox"
                        value="Wed"
                        class="working-day-checkbox rounded border-strong text-primary focus:ring-1"
                      >
                      <span
                        class="ml-1 text-sm text-secondary"
                      >Wed</span>
                    </label>
                    <label class="inline-flex items-center">
                      <input
                        type="checkbox"
                        value="Thu"
                        class="working-day-checkbox rounded border-strong text-primary focus:ring-1"
                      >
                      <span
                        class="ml-1 text-sm text-secondary"
                      >Thu</span>
                    </label>
                    <label class="inline-flex items-center">
                      <input
                        type="checkbox"
                        value="Fri"
                        class="working-day-checkbox rounded border-strong text-primary focus:ring-1"
                      >
                      <span
                        class="ml-1 text-sm text-secondary"
                      >Fri</span>
                    </label>
                    <label class="inline-flex items-center">
                      <input
                        type="checkbox"
                        value="Sat"
                        class="working-day-checkbox rounded border-strong text-primary focus:ring-1"
                      >
                      <span
                        class="ml-1 text-sm text-secondary"
                      >Sat</span>
                    </label>
                    <label class="inline-flex items-center">
                      <input
                        type="checkbox"
                        value="Sun"
                        class="working-day-checkbox rounded border-strong text-primary focus:ring-1"
                      >
                      <span
                        class="ml-1 text-sm text-secondary"
                      >Sun</span>
                    </label>
                  </div>
                </div>
              </div>
            </div>

            <!-- Project Stats -->
            <div>
              <h3
                class="text-lg font-semibold text-primary mb-4"
              >
                Project Overview
              </h3>
              <div class="bg-secondary rounded-lg p-4 space-y-3">
                <div class="flex justify-between">
                  <span class="text-sm text-secondary"
                  >Total Tasks</span>
                  <span
                    id="configTotalTasks"
                    class="font-medium text-primary"
                  >0</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-sm text-secondary"
                  >Sections</span>
                  <span
                    id="configTotalSections"
                    class="font-medium text-primary"
                  >0</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-sm text-secondary"
                  >Assignees</span>
                  <span
                    id="configTotalAssignees"
                    class="font-medium text-primary"
                  >0</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-sm text-secondary"
                  >Tags</span>
                  <span
                    id="configTotalTags"
                    class="font-medium text-primary"
                  >0</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Configuration Management -->
          <div
            class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 lg:gap-8"
          >
            <!-- Sections Management -->
            <div>
              <h3
                class="text-lg font-semibold text-primary mb-4"
              >
                Board Sections
              </h3>
              <p class="text-sm text-muted mb-4">
                Sections are read from your markdown board structure. Add new
                sections below to automatically create them in your markdown.
              </p>
              <div id="sectionsContainer" class="space-y-2 mb-4">
                <!-- Sections will be populated here -->
              </div>
              <div class="flex gap-2">
                <input
                  type="text"
                  id="newSectionInput"
                  placeholder="New section name"
                  class="flex-1 border border-strong rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                >
                <button
                  type="button"
                  id="addSectionBtn"
                  class="px-3 py-2 text-sm bg-success text-white rounded-md hover:bg-success transition-colors"
                >
                  Add
                </button>
              </div>
            </div>

            <!-- Team Members (managed via People view) -->
            <div>
              <h3
                class="text-lg font-semibold text-primary mb-2"
              >
                Team Members
              </h3>
              <p class="text-sm text-muted">
                Team members are managed in the People view. The count shown above reflects the people directory.
              </p>
            </div>

            <!-- Tags Management -->
            <div>
              <h3
                class="text-lg font-semibold text-primary mb-4"
              >
                Project Tags
              </h3>
              <div id="tagsContainer" class="flex flex-wrap gap-2 mb-4">
                <!-- Tags will be populated here -->
              </div>
              <div class="flex gap-2">
                <input
                  type="text"
                  id="newTagInput"
                  placeholder="New tag name"
                  class="flex-1 border border-strong rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                >
                <button
                  type="button"
                  id="addTagBtn"
                  class="px-3 py-2 text-sm bg-success text-white rounded-md hover:bg-success transition-colors"
                >
                  Add
                </button>
              </div>
            </div>
          </div>

          <!-- Feature Visibility -->
          <div class="mt-8 pt-8 border-t border-default">
            <h3
              class="text-lg font-semibold text-primary mb-4"
            >
              Feature Visibility
            </h3>
            <p class="text-sm text-muted mb-4">
              Select which features appear in the navigation menu. Unchecked
              features are hidden but their data is preserved.
            </p>
            <div id="featuresContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
              <!-- Feature checkboxes rendered by config.js -->
            </div>
          </div>

          <!-- Accessibility Settings -->
          <div class="mt-8 pt-8 border-t border-default">
            <h3
              class="text-lg font-semibold text-primary mb-4"
            >
              Accessibility
            </h3>
            <p class="text-sm text-muted mb-4">
              Customize the interface for reduced cognitive load and better
              focus.
            </p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <!-- Reduced Motion -->
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Reduced Motion</label>
                <select
                  id="accessibilityReducedMotion"
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                >
                  <option value="system">System Default</option>
                  <option value="on">Always On</option>
                  <option value="off">Always Off</option>
                </select>
                <p class="text-xs text-muted mt-1">
                  Disable animations and transitions
                </p>
              </div>

              <!-- High Contrast -->
              <div>
                <label class="flex items-center space-x-3 cursor-pointer">
                  <input
                    type="checkbox"
                    id="accessibilityHighContrast"
                    class="rounded border-strong text-primary focus:ring-1 w-5 h-5"
                  >
                  <div>
                    <span
                      class="block text-sm font-medium text-secondary"
                    >High Contrast</span>
                    <span class="block text-xs text-muted"
                    >Stronger borders and text contrast</span>
                  </div>
                </label>
              </div>

              <!-- Large Touch Targets -->
              <div>
                <label class="flex items-center space-x-3 cursor-pointer">
                  <input
                    type="checkbox"
                    id="accessibilityLargeTargets"
                    class="rounded border-strong text-primary focus:ring-1 w-5 h-5"
                  >
                  <div>
                    <span
                      class="block text-sm font-medium text-secondary"
                    >Large Touch Targets</span>
                    <span class="block text-xs text-muted"
                    >44px minimum for buttons and links</span>
                  </div>
                </label>
              </div>

              <!-- Show Breadcrumbs -->
              <div>
                <label class="flex items-center space-x-3 cursor-pointer">
                  <input
                    type="checkbox"
                    id="accessibilityShowBreadcrumbs"
                    class="rounded border-strong text-primary focus:ring-1 w-5 h-5"
                    checked
                  >
                  <div>
                    <span
                      class="block text-sm font-medium text-secondary"
                    >Show Breadcrumbs</span>
                    <span class="block text-xs text-muted"
                    >Navigation path indicator</span>
                  </div>
                </label>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Notes View -->
      <div id="notesView" class="hidden pb-16">
        <div class="bg-primary rounded-lg shadow">
          <div
            class="px-6 py-4 border-b border-default flex justify-between items-center view-header"
          >
            <h2 class="text-lg font-medium text-primary">
              Notes
            </h2>
            <div class="flex space-x-2">
              <button
                id="openMarkdownBtn"
                class="bg-inverse text-inverse px-4 py-2 rounded-lg hover:bg-active transition-colors"
              >
                Open MD
              </button>
              <button id="addNoteBtn" class="btn-primary py-2 rounded-lg">
                + Add Note
              </button>
            </div>
          </div>

          <!-- Notes Tab Navigation -->
          <div class="border-b border-default">
            <div class="flex items-center px-4">
              <nav
                class="-mb-px flex items-center gap-1 overflow-x-auto scrollbar-hide flex-1 py-2"
                id="notesTabNav"
              >
                <!-- Note tabs will be generated dynamically -->
              </nav>
              <button
                id="addNoteTabBtn"
                class="ml-2 p-1.5 rounded-md text-muted hover:text-secondary hover:bg-tertiary transition-colors flex-shrink-0"
                title="Add Note"
              >
                <svg
                  class="w-5 h-5"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 4v16m8-8H4"
                  />
                </svg>
              </button>
            </div>
          </div>

          <!-- Notes Content -->
          <div class="p-6">
            <div id="notesContent" class="min-h-96">
              <div id="emptyNotesState" class="text-center py-12">
                <svg
                  class="mx-auto h-12 w-12 text-muted"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                  />
                </svg>
                <h3
                  class="mt-2 text-sm font-medium text-primary"
                >
                  No notes
                </h3>
                <p class="mt-1 text-sm text-muted">
                  Get started by creating a new note.
                </p>
              </div>
              <div id="activeNoteContent" class="hidden">
                <div class="flex justify-between items-start mb-4 note-title-row">
                  <input
                    id="activeNoteTitle"
                    class="text-xl font-semibold text-primary bg-transparent border-none outline-none flex-1"
                    placeholder="Note title..."
                    readonly
                  >
                  <div class="flex items-center space-x-2 ml-4">
                    <!-- Save Status -->
                    <div
                      id="noteSaveStatus"
                      class="flex items-center text-xs text-muted"
                    >
                      <span id="noteSaveText" class="hidden">Saved</span>
                    </div>
                    <div class="w-px h-4 bg-active"></div>
                    <!-- Mode Toggle -->
                    <div
                      class="flex items-center border border-strong rounded-md overflow-hidden"
                    >
                      <button
                        id="toggleModeBtn"
                        class="px-3 py-1.5 text-xs font-medium transition-colors"
                        title="Toggle Enhanced Mode"
                      >
                        <span id="toggleModeText">Basic</span>
                      </button>
                    </div>
                    <!-- Edit Toggle -->
                    <button
                      id="toggleEditBtn"
                      class="p-1.5 rounded hover:bg-tertiary text-secondary hover:text-primary transition-colors"
                      title="Toggle Edit Mode"
                    >
                      <svg
                        class="w-5 h-5"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"
                        />
                      </svg>
                    </button>
                    <!-- Edit in Panel -->
                    <button
                      id="editInPanelBtn"
                      class="p-1.5 rounded hover:bg-tertiary text-secondary hover:text-primary transition-colors"
                      title="Edit in Panel"
                    >
                      <svg
                        class="w-5 h-5"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"
                        />
                      </svg>
                    </button>
                    <!-- Delete -->
                    <button
                      id="deleteNoteBtn"
                      class="p-1.5 rounded hover:bg-error-bg/20 text-error hover:text-error-text transition-colors"
                      title="Delete Note"
                    >
                      <svg
                        class="w-5 h-5"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
                        />
                      </svg>
                    </button>
                  </div>
                </div>

                <!-- Note metadata -->
                <div
                  id="noteMetadata"
                  class="text-xs text-muted mb-4 flex flex-wrap gap-4"
                >
                  <span id="noteCreatedAt"></span>
                  <span id="noteUpdatedAt"></span>
                  <span id="noteRevision"></span>
                </div>

                <!-- Enhanced View Mode (rendered content) -->
                <div id="enhancedNoteView" class="hidden">
                  <!-- Beautifully rendered enhanced note content -->
                </div>

                <!-- Enhanced Editor Mode -->
                <div id="enhancedNoteEditor" class="hidden">
                  <div
                    class="flex justify-between items-center mb-4 p-3 bg-secondary rounded-lg note-enhanced-toolbar"
                  >
                    <div class="flex space-x-2">
                      <button
                        id="addParagraphBtn"
                        class="btn-primary px-3 py-1"
                      >
                        + Paragraph
                      </button>
                      <button
                        id="addCodeBlockBtn"
                        class="bg-inverse text-inverse px-3 py-1 rounded text-sm hover:bg-active"
                      >
                        + Code
                      </button>
                      <button
                        id="addCustomSectionBtn"
                        class="bg-info text-white px-3 py-1 rounded text-sm hover:bg-info"
                      >
                        + Custom
                      </button>
                      <button
                        id="enableMultiSelectBtn"
                        class="bg-warning text-white px-3 py-1 rounded text-sm hover:bg-warning"
                      >
                        Multi-Select
                      </button>
                    </div>
                    <div class="text-sm text-secondary">
                      Enhanced Mode
                    </div>
                  </div>

                  <!-- Drag and Drop Zone -->
                  <div
                    id="fileDropZone"
                    class="border-2 border-dashed border-strong rounded-lg p-6 text-center mb-4 hidden"
                  >
                    <p class="text-muted">
                      Drop files here to add them to your note
                    </p>
                  </div>

                  <!-- Paragraphs Container -->
                  <div id="paragraphsContainer" class="space-y-4">
                    <!-- Paragraphs will be rendered here -->
                  </div>

                  <!-- Custom Sections Container -->
                  <div id="customSectionsContainer" class="mt-6 space-y-6">
                    <!-- Custom sections will be rendered here -->
                  </div>
                </div>

                <!-- Simple Editor Mode (existing) -->
                <div id="activeNoteBodyContainer" class="relative">
                  <div id="activeNoteBody" class="max-w-none">
                    <!-- Note content will be rendered here -->
                  </div>
                  <textarea
                    id="activeNoteEditor"
                    class="w-full min-h-96 p-4 border border-strong rounded-md focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent hidden resize-none"
                    placeholder="Write your note content here... (Markdown supported)"
                  ></textarea>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Goals View -->
      <div id="goalsView" class="hidden pb-16">
        <div class="bg-primary rounded-lg shadow">
          <div
            class="px-6 py-4 border-b border-default flex justify-between items-center view-header"
          >
            <h2 class="text-lg font-medium text-primary">
              Goals
            </h2>
            <button id="addGoalBtn" class="btn-primary py-2 rounded-lg">
              + Add Goal
            </button>
          </div>

          <!-- Goals Filter -->
          <div class="px-6 py-4 border-b border-default">
            <div class="flex space-x-4">
              <button
                id="allGoalsFilter"
                class="px-3 py-1 rounded-md text-sm font-medium bg-inverse text-inverse"
              >
                All Goals
              </button>
              <button
                id="enterpriseGoalsFilter"
                class="px-3 py-1 rounded-md text-sm font-medium text-secondary hover:text-primary"
              >
                Enterprise
              </button>
              <button
                id="projectGoalsFilter"
                class="px-3 py-1 rounded-md text-sm font-medium text-secondary hover:text-primary"
              >
                Project
              </button>
            </div>
          </div>

          <!-- Goals Content -->
          <div class="p-6">
            <div id="emptyGoalsState" class="text-center py-12">
              <svg
                class="mx-auto h-12 w-12 text-muted"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"
                />
              </svg>
              <h3
                class="mt-2 text-sm font-medium text-primary"
              >
                No goals
              </h3>
              <p class="mt-1 text-sm text-muted">
                Get started by creating a new goal.
              </p>
            </div>
            <div id="goalsContainer" class="space-y-4"></div>
          </div>
        </div>
      </div>

      <!-- Milestones View -->
      <div id="milestonesView" class="hidden pb-16">
        <div class="bg-primary rounded-lg shadow">
          <div
            class="px-6 py-4 border-b border-default flex justify-between items-center view-header"
          >
            <h2 class="text-lg font-medium text-primary">
              Milestones
            </h2>
            <button id="addMilestoneBtn" class="btn-primary py-2 rounded-lg">
              + Add Milestone
            </button>
          </div>
          <div class="p-6">
            <div id="emptyMilestonesState" class="text-center py-12 hidden">
              <svg
                class="mx-auto h-12 w-12 text-muted"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"
                />
              </svg>
              <h3
                class="mt-2 text-sm font-medium text-primary"
              >
                No milestones
              </h3>
              <p class="mt-1 text-sm text-muted">
                Get started by creating a new milestone.
              </p>
            </div>
            <div
              id="milestonesContainer"
              class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"
            >
            </div>
          </div>
        </div>
      </div>

      <!-- Ideas View -->
      <div id="ideasView" class="hidden pb-16">
        <div class="bg-primary rounded-lg shadow">
          <div
            class="px-6 py-4 border-b border-default flex justify-between items-center view-header"
          >
            <h2 class="text-lg font-medium text-primary">
              Ideas
            </h2>
            <button id="addIdeaBtn" class="btn-primary py-2 rounded-lg">
              + Add Idea
            </button>
          </div>
          <div class="p-6">
            <div id="emptyIdeasState" class="text-center py-12 hidden">
              <svg
                class="mx-auto h-12 w-12 text-muted"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"
                />
              </svg>
              <h3
                class="mt-2 text-sm font-medium text-primary"
              >
                No ideas yet
              </h3>
              <p class="mt-1 text-sm text-muted">
                Start collecting your ideas.
              </p>
            </div>
            <div
              id="ideasContainer"
              class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"
            >
            </div>
          </div>
        </div>
      </div>

      <!-- Retrospectives View -->
      <div id="retrospectivesView" class="hidden pb-16">
        <div class="bg-primary rounded-lg shadow">
          <div
            class="px-6 py-4 border-b border-default flex justify-between items-center view-header"
          >
            <h2 class="text-lg font-medium text-primary">
              Retrospectives
            </h2>
            <button
              id="addRetrospectiveBtn"
              class="btn-primary py-2 rounded-lg"
            >
              + Add Retrospective
            </button>
          </div>
          <div class="p-6">
            <div id="emptyRetrospectivesState" class="text-center py-12 hidden">
              <svg
                class="mx-auto h-12 w-12 text-muted"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"
                />
              </svg>
              <h3
                class="mt-2 text-sm font-medium text-primary"
              >
                No retrospectives yet
              </h3>
              <p class="mt-1 text-sm text-muted">
                Start reflecting on your sprints.
              </p>
            </div>
            <div
              id="retrospectivesContainer"
              class="grid grid-cols-1 lg:grid-cols-2 gap-6"
            >
            </div>
          </div>
        </div>
      </div>

      <!-- MoSCoW Analysis View -->
      <div id="moscowView" class="hidden pb-16">
        <div class="bg-primary rounded-lg shadow">
          <div
            class="px-6 py-4 border-b border-default flex justify-between items-center view-header"
          >
            <div class="flex items-center gap-4">
              <h2 class="text-lg font-medium text-primary">
                MoSCoW Prioritization
              </h2>
              <select
                id="moscowSelector"
                class="text-sm border border-strong rounded-md px-3 py-1.5 focus:outline-none focus:ring-2 focus:ring-1"
              >
                <option value="">Select Analysis</option>
              </select>
            </div>
            <div class="flex items-center gap-2">
              <button
                id="editMoscowBtn"
                class="btn-secondary py-1.5 rounded hidden"
              >
                Edit
              </button>
              <button
                id="deleteMoscowBtn"
                class="btn-danger py-1.5 rounded hidden"
              >
                Delete
              </button>
              <button id="addMoscowBtn" class="btn-primary py-2 rounded-lg">
                + New Analysis
              </button>
            </div>
          </div>
          <div class="p-6">
            <div id="emptyMoscowState" class="text-center py-12">
              <svg
                class="mx-auto h-12 w-12 text-muted"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"
                />
              </svg>
              <h3 class="mt-2 text-sm font-medium text-primary">
                No MoSCoW analyses yet
              </h3>
              <p class="mt-1 text-sm text-muted">
                Create a MoSCoW analysis to prioritize items as Must, Should,
                Could, or Won't have.
              </p>
            </div>
            <div id="moscowGrid" class="hidden moscow-grid">
              <!-- Must Have -->
              <div class="moscow-column moscow-must">
                <div class="flex justify-between items-center mb-3">
                  <h3 class="font-medium text-primary">Must Have</h3>
                  <button
                    data-category="must"
                    class="moscow-add-btn text-secondary hover:text-primary text-sm"
                  >
                    + Add
                  </button>
                </div>
                <ul
                  id="moscowMust"
                  class="space-y-2 text-sm text-primary"
                ></ul>
              </div>
              <!-- Should Have -->
              <div class="moscow-column moscow-should">
                <div class="flex justify-between items-center mb-3">
                  <h3 class="font-medium text-primary">Should Have</h3>
                  <button
                    data-category="should"
                    class="moscow-add-btn text-secondary hover:text-primary text-sm"
                  >
                    + Add
                  </button>
                </div>
                <ul
                  id="moscowShould"
                  class="space-y-2 text-sm text-primary"
                ></ul>
              </div>
              <!-- Could Have -->
              <div class="moscow-column moscow-could">
                <div class="flex justify-between items-center mb-3">
                  <h3 class="font-medium text-primary">Could Have</h3>
                  <button
                    data-category="could"
                    class="moscow-add-btn text-secondary hover:text-primary text-sm"
                  >
                    + Add
                  </button>
                </div>
                <ul
                  id="moscowCould"
                  class="space-y-2 text-sm text-primary"
                ></ul>
              </div>
              <!-- Won't Have -->
              <div class="moscow-column moscow-wont">
                <div class="flex justify-between items-center mb-3">
                  <h3 class="font-medium text-primary">Won't Have</h3>
                  <button
                    data-category="wont"
                    class="moscow-add-btn text-secondary hover:text-primary text-sm"
                  >
                    + Add
                  </button>
                </div>
                <ul
                  id="moscowWont"
                  class="space-y-2 text-sm text-primary"
                ></ul>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Eisenhower Matrix View -->
      <div id="eisenhowerView" class="hidden pb-16">
        <div class="bg-primary rounded-lg shadow">
          <div
            class="px-6 py-4 border-b border-default flex justify-between items-center view-header"
          >
            <div class="flex items-center gap-4">
              <h2 class="text-lg font-medium text-primary">
                Eisenhower Matrix
              </h2>
              <select
                id="eisenhowerSelector"
                class="text-sm border border-strong rounded-md px-3 py-1.5 focus:outline-none focus:ring-2 focus:ring-1"
              >
                <option value="">Select Matrix</option>
              </select>
            </div>
            <div class="flex items-center gap-2">
              <button
                id="editEisenhowerBtn"
                class="btn-secondary py-1.5 rounded hidden"
              >
                Edit
              </button>
              <button
                id="deleteEisenhowerBtn"
                class="btn-danger py-1.5 rounded hidden"
              >
                Delete
              </button>
              <button id="addEisenhowerBtn" class="btn-primary py-2 rounded-lg">
                + New Matrix
              </button>
            </div>
          </div>
          <div class="p-6">
            <div id="emptyEisenhowerState" class="text-center py-12">
              <svg
                class="mx-auto h-12 w-12 text-muted"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"
                />
              </svg>
              <h3 class="mt-2 text-sm font-medium text-primary">
                No Eisenhower matrices yet
              </h3>
              <p class="mt-1 text-sm text-muted">
                Create a matrix to prioritize tasks by urgency and importance.
              </p>
            </div>
            <div id="eisenhowerGrid" class="hidden eisenhower-grid">
              <!-- Axis labels -->
              <div class="eisenhower-axis-top">
                <span class="eisenhower-axis-label">Urgent</span>
                <span class="eisenhower-axis-label">Not Urgent</span>
              </div>
              <div class="eisenhower-body">
                <div class="eisenhower-axis-left">
                  <span class="eisenhower-axis-label">Important</span>
                  <span class="eisenhower-axis-label">Not Important</span>
                </div>
                <div class="eisenhower-quadrants">
                  <!-- Q1: Urgent + Important -->
                  <div class="eisenhower-quadrant eisenhower-q1">
                    <div class="flex justify-between items-center mb-3">
                      <h3 class="font-medium text-primary">Do First</h3>
                      <button
                        data-quadrant="urgentImportant"
                        class="eisenhower-add-btn text-secondary hover:text-primary text-sm"
                      >
                        + Add
                      </button>
                    </div>
                    <ul
                      id="eisenhowerUrgentImportant"
                      class="space-y-2 text-sm text-primary"
                    ></ul>
                  </div>
                  <!-- Q2: Not Urgent + Important -->
                  <div class="eisenhower-quadrant eisenhower-q2">
                    <div class="flex justify-between items-center mb-3">
                      <h3 class="font-medium text-primary">Schedule</h3>
                      <button
                        data-quadrant="notUrgentImportant"
                        class="eisenhower-add-btn text-secondary hover:text-primary text-sm"
                      >
                        + Add
                      </button>
                    </div>
                    <ul
                      id="eisenhowerNotUrgentImportant"
                      class="space-y-2 text-sm text-primary"
                    ></ul>
                  </div>
                  <!-- Q3: Urgent + Not Important -->
                  <div class="eisenhower-quadrant eisenhower-q3">
                    <div class="flex justify-between items-center mb-3">
                      <h3 class="font-medium text-primary">Delegate</h3>
                      <button
                        data-quadrant="urgentNotImportant"
                        class="eisenhower-add-btn text-secondary hover:text-primary text-sm"
                      >
                        + Add
                      </button>
                    </div>
                    <ul
                      id="eisenhowerUrgentNotImportant"
                      class="space-y-2 text-sm text-primary"
                    ></ul>
                  </div>
                  <!-- Q4: Not Urgent + Not Important -->
                  <div class="eisenhower-quadrant eisenhower-q4">
                    <div class="flex justify-between items-center mb-3">
                      <h3 class="font-medium text-primary">Eliminate</h3>
                      <button
                        data-quadrant="notUrgentNotImportant"
                        class="eisenhower-add-btn text-secondary hover:text-primary text-sm"
                      >
                        + Add
                      </button>
                    </div>
                    <ul
                      id="eisenhowerNotUrgentNotImportant"
                      class="space-y-2 text-sm text-primary"
                    ></ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Idea Sorter View -->
      <div id="ideaSorterView" class="hidden pb-16">
        <div class="bg-primary rounded-lg shadow">
          <div class="px-6 py-4 border-b border-default flex justify-between items-center view-header">
            <h2 class="text-lg font-medium text-primary">Idea Sorter</h2>
            <button id="addIdeaSorterBtn" class="btn-primary py-2 rounded-lg">+ New Idea</button>
          </div>
          <div class="idea-sorter-filters">
            <input
              type="text"
              id="ideaSorterFilterCategory"
              placeholder="Filter by category"
            >
            <select id="ideaSorterFilterPriority">
              <option value="">All priorities</option>
              <option value="high">High</option>
              <option value="medium">Medium</option>
              <option value="low">Low</option>
            </select>
            <select id="ideaSorterFilterStatus">
              <option value="">All statuses</option>
              <option value="new">New</option>
              <option value="considering">Considering</option>
              <option value="planned">Planned</option>
              <option value="approved">Approved</option>
              <option value="rejected">Rejected</option>
            </select>
            <button id="ideaSorterClearFilters" class="btn-secondary">Clear</button>
          </div>
          <div id="emptyIdeaSorterState" class="text-center py-12">
            <svg class="mx-auto h-12 w-12 text-muted" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
            </svg>
            <h3 class="mt-2 text-sm font-medium text-primary">No ideas yet</h3>
            <p class="mt-1 text-sm text-muted">Create an idea to get started.</p>
          </div>
          <div class="idea-sorter-wrap">
            <table id="ideaSorterTable" class="idea-sorter-table hidden">
              <thead>
                <tr>
                  <th class="idea-sorter-th" data-sort="title">Title</th>
                  <th class="idea-sorter-th" data-sort="category">Category</th>
                  <th class="idea-sorter-th" data-sort="priority">Priority</th>
                  <th class="idea-sorter-th" data-sort="status">Status</th>
                  <th class="idea-sorter-th" data-sort="startDate">Start</th>
                  <th class="idea-sorter-th" data-sort="endDate">End</th>
                  <th class="idea-sorter-th">Resources</th>
                  <th class="idea-sorter-th">Subtasks</th>
                  <th class="idea-sorter-th"></th>
                </tr>
              </thead>
              <tbody id="ideaSorterBody"></tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Fundraising View -->
      <div id="fundraisingView" class="hidden pb-16">
        <div class="bg-primary rounded-lg shadow fundraising-wrapper">

          <!-- Glossary popover -->
          <div id="fundraising-glossary" class="fundraising-glossary hidden">
            <p class="fundraising-glossary-title">Acronym Glossary</p>
            <div class="fundraising-glossary-list">
              <span class="fundraising-glossary-term">SAFE</span>
              <span class="fundraising-glossary-def">Simple Agreement for Future Equity</span>
              <span class="fundraising-glossary-term">MFN</span>
              <span class="fundraising-glossary-def">Most Favored Nation (SAFE variant)</span>
              <span class="fundraising-glossary-term">MRR</span>
              <span class="fundraising-glossary-def">Monthly Recurring Revenue</span>
              <span class="fundraising-glossary-term">ARR</span>
              <span class="fundraising-glossary-def">Annual Recurring Revenue (MRR × 12)</span>
              <span class="fundraising-glossary-term">LTV</span>
              <span class="fundraising-glossary-def">Lifetime Value of a customer</span>
              <span class="fundraising-glossary-term">CAC</span>
              <span class="fundraising-glossary-def">Customer Acquisition Cost</span>
              <span class="fundraising-glossary-term">LTV/CAC</span>
              <span class="fundraising-glossary-def">Unit economics ratio (target &gt; 3x)</span>
              <span class="fundraising-glossary-term">MoM</span>
              <span class="fundraising-glossary-def">Month over Month growth rate</span>
              <span class="fundraising-glossary-term">KPI</span>
              <span class="fundraising-glossary-def">Key Performance Indicator</span>
            </div>
          </div>

          <!-- SAFE Rounds tab -->
          <div id="fundraising-panel-safe" class="fundraising-tab-panel">
            <div class="px-6 py-4 border-b border-default flex justify-between items-center view-header">
              <h2 class="text-lg font-medium text-primary">Fundraising</h2>
              <div class="flex items-center gap-2">
                <button class="fundraising-info-btn" data-action="fundraising-info" aria-label="Glossary">?</button>
                <button id="safe-add-btn" class="btn-primary py-2 rounded-lg">+ Add SAFE</button>
              </div>
            </div>
            <nav class="view-tabs">
              <button class="view-tab active" data-tab="safe">SAFE Rounds</button>
              <button class="view-tab" data-tab="pipeline">Pipeline</button>
              <button class="view-tab" data-tab="kpi">KPI Tracker</button>
              <button class="view-tab" data-tab="runway">Runway</button>
              <button class="view-tab" data-tab="targets">Targets</button>
            </nav>
            <div class="p-6">
              <div id="safe-summary-card" class="safe-summary-card"></div>
              <div class="fundraising-table-wrap">
                <table class="safe-table">
                  <thead>
                    <tr>
                      <th>Investor</th>
                      <th>Amount</th>
                      <th>Valuation Cap</th>
                      <th>Discount</th>
                      <th>Type</th>
                      <th>Status</th>
                      <th>Date</th>
                    </tr>
                  </thead>
                  <tbody id="safe-table-body"></tbody>
                </table>
              </div>
              <h3 class="text-sm font-medium text-primary mt-8 mb-3">Cap Table</h3>
              <div id="safe-cap-table"></div>
            </div>
          </div>

          <!-- Pipeline tab -->
          <div id="fundraising-panel-pipeline" class="fundraising-tab-panel hidden">
            <div class="px-6 py-4 border-b border-default flex justify-between items-center view-header">
              <h2 class="text-lg font-medium text-primary">Fundraising</h2>
              <div class="flex items-center gap-2">
                <button class="fundraising-info-btn" data-action="fundraising-info" aria-label="Glossary">?</button>
                <button id="pipeline-add-btn" class="btn-primary py-2 rounded-lg">+ Add Investor</button>
              </div>
            </div>
            <nav class="view-tabs">
              <button class="view-tab" data-tab="safe">SAFE Rounds</button>
              <button class="view-tab active" data-tab="pipeline">Pipeline</button>
              <button class="view-tab" data-tab="kpi">KPI Tracker</button>
              <button class="view-tab" data-tab="runway">Runway</button>
              <button class="view-tab" data-tab="targets">Targets</button>
            </nav>
            <div class="p-6">
              <div class="pipeline-filters">
                <button class="pipeline-filter-btn active" data-status="all">All</button>
                <button class="pipeline-filter-btn" data-status="not_started">Not Started</button>
                <button class="pipeline-filter-btn" data-status="in_progress">In Progress</button>
                <button class="pipeline-filter-btn" data-status="term_sheet">Term Sheet</button>
                <button class="pipeline-filter-btn" data-status="invested">Invested</button>
                <button class="pipeline-filter-btn" data-status="passed">Passed</button>
              </div>
              <p id="pipeline-summary" class="pipeline-summary"></p>
              <div class="fundraising-table-wrap">
                <table class="pipeline-table">
                  <thead>
                    <tr>
                      <th>Name</th>
                      <th>Type</th>
                      <th>Target</th>
                      <th>Status</th>
                      <th>Last Contact</th>
                      <th>Contact</th>
                    </tr>
                  </thead>
                  <tbody id="pipeline-table-body"></tbody>
                </table>
              </div>
            </div>
          </div>

          <!-- KPI Tracker tab -->
          <div id="fundraising-panel-kpi" class="fundraising-tab-panel hidden">
            <div class="px-6 py-4 border-b border-default flex justify-between items-center view-header">
              <h2 class="text-lg font-medium text-primary">Fundraising</h2>
              <div class="flex items-center gap-2">
                <button class="fundraising-info-btn" data-action="fundraising-info" aria-label="Glossary">?</button>
                <button id="kpi-edit-btn" class="btn-secondary py-1.5 rounded hidden">Edit</button>
                <button id="kpi-delete-btn" class="btn-danger py-1.5 rounded hidden">Delete</button>
                <button id="kpi-add-btn" class="btn-primary py-2 rounded-lg">+ Add Period</button>
              </div>
            </div>
            <nav class="view-tabs">
              <button class="view-tab" data-tab="safe">SAFE Rounds</button>
              <button class="view-tab" data-tab="pipeline">Pipeline</button>
              <button class="view-tab active" data-tab="kpi">KPI Tracker</button>
              <button class="view-tab" data-tab="runway">Runway</button>
              <button class="view-tab" data-tab="targets">Targets</button>
            </nav>
            <div class="p-6">
              <div class="kpi-controls">
                <select id="kpi-selector" class="kpi-selector">
                  <option value="">Select period</option>
                </select>
              </div>
              <p id="kpi-empty" class="text-center py-12 text-sm text-muted hidden">No KPI periods yet. Add one to track metrics over time.</p>
              <div id="kpi-grid" class="kpi-grid hidden"></div>
              <div class="kpi-notes-row hidden mt-2">
                <span class="text-xs text-muted">Notes: </span>
                <span id="kpi-notes" class="text-sm text-secondary"></span>
              </div>
            </div>
          </div>

          <!-- Runway tab -->
          <div id="fundraising-panel-runway" class="fundraising-tab-panel hidden">
            <div class="px-6 py-4 border-b border-default flex justify-between items-center view-header">
              <h2 class="text-lg font-medium text-primary">Fundraising</h2>
              <button class="fundraising-info-btn" data-action="fundraising-info" aria-label="Glossary">?</button>
            </div>
            <nav class="view-tabs">
              <button class="view-tab" data-tab="safe">SAFE Rounds</button>
              <button class="view-tab" data-tab="pipeline">Pipeline</button>
              <button class="view-tab" data-tab="kpi">KPI Tracker</button>
              <button class="view-tab active" data-tab="runway">Runway</button>
              <button class="view-tab" data-tab="targets">Targets</button>
            </nav>
            <div class="p-6">
              <div class="runway-calculator">
                <div class="runway-inputs">
                  <div class="runway-field">
                    <label for="runway-cash">Cash on Hand ($)</label>
                    <input type="number" id="runway-cash" placeholder="e.g. 500000" min="0">
                  </div>
                  <div class="runway-field">
                    <label for="runway-debt">Existing Debt ($)</label>
                    <input type="number" id="runway-debt" placeholder="e.g. 0" min="0">
                  </div>
                  <div class="runway-field">
                    <label for="runway-burn">Monthly Burn ($)</label>
                    <input type="number" id="runway-burn" placeholder="e.g. 50000" min="0">
                  </div>
                </div>
                <p id="runway-effective-cash" class="runway-effective-cash"></p>
                <div class="runway-result-block">
                  <p class="runway-result-label">Runway</p>
                  <p id="runway-result" class="runway-result">—</p>
                  <p id="runway-date" class="runway-date"></p>
                </div>
                <p class="runway-migration-note">Inputs are saved locally. When the Finances view is available, monthly burn will be derived from your expense entries automatically.</p>
              </div>
            </div>
          </div>

          <!-- Targets tab -->
          <div id="fundraising-panel-targets" class="fundraising-tab-panel hidden">
            <div class="px-6 py-4 border-b border-default flex justify-between items-center view-header">
              <h2 class="text-lg font-medium text-primary">Fundraising</h2>
              <button class="fundraising-info-btn" data-action="fundraising-info" aria-label="Glossary">?</button>
            </div>
            <nav class="view-tabs">
              <button class="view-tab" data-tab="safe">SAFE Rounds</button>
              <button class="view-tab" data-tab="pipeline">Pipeline</button>
              <button class="view-tab" data-tab="kpi">KPI Tracker</button>
              <button class="view-tab" data-tab="runway">Runway</button>
              <button class="view-tab active" data-tab="targets">Targets</button>
            </nav>
            <div class="p-6">
              <p class="text-sm text-muted mb-4">Set targets for key metrics. Current values pull from the latest KPI period. Click a target cell to edit.</p>
              <div class="fundraising-table-wrap">
                <table class="targets-table" id="targets-table">
                  <thead>
                    <tr>
                      <th>Metric</th>
                      <th>Current</th>
                      <th>Target</th>
                      <th>Gap</th>
                    </tr>
                  </thead>
                  <tbody id="targets-table-body"></tbody>
                </table>
              </div>
            </div>
          </div>

        </div>
      </div>

      <!-- SWOT Analysis View -->
      <div id="swotView" class="hidden pb-16">
        <div class="bg-primary rounded-lg shadow">
          <div
            class="px-6 py-4 border-b border-default flex justify-between items-center view-header"
          >
            <div class="flex items-center gap-4">
              <h2 class="text-lg font-medium text-primary">
                SWOT Analysis
              </h2>
              <select
                id="swotSelector"
                class="text-sm border border-strong rounded-md px-3 py-1.5 focus:outline-none focus:ring-2 focus:ring-1"
              >
                <option value="">Select Analysis</option>
              </select>
            </div>
            <div class="flex items-center gap-2">
              <button
                id="editSwotBtn"
                class="btn-secondary py-1.5 rounded hidden"
              >
                Edit
              </button>
              <button
                id="deleteSwotBtn"
                class="btn-danger py-1.5 rounded hidden"
              >
                Delete
              </button>
              <button id="addSwotBtn" class="btn-primary py-2 rounded-lg">
                + New SWOT
              </button>
            </div>
          </div>
          <div class="p-6">
            <div id="emptySwotState" class="text-center py-12">
              <svg
                class="mx-auto h-12 w-12 text-muted"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2"
                />
              </svg>
              <h3
                class="mt-2 text-sm font-medium text-primary"
              >
                No SWOT analyses yet
              </h3>
              <p class="mt-1 text-sm text-muted">
                Create a SWOT analysis to evaluate strengths, weaknesses,
                opportunities, and threats.
              </p>
            </div>
            <div id="swotGrid" class="hidden grid grid-cols-2 gap-4">
              <!-- Strengths -->
              <div
                class="bg-secondary rounded-lg p-4 border border-default"
              >
                <div class="flex justify-between items-center mb-3">
                  <h3 class="font-medium text-primary">
                    Strengths
                  </h3>
                  <button
                    data-quadrant="strengths"
                    class="swot-add-btn text-secondary hover:text-primary text-sm"
                  >
                    + Add
                  </button>
                </div>
                <ul
                  id="swotStrengths"
                  class="space-y-2 text-sm text-primary"
                >
                </ul>
              </div>
              <!-- Weaknesses -->
              <div
                class="bg-secondary rounded-lg p-4 border border-default"
              >
                <div class="flex justify-between items-center mb-3">
                  <h3 class="font-medium text-primary">
                    Weaknesses
                  </h3>
                  <button
                    data-quadrant="weaknesses"
                    class="swot-add-btn text-secondary hover:text-primary text-sm"
                  >
                    + Add
                  </button>
                </div>
                <ul
                  id="swotWeaknesses"
                  class="space-y-2 text-sm text-primary"
                >
                </ul>
              </div>
              <!-- Opportunities -->
              <div
                class="bg-secondary rounded-lg p-4 border border-default"
              >
                <div class="flex justify-between items-center mb-3">
                  <h3 class="font-medium text-primary">
                    Opportunities
                  </h3>
                  <button
                    data-quadrant="opportunities"
                    class="swot-add-btn text-secondary hover:text-primary text-sm"
                  >
                    + Add
                  </button>
                </div>
                <ul
                  id="swotOpportunities"
                  class="space-y-2 text-sm text-primary"
                >
                </ul>
              </div>
              <!-- Threats -->
              <div
                class="bg-secondary rounded-lg p-4 border border-default"
              >
                <div class="flex justify-between items-center mb-3">
                  <h3 class="font-medium text-primary">
                    Threats
                  </h3>
                  <button
                    data-quadrant="threats"
                    class="swot-add-btn text-secondary hover:text-primary text-sm"
                  >
                    + Add
                  </button>
                </div>
                <ul
                  id="swotThreats"
                  class="space-y-2 text-sm text-primary"
                >
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- SWOT Modal -->
      <div
        id="swotModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-md w-full mx-4"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3
              id="swotModalTitle"
              class="text-lg font-medium text-primary"
            >
              New SWOT Analysis
            </h3>
          </div>
          <form id="swotForm">
            <div class="p-6 space-y-4">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Title</label>
                <input
                  type="text"
                  id="swotTitle"
                  required
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                  placeholder="e.g., Product Launch Analysis"
                >
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Date</label>
                <input
                  type="date"
                  id="swotDate"
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                >
              </div>
            </div>
            <div
              class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
            >
              <button
                type="button"
                id="cancelSwotBtn"
                class="btn-secondary py-2 rounded-md"
              >
                Cancel
              </button>
              <button type="submit" class="btn-primary py-2 rounded-md">
                Save
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- SWOT Item Modal -->
      <div
        id="swotItemModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-md w-full mx-4"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3
              id="swotItemModalTitle"
              class="text-lg font-medium text-primary"
            >
              Add Item
            </h3>
          </div>
          <form id="swotItemForm">
            <div class="p-6">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Item</label>
                <input
                  type="text"
                  id="swotItemText"
                  required
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                  placeholder="Enter item..."
                >
              </div>
            </div>
            <div
              class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
            >
              <button
                type="button"
                id="cancelSwotItemBtn"
                class="btn-secondary py-2 rounded-md"
              >
                Cancel
              </button>
              <button type="submit" class="btn-primary py-2 rounded-md">
                Add
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Risk Analysis View -->
      <div id="riskAnalysisView" class="hidden pb-16">
        <div class="bg-primary rounded-lg shadow">
          <div
            class="px-6 py-4 border-b border-default flex justify-between items-center view-header"
          >
            <div class="flex items-center gap-4">
              <h2 class="text-lg font-medium text-primary">
                Risk Analysis
              </h2>
              <select
                id="riskAnalysisSelector"
                class="text-sm border border-strong rounded-md px-3 py-1.5 focus:outline-none focus:ring-2 focus:ring-1"
              >
                <option value="">Select Analysis</option>
              </select>
            </div>
            <div class="flex items-center gap-2">
              <button
                id="editRiskAnalysisBtn"
                class="btn-secondary py-1.5 rounded hidden"
              >
                Edit
              </button>
              <button
                id="deleteRiskAnalysisBtn"
                class="btn-danger py-1.5 rounded hidden"
              >
                Delete
              </button>
              <button
                id="addRiskAnalysisBtn"
                class="btn-primary py-2 rounded-lg"
              >
                + New Risk Analysis
              </button>
            </div>
          </div>
          <div class="p-6">
            <div id="emptyRiskAnalysisState" class="text-center py-12">
              <svg
                class="mx-auto h-12 w-12 text-muted"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"
                />
              </svg>
              <h3
                class="mt-2 text-sm font-medium text-primary"
              >
                No risk analyses yet
              </h3>
              <p class="mt-1 text-sm text-muted">
                Create a risk analysis to evaluate risks by impact and
                probability.
              </p>
            </div>
            <div id="riskAnalysisGrid" class="hidden grid grid-cols-2 gap-4">
              <!-- Axis labels -->
              <div
                class="col-span-2 flex justify-between text-xs text-muted px-2"
              >
                <span>Low Impact</span>
                <span>High Impact</span>
              </div>
              <!-- High Probability Row -->
              <div>
                <div
                  class="bg-secondary rounded-lg p-4 border border-default h-full"
                >
                  <div class="flex justify-between items-center mb-3">
                    <h3
                      class="font-medium text-primary text-sm"
                    >
                      Low Impact / High Probability
                    </h3>
                    <button
                      data-quadrant="lowImpactHighProb"
                      class="risk-add-btn text-secondary hover:text-primary text-sm"
                    >
                      + Add
                    </button>
                  </div>
                  <ul
                    id="riskLowImpactHighProb"
                    class="space-y-2 text-sm text-secondary"
                  >
                  </ul>
                </div>
              </div>
              <div
                class="bg-secondary rounded-lg p-4 border border-default"
              >
                <div class="flex justify-between items-center mb-3">
                  <h3
                    class="font-medium text-primary text-sm"
                  >
                    High Impact / High Probability
                  </h3>
                  <button
                    data-quadrant="highImpactHighProb"
                    class="risk-add-btn text-secondary hover:text-primary text-sm"
                  >
                    + Add
                  </button>
                </div>
                <ul
                  id="riskHighImpactHighProb"
                  class="space-y-2 text-sm text-secondary"
                >
                </ul>
              </div>
              <!-- Low Probability Row -->
              <div>
                <div
                  class="bg-secondary rounded-lg p-4 border border-default h-full"
                >
                  <div class="flex justify-between items-center mb-3">
                    <h3
                      class="font-medium text-primary text-sm"
                    >
                      Low Impact / Low Probability
                    </h3>
                    <button
                      data-quadrant="lowImpactLowProb"
                      class="risk-add-btn text-secondary hover:text-primary text-sm"
                    >
                      + Add
                    </button>
                  </div>
                  <ul
                    id="riskLowImpactLowProb"
                    class="space-y-2 text-sm text-secondary"
                  >
                  </ul>
                </div>
              </div>
              <div
                class="bg-secondary rounded-lg p-4 border border-default"
              >
                <div class="flex justify-between items-center mb-3">
                  <h3
                    class="font-medium text-primary text-sm"
                  >
                    High Impact / Low Probability
                  </h3>
                  <button
                    data-quadrant="highImpactLowProb"
                    class="risk-add-btn text-secondary hover:text-primary text-sm"
                  >
                    + Add
                  </button>
                </div>
                <ul
                  id="riskHighImpactLowProb"
                  class="space-y-2 text-sm text-secondary"
                >
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Risk Analysis Modal -->
      <div
        id="riskAnalysisModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-md w-full mx-4"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3
              id="riskAnalysisModalTitle"
              class="text-lg font-medium text-primary"
            >
              New Risk Analysis
            </h3>
          </div>
          <form id="riskAnalysisForm">
            <div class="p-6 space-y-4">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Title</label>
                <input
                  type="text"
                  id="riskAnalysisTitle"
                  required
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                  placeholder="e.g., Product Launch Risks"
                >
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Date</label>
                <input
                  type="date"
                  id="riskAnalysisDate"
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                >
              </div>
            </div>
            <div
              class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
            >
              <button
                type="button"
                id="cancelRiskAnalysisBtn"
                class="btn-secondary py-2 rounded-md"
              >
                Cancel
              </button>
              <button type="submit" class="btn-primary py-2 rounded-md">
                Save
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Risk Analysis Item Modal -->
      <div
        id="riskAnalysisItemModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-md w-full mx-4"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3
              id="riskAnalysisItemModalTitle"
              class="text-lg font-medium text-primary"
            >
              Add Risk
            </h3>
          </div>
          <form id="riskAnalysisItemForm">
            <div class="p-6">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Risk Description</label>
                <input
                  type="text"
                  id="riskAnalysisItemText"
                  required
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                  placeholder="Enter risk..."
                >
              </div>
            </div>
            <div
              class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
            >
              <button
                type="button"
                id="cancelRiskAnalysisItemBtn"
                class="btn-secondary py-2 rounded-md"
              >
                Cancel
              </button>
              <button type="submit" class="btn-primary py-2 rounded-md">
                Add
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Lean Canvas View -->
      <div id="leanCanvasView" class="hidden pb-16">
        <div class="bg-primary rounded-lg shadow">
          <div
            class="px-6 py-4 border-b border-default flex justify-between items-center view-header"
          >
            <div class="flex items-center gap-4">
              <h2 class="text-lg font-medium text-primary">
                Lean Canvas
              </h2>
              <select
                id="leanCanvasSelector"
                class="text-sm border border-strong rounded-md px-3 py-1.5 focus:outline-none focus:ring-2 focus:ring-1"
              >
                <option value="">Select Canvas</option>
              </select>
            </div>
            <div class="flex items-center gap-2">
              <button
                id="editLeanCanvasBtn"
                class="btn-secondary py-1.5 rounded hidden"
              >
                Edit
              </button>
              <button
                id="deleteLeanCanvasBtn"
                class="btn-danger py-1.5 rounded hidden"
              >
                Delete
              </button>
              <button id="addLeanCanvasBtn" class="btn-primary py-2 rounded-lg">
                + New Canvas
              </button>
            </div>
          </div>
          <div class="p-6">
            <div id="emptyLeanCanvasState" class="text-center py-12">
              <svg
                class="mx-auto h-12 w-12 text-muted"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2"
                />
              </svg>
              <h3
                class="mt-2 text-sm font-medium text-primary"
              >
                No Lean Canvas yet
              </h3>
              <p class="mt-1 text-sm text-muted">
                Create a Lean Canvas to plan your startup or product.
              </p>
            </div>
            <div id="leanCanvasGrid" class="hidden">
              <!-- Row 1: Problem, Solution, UVP, Unfair Advantage, Customer Segments -->
              <div class="grid grid-cols-5 gap-2 mb-2">
                <div
                  class="bg-secondary/50 rounded-lg p-3 border border-default min-h-[140px]"
                >
                  <div class="flex justify-between items-center mb-2">
                    <h3
                      class="font-medium text-primary text-xs"
                    >
                      Problem
                    </h3>
                    <button
                      data-section="problem"
                      class="lean-add-btn text-secondary hover:text-primary text-xs"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="leanProblem"
                    class="space-y-1 text-xs text-secondary"
                  >
                  </ul>
                </div>
                <div
                  class="bg-secondary/50 rounded-lg p-3 border border-default min-h-[140px]"
                >
                  <div class="flex justify-between items-center mb-2">
                    <h3
                      class="font-medium text-primary text-xs"
                    >
                      Solution
                    </h3>
                    <button
                      data-section="solution"
                      class="lean-add-btn text-secondary hover:text-primary text-xs"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="leanSolution"
                    class="space-y-1 text-xs text-secondary"
                  >
                  </ul>
                </div>
                <div
                  class="bg-secondary/50 rounded-lg p-3 border border-default min-h-[140px]"
                >
                  <div class="flex justify-between items-center mb-2">
                    <h3
                      class="font-medium text-primary text-xs"
                    >
                      Unique Value
                    </h3>
                    <button
                      data-section="uniqueValueProp"
                      class="lean-add-btn text-secondary hover:text-primary text-xs"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="leanUniqueValueProp"
                    class="space-y-1 text-xs text-secondary"
                  >
                  </ul>
                </div>
                <div
                  class="bg-secondary/50 rounded-lg p-3 border border-default min-h-[140px]"
                >
                  <div class="flex justify-between items-center mb-2">
                    <h3
                      class="font-medium text-primary text-xs"
                    >
                      Unfair Advantage
                    </h3>
                    <button
                      data-section="unfairAdvantage"
                      class="lean-add-btn text-secondary hover:text-primary text-xs"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="leanUnfairAdvantage"
                    class="space-y-1 text-xs text-secondary"
                  >
                  </ul>
                </div>
                <div
                  class="bg-secondary/50 rounded-lg p-3 border border-default min-h-[140px]"
                >
                  <div class="flex justify-between items-center mb-2">
                    <h3
                      class="font-medium text-primary text-xs"
                    >
                      Customer Segments
                    </h3>
                    <button
                      data-section="customerSegments"
                      class="lean-add-btn text-secondary hover:text-primary text-xs"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="leanCustomerSegments"
                    class="space-y-1 text-xs text-secondary"
                  >
                  </ul>
                </div>
              </div>
              <!-- Row 2: Existing Alternatives, Key Metrics, High-Level Concept, Channels, Early Adopters -->
              <div class="grid grid-cols-5 gap-2 mb-2">
                <div
                  class="bg-secondary/50 rounded-lg p-3 border border-default min-h-[140px]"
                >
                  <div class="flex justify-between items-center mb-2">
                    <h3
                      class="font-medium text-primary text-xs"
                    >
                      Existing Alternatives
                    </h3>
                    <button
                      data-section="existingAlternatives"
                      class="lean-add-btn text-secondary hover:text-primary text-xs"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="leanExistingAlternatives"
                    class="space-y-1 text-xs text-secondary"
                  >
                  </ul>
                </div>
                <div
                  class="bg-secondary/50 rounded-lg p-3 border border-default min-h-[140px]"
                >
                  <div class="flex justify-between items-center mb-2">
                    <h3
                      class="font-medium text-primary text-xs"
                    >
                      Key Metrics
                    </h3>
                    <button
                      data-section="keyMetrics"
                      class="lean-add-btn text-secondary hover:text-primary text-xs"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="leanKeyMetrics"
                    class="space-y-1 text-xs text-secondary"
                  >
                  </ul>
                </div>
                <div
                  class="bg-secondary/50 rounded-lg p-3 border border-default min-h-[140px]"
                >
                  <div class="flex justify-between items-center mb-2">
                    <h3
                      class="font-medium text-primary text-xs"
                    >
                      High-Level Concept
                    </h3>
                    <button
                      data-section="highLevelConcept"
                      class="lean-add-btn text-secondary hover:text-primary text-xs"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="leanHighLevelConcept"
                    class="space-y-1 text-xs text-secondary"
                  >
                  </ul>
                </div>
                <div
                  class="bg-secondary/50 rounded-lg p-3 border border-default min-h-[140px]"
                >
                  <div class="flex justify-between items-center mb-2">
                    <h3
                      class="font-medium text-primary text-xs"
                    >
                      Channels
                    </h3>
                    <button
                      data-section="channels"
                      class="lean-add-btn text-secondary hover:text-primary text-xs"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="leanChannels"
                    class="space-y-1 text-xs text-secondary"
                  >
                  </ul>
                </div>
                <div
                  class="bg-secondary/50 rounded-lg p-3 border border-default min-h-[140px]"
                >
                  <div class="flex justify-between items-center mb-2">
                    <h3
                      class="font-medium text-primary text-xs"
                    >
                      Early Adopters
                    </h3>
                    <button
                      data-section="earlyAdopters"
                      class="lean-add-btn text-secondary hover:text-primary text-xs"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="leanEarlyAdopters"
                    class="space-y-1 text-xs text-secondary"
                  >
                  </ul>
                </div>
              </div>
              <!-- Row 3: Cost Structure, Revenue Streams -->
              <div class="grid grid-cols-2 gap-2">
                <div
                  class="bg-secondary/50 rounded-lg p-3 border border-default min-h-[100px]"
                >
                  <div class="flex justify-between items-center mb-2">
                    <h3
                      class="font-medium text-primary text-xs"
                    >
                      Cost Structure
                    </h3>
                    <button
                      data-section="costStructure"
                      class="lean-add-btn text-secondary hover:text-primary text-xs"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="leanCostStructure"
                    class="space-y-1 text-xs text-secondary"
                  >
                  </ul>
                </div>
                <div
                  class="bg-secondary/50 rounded-lg p-3 border border-default min-h-[100px]"
                >
                  <div class="flex justify-between items-center mb-2">
                    <h3
                      class="font-medium text-primary text-xs"
                    >
                      Revenue Streams
                    </h3>
                    <button
                      data-section="revenueStreams"
                      class="lean-add-btn text-secondary hover:text-primary text-xs"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="leanRevenueStreams"
                    class="space-y-1 text-xs text-secondary"
                  >
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Lean Canvas Modal -->
      <div
        id="leanCanvasModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-md w-full mx-4"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3
              id="leanCanvasModalTitle"
              class="text-lg font-medium text-primary"
            >
              New Lean Canvas
            </h3>
          </div>
          <form id="leanCanvasForm">
            <div class="p-6 space-y-4">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Title</label>
                <input
                  type="text"
                  id="leanCanvasTitle"
                  required
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                  placeholder="e.g., Product MVP"
                >
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Date</label>
                <input
                  type="date"
                  id="leanCanvasDate"
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                >
              </div>
            </div>
            <div
              class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
            >
              <button
                type="button"
                id="cancelLeanCanvasBtn"
                class="btn-secondary py-2 rounded-md"
              >
                Cancel
              </button>
              <button type="submit" class="btn-primary py-2 rounded-md">
                Save
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Lean Canvas Item Modal -->
      <div
        id="leanCanvasItemModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-md w-full mx-4"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3
              id="leanCanvasItemModalTitle"
              class="text-lg font-medium text-primary"
            >
              Add Item
            </h3>
          </div>
          <form id="leanCanvasItemForm">
            <div class="p-6">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Item</label>
                <input
                  type="text"
                  id="leanCanvasItemText"
                  required
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                  placeholder="Enter item..."
                >
              </div>
            </div>
            <div
              class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
            >
              <button
                type="button"
                id="cancelLeanCanvasItemBtn"
                class="btn-secondary py-2 rounded-md"
              >
                Cancel
              </button>
              <button type="submit" class="btn-primary py-2 rounded-md">
                Add
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Business Model Canvas View -->
      <div id="businessModelView" class="hidden pb-16">
        <div class="bg-primary rounded-lg shadow">
          <div
            class="px-6 py-4 border-b border-default flex justify-between items-center view-header"
          >
            <div class="flex items-center gap-4">
              <h2 class="text-lg font-medium text-primary">
                Business Model Canvas
              </h2>
              <select
                id="businessModelSelector"
                class="text-sm border border-strong rounded-md px-3 py-1.5 focus:outline-none focus:ring-2 focus:ring-1"
              >
                <option value="">Select Canvas</option>
              </select>
            </div>
            <div class="flex items-center gap-2">
              <button
                id="editBusinessModelBtn"
                class="btn-secondary py-1.5 rounded hidden"
              >
                Edit
              </button>
              <button
                id="deleteBusinessModelBtn"
                class="btn-danger py-1.5 rounded hidden"
              >
                Delete
              </button>
              <button
                id="addBusinessModelBtn"
                class="btn-primary py-2 rounded-lg"
              >
                + New Canvas
              </button>
            </div>
          </div>
          <div class="p-6">
            <div id="emptyBusinessModelState" class="text-center py-12">
              <svg
                class="mx-auto h-12 w-12 text-muted"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"
                />
              </svg>
              <h3
                class="mt-2 text-sm font-medium text-primary"
              >
                No Business Model Canvas yet
              </h3>
              <p class="mt-1 text-sm text-muted">
                Create a Business Model Canvas to map your business.
              </p>
            </div>
            <div id="businessModelGrid" class="hidden">
              <!-- Row 1: Key Partners, Key Activities, Value Proposition, Customer Relationships, Customer Segments -->
              <div class="grid grid-cols-5 gap-2 mb-2">
                <div
                  class="bg-secondary/50 rounded-lg p-3 border border-default min-h-[120px]"
                >
                  <div class="flex justify-between items-center mb-2">
                    <h3
                      class="font-medium text-primary text-xs"
                    >
                      Key Partners
                    </h3>
                    <button
                      data-section="keyPartners"
                      class="bmc-add-btn text-secondary hover:text-primary text-xs"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="bmcKeyPartners"
                    class="space-y-1 text-xs text-secondary"
                  >
                  </ul>
                </div>
                <div
                  class="bg-secondary/50 rounded-lg p-3 border border-default min-h-[120px]"
                >
                  <div class="flex justify-between items-center mb-2">
                    <h3
                      class="font-medium text-primary text-xs"
                    >
                      Key Activities
                    </h3>
                    <button
                      data-section="keyActivities"
                      class="bmc-add-btn text-secondary hover:text-primary text-xs"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="bmcKeyActivities"
                    class="space-y-1 text-xs text-secondary"
                  >
                  </ul>
                </div>
                <div
                  class="bg-secondary/50 rounded-lg p-3 border border-default min-h-[120px]"
                >
                  <div class="flex justify-between items-center mb-2">
                    <h3
                      class="font-medium text-primary text-xs"
                    >
                      Value Proposition
                    </h3>
                    <button
                      data-section="valueProposition"
                      class="bmc-add-btn text-secondary hover:text-primary text-xs"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="bmcValueProposition"
                    class="space-y-1 text-xs text-secondary"
                  >
                  </ul>
                </div>
                <div
                  class="bg-secondary/50 rounded-lg p-3 border border-default min-h-[120px]"
                >
                  <div class="flex justify-between items-center mb-2">
                    <h3
                      class="font-medium text-primary text-xs"
                    >
                      Customer Relationships
                    </h3>
                    <button
                      data-section="customerRelationships"
                      class="bmc-add-btn text-secondary hover:text-primary text-xs"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="bmcCustomerRelationships"
                    class="space-y-1 text-xs text-secondary"
                  >
                  </ul>
                </div>
                <div
                  class="bg-secondary/50 rounded-lg p-3 border border-default min-h-[120px]"
                >
                  <div class="flex justify-between items-center mb-2">
                    <h3
                      class="font-medium text-primary text-xs"
                    >
                      Customer Segments
                    </h3>
                    <button
                      data-section="customerSegments"
                      class="bmc-add-btn text-secondary hover:text-primary text-xs"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="bmcCustomerSegments"
                    class="space-y-1 text-xs text-secondary"
                  >
                  </ul>
                </div>
              </div>
              <!-- Row 2: Key Resources, Channels -->
              <div class="grid grid-cols-5 gap-2 mb-2">
                <div
                  class="col-span-2 bg-secondary/50 rounded-lg p-3 border border-default min-h-[100px]"
                >
                  <div class="flex justify-between items-center mb-2">
                    <h3
                      class="font-medium text-primary text-xs"
                    >
                      Key Resources
                    </h3>
                    <button
                      data-section="keyResources"
                      class="bmc-add-btn text-secondary hover:text-primary text-xs"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="bmcKeyResources"
                    class="space-y-1 text-xs text-secondary"
                  >
                  </ul>
                </div>
                <div
                  class="bg-secondary/50 rounded-lg p-3 border border-default min-h-[100px]"
                >
                </div>
                <div
                  class="col-span-2 bg-secondary/50 rounded-lg p-3 border border-default min-h-[100px]"
                >
                  <div class="flex justify-between items-center mb-2">
                    <h3
                      class="font-medium text-primary text-xs"
                    >
                      Channels
                    </h3>
                    <button
                      data-section="channels"
                      class="bmc-add-btn text-secondary hover:text-primary text-xs"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="bmcChannels"
                    class="space-y-1 text-xs text-secondary"
                  >
                  </ul>
                </div>
              </div>
              <!-- Row 3: Cost Structure, Revenue Streams -->
              <div class="grid grid-cols-2 gap-2">
                <div
                  class="bg-secondary/50 rounded-lg p-3 border border-default min-h-[100px]"
                >
                  <div class="flex justify-between items-center mb-2">
                    <h3
                      class="font-medium text-primary text-xs"
                    >
                      Cost Structure
                    </h3>
                    <button
                      data-section="costStructure"
                      class="bmc-add-btn text-secondary hover:text-primary text-xs"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="bmcCostStructure"
                    class="space-y-1 text-xs text-secondary"
                  >
                  </ul>
                </div>
                <div
                  class="bg-secondary/50 rounded-lg p-3 border border-default min-h-[100px]"
                >
                  <div class="flex justify-between items-center mb-2">
                    <h3
                      class="font-medium text-primary text-xs"
                    >
                      Revenue Streams
                    </h3>
                    <button
                      data-section="revenueStreams"
                      class="bmc-add-btn text-secondary hover:text-primary text-xs"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="bmcRevenueStreams"
                    class="space-y-1 text-xs text-secondary"
                  >
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Business Model Canvas Modal -->
      <div
        id="businessModelModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-md w-full mx-4"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3
              id="businessModelModalTitle"
              class="text-lg font-medium text-primary"
            >
              New Business Model Canvas
            </h3>
          </div>
          <form id="businessModelForm">
            <div class="p-6 space-y-4">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Title</label>
                <input
                  type="text"
                  id="businessModelTitle"
                  required
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                  placeholder="e.g., SaaS Business Model"
                >
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Date</label>
                <input
                  type="date"
                  id="businessModelDate"
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                >
              </div>
            </div>
            <div
              class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
            >
              <button
                type="button"
                id="cancelBusinessModelBtn"
                class="btn-secondary py-2 rounded-md"
              >
                Cancel
              </button>
              <button type="submit" class="btn-primary py-2 rounded-md">
                Save
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Business Model Canvas Item Modal -->
      <div
        id="businessModelItemModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-md w-full mx-4"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3
              id="businessModelItemModalTitle"
              class="text-lg font-medium text-primary"
            >
              Add Item
            </h3>
          </div>
          <form id="businessModelItemForm">
            <div class="p-6">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Item</label>
                <input
                  type="text"
                  id="businessModelItemText"
                  required
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                  placeholder="Enter item..."
                >
              </div>
            </div>
            <div
              class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
            >
              <button
                type="button"
                id="cancelBusinessModelItemBtn"
                class="btn-secondary py-2 rounded-md"
              >
                Cancel
              </button>
              <button type="submit" class="btn-primary py-2 rounded-md">
                Add
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Project Value Board View -->
      <div id="projectValueView" class="hidden pb-16">
        <div class="bg-primary rounded-lg shadow">
          <div
            class="px-6 py-4 border-b border-default flex justify-between items-center view-header"
          >
            <div class="flex items-center gap-4">
              <h2 class="text-lg font-medium text-primary">
                Project Value Board
              </h2>
              <select
                id="projectValueSelector"
                class="text-sm border border-strong rounded-md px-3 py-1.5 focus:outline-none focus:ring-2 focus:ring-1"
              >
                <option value="">Select Board</option>
              </select>
            </div>
            <div class="flex items-center gap-2">
              <button
                id="editProjectValueBtn"
                class="btn-secondary py-1.5 rounded hidden"
              >
                Edit
              </button>
              <button
                id="deleteProjectValueBtn"
                class="btn-danger py-1.5 rounded hidden"
              >
                Delete
              </button>
              <button
                id="addProjectValueBtn"
                class="btn-primary py-2 rounded-lg"
              >
                + New Board
              </button>
            </div>
          </div>
          <div class="p-6">
            <div id="emptyProjectValueState" class="text-center py-12">
              <svg
                class="mx-auto h-12 w-12 text-muted"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"
                />
              </svg>
              <h3
                class="mt-2 text-sm font-medium text-primary"
              >
                No Project Value Board yet
              </h3>
              <p class="mt-1 text-sm text-muted">
                Create a board to map customer value.
              </p>
            </div>
            <div id="projectValueGrid" class="hidden">
              <div class="grid grid-cols-2 gap-4">
                <div
                  class="bg-secondary/50 rounded-lg p-4 border border-default min-h-[180px]"
                >
                  <div class="flex justify-between items-center mb-3">
                    <h3
                      class="font-medium text-primary text-sm"
                    >
                      Customer Segments
                    </h3>
                    <button
                      data-section="customerSegments"
                      class="pvb-add-btn text-secondary hover:text-primary text-sm"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="pvbCustomerSegments"
                    class="space-y-2 text-sm text-secondary"
                  >
                  </ul>
                </div>
                <div
                  class="bg-secondary/50 rounded-lg p-4 border border-default min-h-[180px]"
                >
                  <div class="flex justify-between items-center mb-3">
                    <h3
                      class="font-medium text-primary text-sm"
                    >
                      Problem
                    </h3>
                    <button
                      data-section="problem"
                      class="pvb-add-btn text-secondary hover:text-primary text-sm"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="pvbProblem"
                    class="space-y-2 text-sm text-secondary"
                  >
                  </ul>
                </div>
                <div
                  class="bg-secondary/50 rounded-lg p-4 border border-default min-h-[180px]"
                >
                  <div class="flex justify-between items-center mb-3">
                    <h3
                      class="font-medium text-primary text-sm"
                    >
                      Solution
                    </h3>
                    <button
                      data-section="solution"
                      class="pvb-add-btn text-secondary hover:text-primary text-sm"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="pvbSolution"
                    class="space-y-2 text-sm text-secondary"
                  >
                  </ul>
                </div>
                <div
                  class="bg-secondary/50 rounded-lg p-4 border border-default min-h-[180px]"
                >
                  <div class="flex justify-between items-center mb-3">
                    <h3
                      class="font-medium text-primary text-sm"
                    >
                      Benefit
                    </h3>
                    <button
                      data-section="benefit"
                      class="pvb-add-btn text-secondary hover:text-primary text-sm"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="pvbBenefit"
                    class="space-y-2 text-sm text-secondary"
                  >
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Project Value Board Modal -->
      <div
        id="projectValueModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-md w-full mx-4"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3
              id="projectValueModalTitle"
              class="text-lg font-medium text-primary"
            >
              New Project Value Board
            </h3>
          </div>
          <form id="projectValueForm">
            <div class="p-6 space-y-4">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Title</label>
                <input
                  type="text"
                  id="projectValueTitle"
                  required
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                  placeholder="e.g., Product Value Analysis"
                >
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Date</label>
                <input
                  type="date"
                  id="projectValueDate"
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                >
              </div>
            </div>
            <div
              class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
            >
              <button
                type="button"
                id="cancelProjectValueBtn"
                class="btn-secondary py-2 rounded-md"
              >
                Cancel
              </button>
              <button type="submit" class="btn-primary py-2 rounded-md">
                Save
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Project Value Board Item Modal -->
      <div
        id="projectValueItemModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-md w-full mx-4"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3
              id="projectValueItemModalTitle"
              class="text-lg font-medium text-primary"
            >
              Add Item
            </h3>
          </div>
          <form id="projectValueItemForm">
            <div class="p-6">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Item</label>
                <input
                  type="text"
                  id="projectValueItemText"
                  required
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                  placeholder="Enter item..."
                >
              </div>
            </div>
            <div
              class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
            >
              <button
                type="button"
                id="cancelProjectValueItemBtn"
                class="btn-secondary py-2 rounded-md"
              >
                Cancel
              </button>
              <button type="submit" class="btn-primary py-2 rounded-md">
                Add
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Brief View -->
      <div id="briefView" class="hidden pb-16">
        <div class="bg-primary rounded-lg shadow">
          <div
            class="px-6 py-4 border-b border-default flex justify-between items-center view-header"
          >
            <div class="flex items-center gap-4">
              <h2 class="text-lg font-medium text-primary">
                Brief
              </h2>
              <select
                id="briefSelector"
                class="text-sm border border-strong rounded-md px-3 py-1.5 focus:outline-none focus:ring-2 focus:ring-1"
              >
                <option value="">Select Brief</option>
              </select>
            </div>
            <div class="flex items-center gap-2">
              <button
                id="editBriefBtn"
                class="btn-secondary py-1.5 rounded hidden"
              >
                Edit
              </button>
              <button
                id="deleteBriefBtn"
                class="btn-danger py-1.5 rounded hidden"
              >
                Delete
              </button>
              <button id="addBriefBtn" class="btn-primary py-2 rounded-lg">
                + New Brief
              </button>
            </div>
          </div>
          <div class="p-6">
            <div id="emptyBriefState" class="text-center py-12">
              <svg
                class="mx-auto h-12 w-12 text-muted"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                />
              </svg>
              <h3
                class="mt-2 text-sm font-medium text-primary"
              >
                No Brief yet
              </h3>
              <p class="mt-1 text-sm text-muted">
                Create a brief to document project scope and RACI.
              </p>
            </div>
            <div id="briefGrid" class="hidden space-y-6">
              <!-- Row 1: Summary -->
              <div
                class="bg-secondary/50 rounded-lg p-4 border border-default"
              >
                <div class="flex justify-between items-center mb-3">
                  <h3
                    class="font-medium text-primary text-sm"
                  >
                    Summary
                  </h3>
                  <button
                    data-section="summary"
                    class="brief-add-btn text-secondary hover:text-primary text-sm"
                  >
                    +
                  </button>
                </div>
                <ul
                  id="briefSummary"
                  class="space-y-2 text-sm text-secondary"
                >
                </ul>
              </div>

              <!-- Row 2: Mission -->
              <div
                class="bg-secondary/50 rounded-lg p-4 border border-default"
              >
                <div class="flex justify-between items-center mb-3">
                  <h3
                    class="font-medium text-primary text-sm"
                  >
                    Mission
                  </h3>
                  <button
                    data-section="mission"
                    class="brief-add-btn text-secondary hover:text-primary text-sm"
                  >
                    +
                  </button>
                </div>
                <ul
                  id="briefMission"
                  class="space-y-2 text-sm text-secondary"
                >
                </ul>
              </div>

              <!-- Row 3: RACI -->
              <div class="brief-raci-grid grid grid-cols-4 gap-4">
                <div
                  class="bg-secondary/50 rounded-lg p-4 border border-default min-h-[140px]"
                >
                  <div class="flex justify-between items-center mb-3">
                    <h3
                      class="font-medium text-primary text-sm"
                    >
                      Responsible
                    </h3>
                    <button
                      data-section="responsible"
                      class="brief-add-btn text-secondary hover:text-primary text-sm"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="briefResponsible"
                    class="space-y-2 text-sm text-secondary"
                  >
                  </ul>
                </div>
                <div
                  class="bg-secondary/50 rounded-lg p-4 border border-default min-h-[140px]"
                >
                  <div class="flex justify-between items-center mb-3">
                    <h3
                      class="font-medium text-primary text-sm"
                    >
                      Accountable
                    </h3>
                    <button
                      data-section="accountable"
                      class="brief-add-btn text-secondary hover:text-primary text-sm"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="briefAccountable"
                    class="space-y-2 text-sm text-secondary"
                  >
                  </ul>
                </div>
                <div
                  class="bg-secondary/50 rounded-lg p-4 border border-default min-h-[140px]"
                >
                  <div class="flex justify-between items-center mb-3">
                    <h3
                      class="font-medium text-primary text-sm"
                    >
                      Consulted
                    </h3>
                    <button
                      data-section="consulted"
                      class="brief-add-btn text-secondary hover:text-primary text-sm"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="briefConsulted"
                    class="space-y-2 text-sm text-secondary"
                  >
                  </ul>
                </div>
                <div
                  class="bg-secondary/50 rounded-lg p-4 border border-default min-h-[140px]"
                >
                  <div class="flex justify-between items-center mb-3">
                    <h3
                      class="font-medium text-primary text-sm"
                    >
                      Informed
                    </h3>
                    <button
                      data-section="informed"
                      class="brief-add-btn text-secondary hover:text-primary text-sm"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="briefInformed"
                    class="space-y-2 text-sm text-secondary"
                  >
                  </ul>
                </div>
              </div>

              <!-- Row 4: Budget & Timeline -->
              <div class="brief-two-col-grid grid grid-cols-2 gap-4">
                <div
                  class="bg-secondary/50 rounded-lg p-4 border border-default min-h-[140px]"
                >
                  <div class="flex justify-between items-center mb-3">
                    <h3
                      class="font-medium text-primary text-sm"
                    >
                      High Level Budget
                    </h3>
                    <button
                      data-section="highLevelBudget"
                      class="brief-add-btn text-secondary hover:text-primary text-sm"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="briefBudget"
                    class="space-y-2 text-sm text-secondary"
                  >
                  </ul>
                </div>
                <div
                  class="bg-secondary/50 rounded-lg p-4 border border-default min-h-[140px]"
                >
                  <div class="flex justify-between items-center mb-3">
                    <h3
                      class="font-medium text-primary text-sm"
                    >
                      High Level Timeline
                    </h3>
                    <button
                      data-section="highLevelTimeline"
                      class="brief-add-btn text-secondary hover:text-primary text-sm"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="briefTimeline"
                    class="space-y-2 text-sm text-secondary"
                  >
                  </ul>
                </div>
              </div>

              <!-- Row 5: Culture & Change Capacity -->
              <div class="brief-two-col-grid grid grid-cols-2 gap-4">
                <div
                  class="bg-secondary/50 rounded-lg p-4 border border-default min-h-[140px]"
                >
                  <div class="flex justify-between items-center mb-3">
                    <h3
                      class="font-medium text-primary text-sm"
                    >
                      Culture
                    </h3>
                    <button
                      data-section="culture"
                      class="brief-add-btn text-secondary hover:text-primary text-sm"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="briefCulture"
                    class="space-y-2 text-sm text-secondary"
                  >
                  </ul>
                </div>
                <div
                  class="bg-secondary/50 rounded-lg p-4 border border-default min-h-[140px]"
                >
                  <div class="flex justify-between items-center mb-3">
                    <h3
                      class="font-medium text-primary text-sm"
                    >
                      Change Capacity
                    </h3>
                    <button
                      data-section="changeCapacity"
                      class="brief-add-btn text-secondary hover:text-primary text-sm"
                    >
                      +
                    </button>
                  </div>
                  <ul
                    id="briefChangeCapacity"
                    class="space-y-2 text-sm text-secondary"
                  >
                  </ul>
                </div>
              </div>

              <!-- Row 6: Guiding Principles -->
              <div
                class="bg-secondary/50 rounded-lg p-4 border border-default"
              >
                <div class="flex justify-between items-center mb-3">
                  <h3
                    class="font-medium text-primary text-sm"
                  >
                    Guiding Principles
                  </h3>
                  <button
                    data-section="guidingPrinciples"
                    class="brief-add-btn text-secondary hover:text-primary text-sm"
                  >
                    +
                  </button>
                </div>
                <ul
                  id="briefGuidingPrinciples"
                  class="space-y-2 text-sm text-secondary"
                >
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Brief Modal -->
      <div
        id="briefModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-md w-full mx-4"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3
              id="briefModalTitle"
              class="text-lg font-medium text-primary"
            >
              New Brief
            </h3>
          </div>
          <form id="briefForm">
            <div class="p-6 space-y-4">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Title</label>
                <input
                  type="text"
                  id="briefTitle"
                  required
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                  placeholder="e.g., Q1 Project Brief"
                >
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Date</label>
                <input
                  type="date"
                  id="briefDate"
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                >
              </div>
            </div>
            <div
              class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
            >
              <button
                type="button"
                id="cancelBriefBtn"
                class="btn-secondary py-2 rounded-md"
              >
                Cancel
              </button>
              <button type="submit" class="btn-primary py-2 rounded-md">
                Save
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Brief Item Modal -->
      <div
        id="briefItemModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-md w-full mx-4"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3 class="text-lg font-medium text-primary">
              Add to <span id="briefItemSectionTitle"></span>
            </h3>
          </div>
          <form id="briefItemForm">
            <div class="p-6">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Item</label>
                <input
                  type="text"
                  id="briefItemText"
                  required
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                  placeholder="Enter item..."
                >
              </div>
            </div>
            <div
              class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
            >
              <button
                type="button"
                id="cancelBriefItemBtn"
                class="btn-secondary py-2 rounded-md"
              >
                Cancel
              </button>
              <button type="submit" class="btn-primary py-2 rounded-md">
                Add
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Capacity Plan Modal -->
      <div
        id="capacityPlanModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-md w-full mx-4"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3
              id="capacityPlanModalTitle"
              class="text-lg font-medium text-primary"
            >
              New Capacity Plan
            </h3>
          </div>
          <form id="capacityPlanForm">
            <div class="p-6 space-y-4">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Title</label>
                <input
                  type="text"
                  id="capacityPlanTitle"
                  required
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                  placeholder="e.g., Q1 2026 Capacity"
                >
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Date</label>
                <input
                  type="date"
                  id="capacityPlanDate"
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                >
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Budget Hours (optional)</label>
                <input
                  type="number"
                  id="capacityPlanBudget"
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                  placeholder="e.g., 500"
                >
              </div>
            </div>
            <div
              class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
            >
              <button
                type="button"
                id="cancelCapacityPlanBtn"
                class="btn-secondary py-2 rounded-md"
              >
                Cancel
              </button>
              <button type="submit" class="btn-primary py-2 rounded-md">
                Save
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Team Member Modal -->
      <div
        id="teamMemberModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-md w-full mx-4"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3
              id="teamMemberModalTitle"
              class="text-lg font-medium text-primary"
            >
              Add Team Member
            </h3>
          </div>
          <form id="teamMemberForm">
            <div class="p-6 space-y-4">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Person</label>
                <select
                  id="teamMemberPersonId"
                  required
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                >
                  <option value="">Select person...</option>
                </select>
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Hours Per Day (override)</label>
                <input
                  type="number"
                  id="teamMemberHours"
                  value="8"
                  min="1"
                  max="24"
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                >
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Working Days</label>
                <div class="flex flex-wrap gap-2">
                  <label
                    class="flex items-center gap-1 text-sm text-secondary"
                  >
                    <input type="checkbox" id="workMon" checked class="rounded">
                    Mon
                  </label>
                  <label
                    class="flex items-center gap-1 text-sm text-secondary"
                  >
                    <input type="checkbox" id="workTue" checked class="rounded">
                    Tue
                  </label>
                  <label
                    class="flex items-center gap-1 text-sm text-secondary"
                  >
                    <input type="checkbox" id="workWed" checked class="rounded">
                    Wed
                  </label>
                  <label
                    class="flex items-center gap-1 text-sm text-secondary"
                  >
                    <input type="checkbox" id="workThu" checked class="rounded">
                    Thu
                  </label>
                  <label
                    class="flex items-center gap-1 text-sm text-secondary"
                  >
                    <input type="checkbox" id="workFri" checked class="rounded">
                    Fri
                  </label>
                  <label
                    class="flex items-center gap-1 text-sm text-secondary"
                  >
                    <input type="checkbox" id="workSat" class="rounded"> Sat
                  </label>
                  <label
                    class="flex items-center gap-1 text-sm text-secondary"
                  >
                    <input type="checkbox" id="workSun" class="rounded"> Sun
                  </label>
                </div>
              </div>
            </div>
            <div
              class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
            >
              <button
                type="button"
                id="cancelTeamMemberBtn"
                class="btn-secondary py-2 rounded-md"
              >
                Cancel
              </button>
              <button type="submit" class="btn-primary py-2 rounded-md">
                Save
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Allocation Modal -->
      <div
        id="allocationModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-md w-full mx-4"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3
              id="allocationModalTitle"
              class="text-lg font-medium text-primary"
            >
              Set Allocation
            </h3>
          </div>
          <form id="allocationForm">
            <div class="p-6 space-y-4">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Hours this week</label>
                <input
                  type="number"
                  id="allocationHours"
                  required
                  min="0"
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                  placeholder="e.g., 8"
                >
                <p class="text-xs text-muted mt-1">
                  Hours this person will work on the selected target this week
                </p>
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Target Type</label>
                <select
                  id="allocationTargetType"
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                >
                  <option value="project">Project</option>
                  <option value="task">Task</option>
                  <option value="milestone">Milestone</option>
                </select>
              </div>
              <div id="allocationTargetContainer">
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Target (optional)</label>
                <select
                  id="allocationTargetId"
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                >
                  <option value="">Select target...</option>
                </select>
                <p
                  id="allocationTargetHint"
                  class="text-xs text-muted mt-1"
                >
                  Select a task or milestone to allocate time
                </p>
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Notes (optional)</label>
                <input
                  type="text"
                  id="allocationNotes"
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                  placeholder="e.g., Sprint 1 work"
                >
              </div>
            </div>
            <div
              class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
            >
              <button
                type="button"
                id="deleteAllocationBtn"
                class="btn-danger py-2 rounded-md hidden"
              >
                Delete
              </button>
              <button
                type="button"
                id="cancelAllocationBtn"
                class="btn-secondary py-2 rounded-md"
              >
                Cancel
              </button>
              <button type="submit" class="btn-primary py-2 rounded-md">
                Save
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Auto-Assign Modal -->
      <div
        id="autoAssignModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-2xl w-full mx-4"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3 class="text-lg font-medium text-primary">
              Auto-Assign Suggestions
            </h3>
            <p class="text-xs text-muted mt-1">
              Suggests task assignments based on available capacity and task
              effort estimates
            </p>
          </div>
          <div class="p-6">
            <div
              id="autoAssignEmpty"
              class="text-center py-8 text-muted"
            >
              No unassigned tasks found or all team members at capacity.
            </div>
            <div id="autoAssignList" class="space-y-3 max-h-96 overflow-y-auto">
            </div>
          </div>
          <div
            class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
          >
            <button
              type="button"
              id="cancelAutoAssignBtn"
              class="btn-secondary py-2 rounded-md"
            >
              Cancel
            </button>
            <button
              type="button"
              id="applyAutoAssignBtn"
              class="btn-primary py-2 rounded-md"
            >
              Apply Selected
            </button>
          </div>
        </div>
      </div>

      <!-- Import People Modal -->
      <div
        id="importAssigneesModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-md w-full mx-4"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3 class="text-lg font-medium text-primary">
              Import from People
            </h3>
            <p class="text-sm text-muted mt-1">
              Add team members from the people directory
            </p>
          </div>
          <div class="p-6">
            <div
              id="importAssigneesEmpty"
              class="text-center py-8 text-muted hidden"
            >
              All people are already team members, or no people configured.
            </div>
            <div
              id="importAssigneesList"
              class="space-y-2 max-h-64 overflow-y-auto"
            >
            </div>
          </div>
          <div
            class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
          >
            <button
              type="button"
              id="cancelImportAssigneesBtn"
              class="btn-secondary py-2 rounded-md"
            >
              Cancel
            </button>
            <button
              type="button"
              id="applyImportAssigneesBtn"
              class="btn-primary py-2 rounded-md"
            >
              Import Selected
            </button>
          </div>
        </div>
      </div>

      <!-- Time Tracking View -->
      <div id="timeTrackingView" class="hidden pb-16">
        <div class="bg-primary rounded-lg shadow mb-6">
          <div
            class="px-6 py-4 border-b border-default flex justify-between items-center view-header"
          >
            <h2 class="text-lg font-medium text-primary">
              Time Tracking
            </h2>
            <div class="flex items-center gap-4">
              <div class="text-sm text-secondary">
                Total Hours: <span
                  id="globalTotalHours"
                  class="font-semibold text-primary"
                >0</span>h
              </div>
            </div>
          </div>
          <div class="p-6">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
              <div
                class="bg-secondary rounded-lg p-4 border border-default"
              >
                <div class="text-sm text-secondary">
                  This Week
                </div>
                <div
                  class="text-2xl font-bold text-primary"
                  id="weeklyHours"
                >
                  0h
                </div>
              </div>
              <div class="bg-success-bg/30 rounded-lg p-4">
                <div class="text-sm text-success">
                  This Month
                </div>
                <div
                  class="text-2xl font-bold text-success-text"
                  id="monthlyHours"
                >
                  0h
                </div>
              </div>
              <div class="bg-info-bg rounded-lg p-4">
                <div class="text-sm text-info">
                  By Person
                </div>
                <div
                  id="hoursByPerson"
                  class="text-sm text-info mt-1"
                >
                </div>
              </div>
            </div>
            <div id="emptyTimeTrackingState" class="text-center py-12 hidden">
              <svg
                class="mx-auto h-12 w-12 text-muted"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"
                />
              </svg>
              <h3
                class="mt-2 text-sm font-medium text-primary"
              >
                No time entries yet
              </h3>
              <p class="mt-1 text-sm text-muted">
                Log time on tasks to see your tracking data.
              </p>
            </div>
            <div id="timeTrackingContainer" class="space-y-4"></div>
          </div>
        </div>
      </div>

      <!-- Capacity Planning View -->
      <div id="capacityView" class="hidden pb-16">
        <div class="bg-primary rounded-lg shadow">
          <div
            class="px-6 py-4 border-b border-default flex justify-between items-center capacity-header view-header"
          >
            <div class="flex items-center gap-4">
              <h2 class="text-lg font-medium text-primary">
                Capacity Planning
              </h2>
              <select
                id="capacityPlanSelector"
                class="text-sm border border-strong rounded-md px-3 py-1.5 focus:outline-none focus:ring-2 focus:ring-1"
              >
                <option value="">Select Plan</option>
              </select>
            </div>
            <div class="flex items-center gap-2">
              <button
                id="editCapacityPlanBtn"
                class="btn-secondary py-1.5 rounded hidden"
              >
                Edit
              </button>
              <button
                id="deleteCapacityPlanBtn"
                class="btn-danger py-1.5 rounded hidden"
              >
                Delete
              </button>
              <button
                id="addCapacityPlanBtn"
                class="btn-primary py-2 rounded-lg"
              >
                + New Plan
              </button>
            </div>
          </div>

          <!-- Tabs -->
          <nav class="view-tabs" aria-label="Tabs">
            <button id="capacityTeamTab" class="view-tab active">Team Members</button>
            <button id="capacityAllocTab" class="view-tab">Allocations</button>
            <button id="capacityUtilTab" class="view-tab">Utilization</button>
          </nav>

          <div class="p-6">
            <div id="emptyCapacityState" class="text-center py-12">
              <svg
                class="mx-auto h-12 w-12 text-muted"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"
                />
              </svg>
              <h3
                class="mt-2 text-sm font-medium text-primary"
              >
                No Capacity Plan yet
              </h3>
              <p class="mt-1 text-sm text-muted">
                Create a capacity plan to manage team allocations.
              </p>
            </div>

            <!-- Team Members Tab Content -->
            <div id="capacityTeamContent" class="hidden">
              <div class="flex justify-between items-center mb-4 capacity-section-header">
                <div>
                  <h3
                    class="text-sm font-medium text-secondary"
                  >
                    Team Members
                  </h3>
                  <p class="text-xs text-muted mt-1">
                    Define team members with their available hours per day and
                    working days. Weekly capacity = hours/day x working days.
                  </p>
                </div>
                <div class="flex items-center gap-3">
                  <button
                    id="importAssigneesBtn"
                    class="text-sm text-info hover:text-info"
                  >
                    Import from People
                  </button>
                  <button
                    id="addTeamMemberBtn"
                    class="text-sm text-secondary hover:text-primary"
                  >
                    + Add Member
                  </button>
                </div>
              </div>
              <div
                id="teamMembersGrid"
                class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"
              >
              </div>
            </div>

            <!-- Allocations Tab Content -->
            <div id="capacityAllocContent" class="hidden">
              <div class="flex justify-between items-center mb-4 capacity-section-header">
                <div>
                  <div class="flex items-center gap-4">
                    <h3
                      class="text-sm font-medium text-secondary"
                    >
                      Weekly Allocations
                    </h3>
                    <div class="flex items-center gap-2">
                      <button
                        id="allocPrevWeek"
                        class="text-muted hover:text-secondary"
                      >
                        &lt;
                      </button>
                      <span
                        id="allocWeekRange"
                        class="text-sm text-secondary"
                      >Week</span>
                      <button
                        id="allocNextWeek"
                        class="text-muted hover:text-secondary"
                      >
                        &gt;
                      </button>
                    </div>
                  </div>
                  <p class="text-xs text-muted mt-1">
                    Assign hours to team members for specific weeks. Click a
                    cell to allocate time to a task or milestone.
                  </p>
                </div>
                <button
                  id="autoAssignBtn"
                  class="btn-secondary py-1.5 rounded text-sm"
                >
                  Auto-Assign
                </button>
              </div>
              <div id="allocationsGrid" class="overflow-x-auto">
                <table
                  class="min-w-full divide-y divide-y border-default"
                >
                  <thead class="bg-secondary">
                    <tr id="allocationsHeader">
                      <th
                        class="px-4 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider"
                      >
                        Member
                      </th>
                    </tr>
                  </thead>
                  <tbody
                    id="allocationsBody"
                    class="bg-primary divide-y divide-y border-default"
                  >
                  </tbody>
                </table>
              </div>
              <div
                class="mt-4 flex items-center gap-4 text-xs text-muted"
              >
                <span class="font-medium">Capacity usage:</span>
                <span class="flex items-center gap-1"><span
                    class="w-3 h-3 rounded bg-success-bg/30 border border-success-border"
                  ></span> Under 80% (available)</span>
                <span class="flex items-center gap-1"><span
                    class="w-3 h-3 rounded bg-warning-bg border border-warning-border"
                  ></span> 80-100% (near full)</span>
                <span class="flex items-center gap-1"><span
                    class="w-3 h-3 rounded bg-error-bg/30 border border-error-border"
                  ></span> Over 100% (overloaded)</span>
              </div>
            </div>

            <!-- Utilization Tab Content -->
            <div id="capacityUtilContent" class="hidden">
              <div class="mb-4">
                <h3
                  class="text-sm font-medium text-secondary"
                >
                  Utilization Overview
                </h3>
                <p class="text-xs text-muted mt-1">
                  Compare allocated hours vs actual time tracked. Utilization %
                  = allocated / weekly capacity.
                </p>
              </div>
              <div
                class="mb-4 flex items-center gap-6 text-xs text-muted"
              >
                <span class="flex items-center gap-1"><span
                    class="w-3 h-3 rounded bg-active opacity-30"
                  ></span> Available capacity (4 weeks)</span>
                <span class="flex items-center gap-1"><span
                    class="w-3 h-3 rounded bg-info"
                  ></span> Allocated hours</span>
                <span class="flex items-center gap-1"><span
                    class="w-3 h-3 rounded bg-success"
                  ></span> Actual hours tracked</span>
              </div>
              <div id="utilizationBars" class="space-y-4"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Strategic Levels View -->
      <div id="strategicLevelsView" class="hidden pb-16">
        <div class="mobile-notice">
          <svg width="32" height="32" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>
          <span>Strategic Levels requires a larger screen.</span>
        </div>
        <div class="bg-primary rounded-lg shadow">
          <div
            class="px-6 py-4 border-b border-default flex justify-between items-center view-header"
          >
            <div class="flex items-center gap-4">
              <h2 class="text-lg font-medium text-primary">
                Strategic Levels
              </h2>
              <select
                id="strategicLevelsSelector"
                class="text-sm border border-strong rounded-md px-3 py-1.5 focus:outline-none focus:ring-2 focus:ring-1"
              >
                <option value="">Select Strategy</option>
              </select>
              <div
                class="flex items-center border border-strong rounded-md overflow-hidden"
              >
                <button
                  onclick="taskManager.setStrategicViewMode('tree')"
                  data-mode="tree"
                  class="strategic-view-toggle px-3 py-1.5 text-sm text-secondary bg-active hover:bg-tertiary"
                >
                  Tree
                </button>
                <button
                  onclick="taskManager.setStrategicViewMode('pyramid')"
                  data-mode="pyramid"
                  class="strategic-view-toggle px-3 py-1.5 text-sm text-secondary hover:bg-tertiary"
                >
                  Pyramid
                </button>
              </div>
            </div>
            <div class="flex items-center gap-2">
              <button
                id="editStrategicLevelsBtn"
                class="btn-secondary py-1.5 rounded hidden"
              >
                Edit
              </button>
              <button
                id="deleteStrategicLevelsBtn"
                class="btn-danger py-1.5 rounded hidden"
              >
                Delete
              </button>
              <button
                id="addStrategicLevelsBtn"
                class="btn-primary py-2 rounded-lg"
              >
                + New Strategy
              </button>
            </div>
          </div>
          <div class="p-6">
            <div id="emptyStrategicLevelsState" class="text-center py-12">
              <svg
                class="mx-auto h-12 w-12 text-muted"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"
                />
              </svg>
              <h3
                class="mt-2 text-sm font-medium text-primary"
              >
                No Strategic Levels yet
              </h3>
              <p class="mt-1 text-sm text-muted">
                Create a strategy to define your hierarchy from Vision to
                Tactics.
              </p>
            </div>
            <div id="strategicLevelsTree" class="hidden pl-6">
              <!-- Tree will be rendered here -->
            </div>
          </div>
        </div>
      </div>

      <!-- Billing View -->
      <div id="billingView" class="hidden pb-16">
        <div class="bg-primary rounded-lg shadow">
          <div class="px-6 py-4 border-b border-default">
            <div class="flex justify-between items-center mb-4">
              <h2 class="text-lg font-medium text-primary">
                Billing
              </h2>
            </div>
            <!-- Billing Summary Cards -->
            <div
              id="billingSummaryCards"
              class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4"
            >
              <div class="bg-secondary rounded-lg p-4">
                <p class="text-xs text-muted">
                  Outstanding
                </p>
                <p
                  id="billingSummaryOutstanding"
                  class="text-xl font-bold text-primary"
                >
                  $0.00
                </p>
              </div>
              <div class="bg-secondary rounded-lg p-4">
                <p class="text-xs text-muted">Overdue</p>
                <p
                  id="billingSummaryOverdue"
                  class="text-xl font-bold text-error"
                >
                  $0.00
                </p>
              </div>
              <div class="bg-secondary rounded-lg p-4">
                <p class="text-xs text-muted">
                  Paid (YTD)
                </p>
                <p
                  id="billingSummaryPaid"
                  class="text-xl font-bold text-success"
                >
                  $0.00
                </p>
              </div>
              <div class="bg-secondary rounded-lg p-4">
                <p class="text-xs text-muted">
                  Draft Invoices
                </p>
                <p
                  id="billingSummaryDraft"
                  class="text-xl font-bold text-secondary"
                >
                  0
                </p>
              </div>
            </div>
            <!-- Billing Tabs -->
            <nav class="view-tabs">
              <button data-billing-tab="customers" class="view-tab active">Customers</button>
              <button data-billing-tab="rates" class="view-tab">Rates</button>
              <button data-billing-tab="quotes" class="view-tab">Quotes</button>
              <button data-billing-tab="invoices" class="view-tab">Invoices</button>
            </nav>
          </div>
          <div class="p-6">
            <!-- Customers Tab -->
            <div id="customersTab" class="billing-tab-content">
              <div class="flex justify-end mb-4">
                <button id="addCustomerBtn" class="btn-primary py-2 rounded-lg">
                  + Add Customer
                </button>
              </div>
              <div id="emptyCustomersState" class="text-center py-12 hidden">
                <svg
                  class="mx-auto h-12 w-12 text-muted"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"
                  />
                </svg>
                <h3
                  class="mt-2 text-sm font-medium text-primary"
                >
                  No customers yet
                </h3>
                <p class="mt-1 text-sm text-muted">
                  Add your first customer to start billing.
                </p>
              </div>
              <div
                id="customersContainer"
                class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"
              >
              </div>
            </div>
            <!-- Rates Tab -->
            <div id="ratesTab" class="billing-tab-content hidden">
              <div class="flex justify-end mb-4">
                <button
                  id="addBillingRateBtn"
                  class="btn-primary py-2 rounded-lg"
                >
                  + Add Rate
                </button>
              </div>
              <div id="emptyRatesState" class="text-center py-12 hidden">
                <svg
                  class="mx-auto h-12 w-12 text-muted"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                  />
                </svg>
                <h3
                  class="mt-2 text-sm font-medium text-primary"
                >
                  No billing rates
                </h3>
                <p class="mt-1 text-sm text-muted">
                  Define hourly rates for billing.
                </p>
              </div>
              <div
                id="billingRatesContainer"
                class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"
              >
              </div>
            </div>
            <!-- Quotes Tab -->
            <div id="quotesTab" class="billing-tab-content hidden">
              <div class="flex justify-end mb-4">
                <button id="addQuoteBtn" class="btn-primary py-2 rounded-lg">
                  + New Quote
                </button>
              </div>
              <div id="emptyQuotesState" class="text-center py-12 hidden">
                <svg
                  class="mx-auto h-12 w-12 text-muted"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                  />
                </svg>
                <h3
                  class="mt-2 text-sm font-medium text-primary"
                >
                  No quotes yet
                </h3>
                <p class="mt-1 text-sm text-muted">
                  Create quotes for your customers.
                </p>
              </div>
              <div id="quotesContainer" class="space-y-4"></div>
            </div>
            <!-- Invoices Tab -->
            <div id="invoicesTab" class="billing-tab-content hidden">
              <div class="flex justify-end gap-2 mb-4">
                <button
                  id="generateInvoiceBtn"
                  class="btn-secondary py-2 rounded-lg"
                >
                  Generate from Time
                </button>
                <button id="addInvoiceBtn" class="btn-primary py-2 rounded-lg">
                  + New Invoice
                </button>
              </div>
              <div id="emptyInvoicesState" class="text-center py-12 hidden">
                <svg
                  class="mx-auto h-12 w-12 text-muted"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M9 14l6-6m-5.5.5h.01m4.99 5h.01M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16l3.5-2 3.5 2 3.5-2 3.5 2zM10 8.5a.5.5 0 11-1 0 .5.5 0 011 0zm5 5a.5.5 0 11-1 0 .5.5 0 011 0z"
                  />
                </svg>
                <h3
                  class="mt-2 text-sm font-medium text-primary"
                >
                  No invoices yet
                </h3>
                <p class="mt-1 text-sm text-muted">
                  Create invoices to bill your customers.
                </p>
              </div>
              <div id="invoicesContainer" class="space-y-4"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- CRM View -->
      <div id="crmView" class="hidden pb-16">
        <div class="bg-primary rounded-lg shadow">
          <div class="px-6 py-4 border-b border-default">
            <div class="flex justify-between items-center mb-4">
              <h2 class="text-lg font-medium text-primary">
                CRM
              </h2>
            </div>
            <!-- CRM Summary Cards -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
              <div class="bg-secondary rounded-lg p-4">
                <p class="text-xs text-muted">
                  Companies
                </p>
                <p
                  id="crmSummaryCompanies"
                  class="text-xl font-bold text-primary"
                >
                  0
                </p>
              </div>
              <div class="bg-secondary rounded-lg p-4">
                <p class="text-xs text-muted">Contacts</p>
                <p
                  id="crmSummaryContacts"
                  class="text-xl font-bold text-primary"
                >
                  0
                </p>
              </div>
              <div class="bg-secondary rounded-lg p-4">
                <p class="text-xs text-muted">
                  Open Deals
                </p>
                <p
                  id="crmSummaryDeals"
                  class="text-xl font-bold text-info"
                >
                  0
                </p>
              </div>
              <div class="bg-secondary rounded-lg p-4">
                <p class="text-xs text-muted">
                  Pipeline Value
                </p>
                <p
                  id="crmSummaryPipeline"
                  class="text-xl font-bold text-success"
                >
                  $0
                </p>
              </div>
            </div>
            <!-- CRM Tabs -->
            <nav class="view-tabs">
              <button data-crm-tab="companies" class="view-tab active">Companies</button>
              <button data-crm-tab="contacts" class="view-tab">Contacts</button>
              <button data-crm-tab="deals" class="view-tab">Deals</button>
              <button data-crm-tab="interactions" class="view-tab">Interactions</button>
            </nav>
          </div>
          <div class="p-6">
            <!-- Companies Tab -->
            <div id="companiesTab" class="crm-tab-content">
              <div class="flex justify-end mb-4">
                <button
                  id="addCRMCompanyBtn"
                  class="btn-primary py-2 rounded-lg"
                >
                  + Add Company
                </button>
              </div>
              <div id="emptyCompaniesState" class="text-center py-12 hidden">
                <svg
                  class="mx-auto h-12 w-12 text-muted"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"
                  />
                </svg>
                <h3
                  class="mt-2 text-sm font-medium text-primary"
                >
                  No companies yet
                </h3>
                <p class="mt-1 text-sm text-muted">
                  Add your first company to get started.
                </p>
              </div>
              <div
                id="companiesContainer"
                class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"
              >
              </div>
            </div>
            <!-- Contacts Tab -->
            <div id="contactsTab" class="crm-tab-content hidden">
              <div class="flex justify-end mb-4">
                <button
                  id="addCRMContactBtn"
                  class="btn-primary py-2 rounded-lg"
                >
                  + Add Contact
                </button>
              </div>
              <div id="emptyContactsState" class="text-center py-12 hidden">
                <svg
                  class="mx-auto h-12 w-12 text-muted"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"
                  />
                </svg>
                <h3
                  class="mt-2 text-sm font-medium text-primary"
                >
                  No contacts yet
                </h3>
                <p class="mt-1 text-sm text-muted">
                  Add contacts to your companies.
                </p>
              </div>
              <div
                id="contactsContainer"
                class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"
              >
              </div>
            </div>
            <!-- Deals Tab -->
            <div id="dealsTab" class="crm-tab-content hidden">
              <div class="flex justify-end mb-4">
                <button id="addCRMDealBtn" class="btn-primary py-2 rounded-lg">
                  + Add Deal
                </button>
              </div>
              <div id="emptyDealsState" class="text-center py-12 hidden">
                <svg
                  class="mx-auto h-12 w-12 text-muted"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                  />
                </svg>
                <h3
                  class="mt-2 text-sm font-medium text-primary"
                >
                  No deals yet
                </h3>
                <p class="mt-1 text-sm text-muted">
                  Track your sales pipeline here.
                </p>
              </div>
              <div
                id="dealsContainer"
                class="grid grid-cols-1 md:grid-cols-2 gap-4"
              >
              </div>
            </div>
            <!-- Interactions Tab -->
            <div id="interactionsTab" class="crm-tab-content hidden">
              <div class="flex justify-end mb-4">
                <button
                  id="addCRMInteractionBtn"
                  class="btn-primary py-2 rounded-lg"
                >
                  + Log Interaction
                </button>
              </div>
              <div id="emptyInteractionsState" class="text-center py-12 hidden">
                <svg
                  class="mx-auto h-12 w-12 text-muted"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"
                  />
                </svg>
                <h3
                  class="mt-2 text-sm font-medium text-primary"
                >
                  No interactions logged
                </h3>
                <p class="mt-1 text-sm text-muted">
                  Log calls, emails, and meetings with contacts.
                </p>
              </div>
              <div id="interactionsContainer" class="space-y-4"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Org Chart View -->
      <div id="orgchartView" class="hidden pb-16">
        <div class="mobile-notice">
          <svg width="32" height="32" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>
          <span>Org Chart requires a larger screen.</span>
        </div>
        <div class="bg-primary rounded-lg shadow">
          <div class="px-6 py-4 border-b border-default">
            <div class="flex justify-between items-center mb-4">
              <h2 class="text-lg font-medium text-primary">
                Org Chart
              </h2>
              <button
                id="addOrgchartMemberBtn"
                class="btn-primary py-2 rounded-lg"
              >
                + Add Member
              </button>
            </div>
            <!-- Summary Cards -->
            <div class="grid grid-cols-2 gap-4 mb-4">
              <div class="bg-secondary rounded-lg p-4">
                <p class="text-xs text-muted">
                  Team Members
                </p>
                <p
                  id="orgchartTotalMembers"
                  class="text-xl font-bold text-primary"
                >
                  0
                </p>
              </div>
              <div class="bg-secondary rounded-lg p-4">
                <p class="text-xs text-muted">
                  Departments
                </p>
                <p
                  id="orgchartTotalDepartments"
                  class="text-xl font-bold text-primary"
                >
                  0
                </p>
              </div>
            </div>
            <!-- Controls -->
            <div class="flex items-center gap-4 flex-wrap">
              <div class="flex items-center gap-2">
                <label class="text-sm text-secondary"
                >View:</label>
                <select
                  id="orgchartViewToggle"
                  class="text-sm border border-strong rounded px-2 py-1"
                >
                  <option value="tree">Tree</option>
                  <option value="card">Card</option>
                </select>
              </div>
              <div class="flex items-center gap-2">
                <label class="text-sm text-secondary"
                >Department:</label>
                <select
                  id="orgchartDepartmentFilter"
                  class="text-sm border border-strong rounded px-2 py-1"
                >
                  <option value="">All</option>
                </select>
              </div>
              <div class="flex items-center gap-2">
                <label class="text-sm text-secondary"
                >Zoom:</label>
                <input
                  type="range"
                  id="orgchartZoom"
                  min="0.5"
                  max="2"
                  step="0.1"
                  value="1"
                  class="w-24"
                >
                <span
                  id="orgchartZoomLevel"
                  class="text-sm text-secondary"
                >100%</span>
              </div>
              <div class="flex items-center gap-2 ml-auto">
                <button
                  id="orgchartExportPNG"
                  class="text-sm px-3 py-1 border border-strong rounded hover:bg-secondary text-secondary"
                  title="Export as SVG image"
                >
                  <svg
                    class="w-4 h-4 inline mr-1"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
                    />
                  </svg>
                  SVG
                </button>
                <button
                  id="orgchartExportPDF"
                  class="text-sm px-3 py-1 border border-strong rounded hover:bg-secondary text-secondary"
                  title="Export as PDF (print)"
                >
                  <svg
                    class="w-4 h-4 inline mr-1"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"
                    />
                  </svg>
                  PDF
                </button>
              </div>
            </div>
          </div>
          <div class="p-6">
            <div id="orgchartEmptyState" class="text-center py-12 hidden">
              <svg
                class="mx-auto h-12 w-12 text-muted"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"
                />
              </svg>
              <h3
                class="mt-2 text-sm font-medium text-primary"
              >
                No team members yet
              </h3>
              <p class="mt-1 text-sm text-muted">
                Add team members to build your org chart.
              </p>
            </div>
            <div
              id="orgchartContainer"
              class="relative overflow-hidden min-h-[400px]"
              style="cursor: grab"
            >
              <div
                id="orgchartViewport"
                class="origin-top-left transition-transform"
              >
                <div id="orgchartTreeContent"></div>
              </div>
            </div>
            <div id="orgchartUnlinkZone" class="orgchart-unlink-zone">
              Drop here to remove manager
            </div>
          </div>
        </div>
      </div>

      <!-- People Directory View -->
      <div id="peopleView" class="hidden pb-16">
        <div class="bg-primary rounded-lg shadow">
          <div class="px-6 py-4 border-b border-default">
            <div class="flex justify-between items-center mb-4">
              <h2 class="text-lg font-medium text-primary">
                People
              </h2>
              <button id="addPersonBtn" class="btn-primary py-2 rounded-lg">
                + Add Person
              </button>
            </div>
            <!-- Summary Stats -->
            <div class="people-summary-grid mb-4">
              <div class="people-stat-card">
                <div class="people-stat-label">Total People</div>
                <div id="peopleTotalCount" class="people-stat-value">0</div>
              </div>
              <div class="people-stat-card">
                <div class="people-stat-label">Departments</div>
                <div id="peopleDeptCount" class="people-stat-value">0</div>
              </div>
              <div class="people-stat-card">
                <div class="people-stat-label">Roles</div>
                <div id="peopleRolesCount" class="people-stat-value">0</div>
              </div>
            </div>
            <!-- Controls -->
            <div class="flex items-center gap-4 flex-wrap">
              <div class="people-search">
                <svg class="people-search-icon" width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                </svg>
                <input
                  type="text"
                  id="peopleSearchInput"
                  class="people-search-input"
                  placeholder="Search people..."
                >
              </div>
              <div id="peopleDepartmentFilters" class="people-filter-pills"></div>
            </div>
          </div>
          <div class="p-6">
            <div id="peopleEmptyState" class="people-empty-state">
              <svg width="48" height="48" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
              </svg>
              <div class="people-empty-title">No people yet</div>
              <div class="people-empty-text">Add people to build your team directory.</div>
            </div>
            <div id="peopleCardGrid" class="people-card-grid"></div>
          </div>
        </div>
      </div>

      <!-- CRM Company Modal -->
      <div
        id="crmCompanyModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3
              id="crmCompanyModalTitle"
              class="text-lg font-medium text-primary"
            >
              Add Company
            </h3>
          </div>
          <form id="crmCompanyForm">
            <div class="p-6 space-y-4">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Company Name *</label>
                <input
                  type="text"
                  id="crmCompanyName"
                  required
                  class="w-full border border-strong rounded-md px-3 py-2"
                >
              </div>
              <div class="grid grid-cols-2 gap-4">
                <div>
                  <label
                    class="block text-sm font-medium text-secondary mb-1"
                  >Industry</label>
                  <input
                    type="text"
                    id="crmCompanyIndustry"
                    class="w-full border border-strong rounded-md px-3 py-2"
                  >
                </div>
                <div>
                  <label
                    class="block text-sm font-medium text-secondary mb-1"
                  >Phone</label>
                  <input
                    type="tel"
                    id="crmCompanyPhone"
                    class="w-full border border-strong rounded-md px-3 py-2"
                  >
                </div>
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Website</label>
                <input
                  type="url"
                  id="crmCompanyWebsite"
                  class="w-full border border-strong rounded-md px-3 py-2"
                  placeholder="https://"
                >
              </div>
              <fieldset
                class="border border-strong rounded-md p-4"
              >
                <legend
                  class="text-sm font-medium text-secondary px-2"
                >
                  Address
                </legend>
                <div class="space-y-3">
                  <input
                    type="text"
                    id="crmCompanyStreet"
                    placeholder="Street"
                    class="w-full border border-strong rounded-md px-3 py-2"
                  >
                  <div class="grid grid-cols-2 gap-3">
                    <input
                      type="text"
                      id="crmCompanyCity"
                      placeholder="City"
                      class="border border-strong rounded-md px-3 py-2"
                    >
                    <input
                      type="text"
                      id="crmCompanyState"
                      placeholder="State/Province"
                      class="border border-strong rounded-md px-3 py-2"
                    >
                  </div>
                  <div class="grid grid-cols-2 gap-3">
                    <input
                      type="text"
                      id="crmCompanyPostalCode"
                      placeholder="Postal Code"
                      class="border border-strong rounded-md px-3 py-2"
                    >
                    <input
                      type="text"
                      id="crmCompanyCountry"
                      placeholder="Country"
                      class="border border-strong rounded-md px-3 py-2"
                    >
                  </div>
                </div>
              </fieldset>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Notes</label>
                <textarea
                  id="crmCompanyNotes"
                  rows="2"
                  class="w-full border border-strong rounded-md px-3 py-2"
                ></textarea>
              </div>
            </div>
            <div
              class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
            >
              <button
                type="button"
                id="cancelCRMCompanyBtn"
                class="btn-secondary py-2 rounded-md"
              >
                Cancel
              </button>
              <button type="submit" class="btn-primary py-2 rounded-md">
                Save
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- CRM Contact Modal -->
      <div
        id="crmContactModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3
              id="crmContactModalTitle"
              class="text-lg font-medium text-primary"
            >
              Add Contact
            </h3>
          </div>
          <form id="crmContactForm">
            <div class="p-6 space-y-4">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Company *</label>
                <select
                  id="crmContactCompany"
                  required
                  class="w-full border border-strong rounded-md px-3 py-2"
                >
                  <option value="">Select company...</option>
                </select>
              </div>
              <div class="grid grid-cols-2 gap-4">
                <div>
                  <label
                    class="block text-sm font-medium text-secondary mb-1"
                  >First Name *</label>
                  <input
                    type="text"
                    id="crmContactFirstName"
                    required
                    class="w-full border border-strong rounded-md px-3 py-2"
                  >
                </div>
                <div>
                  <label
                    class="block text-sm font-medium text-secondary mb-1"
                  >Last Name</label>
                  <input
                    type="text"
                    id="crmContactLastName"
                    class="w-full border border-strong rounded-md px-3 py-2"
                  >
                </div>
              </div>
              <div class="grid grid-cols-2 gap-4">
                <div>
                  <label
                    class="block text-sm font-medium text-secondary mb-1"
                  >Email</label>
                  <input
                    type="email"
                    id="crmContactEmail"
                    class="w-full border border-strong rounded-md px-3 py-2"
                  >
                </div>
                <div>
                  <label
                    class="block text-sm font-medium text-secondary mb-1"
                  >Phone</label>
                  <input
                    type="tel"
                    id="crmContactPhone"
                    class="w-full border border-strong rounded-md px-3 py-2"
                  >
                </div>
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Job Title</label>
                <input
                  type="text"
                  id="crmContactTitle"
                  class="w-full border border-strong rounded-md px-3 py-2"
                >
              </div>
              <div class="flex items-center">
                <input
                  type="checkbox"
                  id="crmContactPrimary"
                  class="w-4 h-4 text-info border-strong rounded focus:ring-1"
                >
                <label
                  for="crmContactPrimary"
                  class="ml-2 text-sm text-secondary"
                >Primary contact for company</label>
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Notes</label>
                <textarea
                  id="crmContactNotes"
                  rows="2"
                  class="w-full border border-strong rounded-md px-3 py-2"
                ></textarea>
              </div>
            </div>
            <div
              class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
            >
              <button
                type="button"
                id="cancelCRMContactBtn"
                class="btn-secondary py-2 rounded-md"
              >
                Cancel
              </button>
              <button type="submit" class="btn-primary py-2 rounded-md">
                Save
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- CRM Deal Modal -->
      <div
        id="crmDealModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3
              id="crmDealModalTitle"
              class="text-lg font-medium text-primary"
            >
              Add Deal
            </h3>
          </div>
          <form id="crmDealForm">
            <div class="p-6 space-y-4">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Deal Title *</label>
                <input
                  type="text"
                  id="crmDealTitle"
                  required
                  class="w-full border border-strong rounded-md px-3 py-2"
                >
              </div>
              <div class="grid grid-cols-2 gap-4">
                <div>
                  <label
                    class="block text-sm font-medium text-secondary mb-1"
                  >Company *</label>
                  <select
                    id="crmDealCompany"
                    required
                    class="w-full border border-strong rounded-md px-3 py-2"
                  >
                    <option value="">Select company...</option>
                  </select>
                </div>
                <div>
                  <label
                    class="block text-sm font-medium text-secondary mb-1"
                  >Contact</label>
                  <select
                    id="crmDealContact"
                    class="w-full border border-strong rounded-md px-3 py-2"
                  >
                    <option value="">Select contact...</option>
                  </select>
                </div>
              </div>
              <div class="grid grid-cols-2 gap-4">
                <div>
                  <label
                    class="block text-sm font-medium text-secondary mb-1"
                  >Value ($)</label>
                  <input
                    type="number"
                    id="crmDealValue"
                    min="0"
                    step="0.01"
                    class="w-full border border-strong rounded-md px-3 py-2"
                  >
                </div>
                <div>
                  <label
                    class="block text-sm font-medium text-secondary mb-1"
                  >Probability (%)</label>
                  <input
                    type="number"
                    id="crmDealProbability"
                    min="0"
                    max="100"
                    class="w-full border border-strong rounded-md px-3 py-2"
                  >
                </div>
              </div>
              <div class="grid grid-cols-2 gap-4">
                <div>
                  <label
                    class="block text-sm font-medium text-secondary mb-1"
                  >Stage</label>
                  <select
                    id="crmDealStage"
                    class="w-full border border-strong rounded-md px-3 py-2"
                  >
                    <option value="lead">Lead</option>
                    <option value="qualified">Qualified</option>
                    <option value="proposal">Proposal</option>
                    <option value="negotiation">Negotiation</option>
                    <option value="won">Won</option>
                    <option value="lost">Lost</option>
                  </select>
                </div>
                <div>
                  <label
                    class="block text-sm font-medium text-secondary mb-1"
                  >Expected Close</label>
                  <input
                    type="date"
                    id="crmDealExpectedClose"
                    class="w-full border border-strong rounded-md px-3 py-2"
                  >
                </div>
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Notes</label>
                <textarea
                  id="crmDealNotes"
                  rows="2"
                  class="w-full border border-strong rounded-md px-3 py-2"
                ></textarea>
              </div>
            </div>
            <div
              class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
            >
              <button
                type="button"
                id="cancelCRMDealBtn"
                class="btn-secondary py-2 rounded-md"
              >
                Cancel
              </button>
              <button type="submit" class="btn-primary py-2 rounded-md">
                Save
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- CRM Interaction Modal -->
      <div
        id="crmInteractionModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3
              id="crmInteractionModalTitle"
              class="text-lg font-medium text-primary"
            >
              Log Interaction
            </h3>
          </div>
          <form id="crmInteractionForm">
            <div class="p-6 space-y-4">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Type *</label>
                <select
                  id="crmInteractionType"
                  required
                  class="w-full border border-strong rounded-md px-3 py-2"
                >
                  <option value="note">Note</option>
                  <option value="email">Email</option>
                  <option value="call">Call</option>
                  <option value="meeting">Meeting</option>
                </select>
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Summary *</label>
                <input
                  type="text"
                  id="crmInteractionSummary"
                  required
                  class="w-full border border-strong rounded-md px-3 py-2"
                  placeholder="Brief description of interaction"
                >
              </div>
              <div class="grid grid-cols-2 gap-4">
                <div>
                  <label
                    class="block text-sm font-medium text-secondary mb-1"
                  >Company</label>
                  <select
                    id="crmInteractionCompany"
                    class="w-full border border-strong rounded-md px-3 py-2"
                  >
                    <option value="">Select company...</option>
                  </select>
                </div>
                <div>
                  <label
                    class="block text-sm font-medium text-secondary mb-1"
                  >Contact</label>
                  <select
                    id="crmInteractionContact"
                    class="w-full border border-strong rounded-md px-3 py-2"
                  >
                    <option value="">Select contact...</option>
                  </select>
                </div>
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Related Deal</label>
                <select
                  id="crmInteractionDeal"
                  class="w-full border border-strong rounded-md px-3 py-2"
                >
                  <option value="">Select deal...</option>
                </select>
              </div>
              <div class="grid grid-cols-2 gap-4">
                <div>
                  <label
                    class="block text-sm font-medium text-secondary mb-1"
                  >Date *</label>
                  <input
                    type="date"
                    id="crmInteractionDate"
                    required
                    class="w-full border border-strong rounded-md px-3 py-2"
                  >
                </div>
                <div>
                  <label
                    class="block text-sm font-medium text-secondary mb-1"
                  >Duration (min)</label>
                  <input
                    type="number"
                    id="crmInteractionDuration"
                    min="0"
                    class="w-full border border-strong rounded-md px-3 py-2"
                  >
                </div>
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Next Follow-up</label>
                <input
                  type="date"
                  id="crmInteractionFollowUp"
                  class="w-full border border-strong rounded-md px-3 py-2"
                >
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Notes</label>
                <textarea
                  id="crmInteractionNotes"
                  rows="3"
                  class="w-full border border-strong rounded-md px-3 py-2"
                ></textarea>
              </div>
            </div>
            <div
              class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
            >
              <button
                type="button"
                id="cancelCRMInteractionBtn"
                class="btn-secondary py-2 rounded-md"
              >
                Cancel
              </button>
              <button type="submit" class="btn-primary py-2 rounded-md">
                Save
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Customer Modal -->
      <div
        id="customerModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3
              id="customerModalTitle"
              class="text-lg font-medium text-primary"
            >
              Add Customer
            </h3>
          </div>
          <form id="customerForm">
            <div class="p-6 space-y-4">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Name *</label>
                <input
                  type="text"
                  id="customerName"
                  required
                  class="w-full border border-strong rounded-md px-3 py-2"
                >
              </div>
              <div class="grid grid-cols-2 gap-4">
                <div>
                  <label
                    class="block text-sm font-medium text-secondary mb-1"
                  >Email</label>
                  <input
                    type="email"
                    id="customerEmail"
                    class="w-full border border-strong rounded-md px-3 py-2"
                  >
                </div>
                <div>
                  <label
                    class="block text-sm font-medium text-secondary mb-1"
                  >Phone</label>
                  <input
                    type="tel"
                    id="customerPhone"
                    class="w-full border border-strong rounded-md px-3 py-2"
                  >
                </div>
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Company</label>
                <input
                  type="text"
                  id="customerCompany"
                  class="w-full border border-strong rounded-md px-3 py-2"
                >
              </div>
              <fieldset
                class="border border-strong rounded-md p-4"
              >
                <legend
                  class="text-sm font-medium text-secondary px-2"
                >
                  Billing Address
                </legend>
                <div class="space-y-3">
                  <input
                    type="text"
                    id="customerStreet"
                    placeholder="Street"
                    class="w-full border border-strong rounded-md px-3 py-2"
                  >
                  <div class="grid grid-cols-2 gap-3">
                    <input
                      type="text"
                      id="customerCity"
                      placeholder="City"
                      class="border border-strong rounded-md px-3 py-2"
                    >
                    <input
                      type="text"
                      id="customerState"
                      placeholder="State/Province"
                      class="border border-strong rounded-md px-3 py-2"
                    >
                  </div>
                  <div class="grid grid-cols-2 gap-3">
                    <input
                      type="text"
                      id="customerPostalCode"
                      placeholder="Postal Code"
                      class="border border-strong rounded-md px-3 py-2"
                    >
                    <input
                      type="text"
                      id="customerCountry"
                      placeholder="Country"
                      class="border border-strong rounded-md px-3 py-2"
                    >
                  </div>
                </div>
              </fieldset>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Notes</label>
                <textarea
                  id="customerNotes"
                  rows="2"
                  class="w-full border border-strong rounded-md px-3 py-2"
                ></textarea>
              </div>
            </div>
            <div
              class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
            >
              <button
                type="button"
                id="cancelCustomerBtn"
                class="btn-secondary py-2 rounded-md"
              >
                Cancel
              </button>
              <button type="submit" class="btn-primary py-2 rounded-md">
                Save
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Billing Rate Modal -->
      <div
        id="billingRateModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-md w-full mx-4"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3
              id="billingRateModalTitle"
              class="text-lg font-medium text-primary"
            >
              Add Billing Rate
            </h3>
          </div>
          <form id="billingRateForm">
            <div class="p-6 space-y-4">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Name *</label>
                <input
                  type="text"
                  id="billingRateName"
                  required
                  class="w-full border border-strong rounded-md px-3 py-2"
                  placeholder="e.g., Senior Developer"
                >
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Hourly Rate *</label>
                <input
                  type="number"
                  id="billingRateHourly"
                  required
                  step="0.01"
                  min="0"
                  class="w-full border border-strong rounded-md px-3 py-2"
                >
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Assignee</label>
                <input
                  type="text"
                  id="billingRateAssignee"
                  class="w-full border border-strong rounded-md px-3 py-2"
                  placeholder="Person this rate applies to"
                >
              </div>
              <div class="flex items-center">
                <input
                  type="checkbox"
                  id="billingRateDefault"
                  class="h-4 w-4 text-primary border-strong rounded"
                >
                <label
                  for="billingRateDefault"
                  class="ml-2 text-sm text-secondary"
                >Default rate</label>
              </div>
            </div>
            <div
              class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
            >
              <button
                type="button"
                id="cancelBillingRateBtn"
                class="btn-secondary py-2 rounded-md"
              >
                Cancel
              </button>
              <button type="submit" class="btn-primary py-2 rounded-md">
                Save
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Quote Modal -->
      <div
        id="quoteModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3
              id="quoteModalTitle"
              class="text-lg font-medium text-primary"
            >
              New Quote
            </h3>
          </div>
          <form id="quoteForm">
            <div class="p-6 space-y-4">
              <div class="grid grid-cols-2 gap-4">
                <div>
                  <label
                    class="block text-sm font-medium text-secondary mb-1"
                  >Title *</label>
                  <input
                    type="text"
                    id="quoteTitle"
                    required
                    class="w-full border border-strong rounded-md px-3 py-2"
                  >
                </div>
                <div>
                  <label
                    class="block text-sm font-medium text-secondary mb-1"
                  >Customer *</label>
                  <select
                    id="quoteCustomer"
                    required
                    class="w-full border border-strong rounded-md px-3 py-2"
                  >
                    <option value="">Select customer...</option>
                  </select>
                </div>
              </div>
              <div class="grid grid-cols-2 gap-4">
                <div>
                  <label
                    class="block text-sm font-medium text-secondary mb-1"
                  >Valid Until</label>
                  <input
                    type="date"
                    id="quoteValidUntil"
                    class="w-full border border-strong rounded-md px-3 py-2"
                  >
                </div>
                <div>
                  <label
                    class="block text-sm font-medium text-secondary mb-1"
                  >Tax Rate (%)</label>
                  <input
                    type="number"
                    id="quoteTaxRate"
                    step="0.01"
                    min="0"
                    class="w-full border border-strong rounded-md px-3 py-2"
                    value="0"
                  >
                </div>
              </div>
              <div>
                <div class="flex justify-between items-center mb-2">
                  <label
                    class="text-sm font-medium text-secondary"
                  >Line Items</label>
                  <button
                    type="button"
                    id="addQuoteLineBtn"
                    class="text-sm text-secondary hover:text-primary"
                  >
                    + Add Item
                  </button>
                </div>
                <div id="quoteLineItems" class="space-y-2"></div>
              </div>
              <div
                class="border-t border-default pt-4 space-y-2"
              >
                <div class="flex justify-between text-sm">
                  <span class="text-muted">Subtotal:</span><span
                    id="quoteSubtotal"
                    class="font-medium"
                  >$0.00</span>
                </div>
                <div class="flex justify-between text-sm">
                  <span class="text-muted">Tax:</span><span
                    id="quoteTax"
                    class="font-medium"
                  >$0.00</span>
                </div>
                <div class="flex justify-between text-base font-bold">
                  <span>Total:</span><span id="quoteTotal">$0.00</span>
                </div>
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Notes</label>
                <textarea
                  id="quoteNotes"
                  rows="2"
                  class="w-full border border-strong rounded-md px-3 py-2"
                ></textarea>
              </div>
            </div>
            <div
              class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
            >
              <button
                type="button"
                id="cancelQuoteBtn"
                class="btn-secondary py-2 rounded-md"
              >
                Cancel
              </button>
              <button type="submit" class="btn-primary py-2 rounded-md">
                Save
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Invoice Modal -->
      <div
        id="invoiceModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3
              id="invoiceModalTitle"
              class="text-lg font-medium text-primary"
            >
              New Invoice
            </h3>
          </div>
          <form id="invoiceForm">
            <div class="p-6 space-y-4">
              <div class="grid grid-cols-2 gap-4">
                <div>
                  <label
                    class="block text-sm font-medium text-secondary mb-1"
                  >Title *</label>
                  <input
                    type="text"
                    id="invoiceTitle"
                    required
                    class="w-full border border-strong rounded-md px-3 py-2"
                  >
                </div>
                <div>
                  <label
                    class="block text-sm font-medium text-secondary mb-1"
                  >Customer *</label>
                  <select
                    id="invoiceCustomer"
                    required
                    class="w-full border border-strong rounded-md px-3 py-2"
                  >
                    <option value="">Select customer...</option>
                  </select>
                </div>
              </div>
              <div class="grid grid-cols-2 gap-4">
                <div>
                  <label
                    class="block text-sm font-medium text-secondary mb-1"
                  >Due Date</label>
                  <input
                    type="date"
                    id="invoiceDueDate"
                    class="w-full border border-strong rounded-md px-3 py-2"
                  >
                </div>
                <div>
                  <label
                    class="block text-sm font-medium text-secondary mb-1"
                  >Tax Rate (%)</label>
                  <input
                    type="number"
                    id="invoiceTaxRate"
                    step="0.01"
                    min="0"
                    class="w-full border border-strong rounded-md px-3 py-2"
                    value="0"
                  >
                </div>
              </div>
              <div>
                <div class="flex justify-between items-center mb-2">
                  <label
                    class="text-sm font-medium text-secondary"
                  >Line Items</label>
                  <button
                    type="button"
                    id="addInvoiceLineBtn"
                    class="text-sm text-secondary hover:text-primary"
                  >
                    + Add Item
                  </button>
                </div>
                <div id="invoiceLineItems" class="space-y-2"></div>
              </div>
              <div
                class="border-t border-default pt-4 space-y-2"
              >
                <div class="flex justify-between text-sm">
                  <span class="text-muted">Subtotal:</span><span
                    id="invoiceSubtotal"
                    class="font-medium"
                  >$0.00</span>
                </div>
                <div class="flex justify-between text-sm">
                  <span class="text-muted">Tax:</span><span
                    id="invoiceTaxDisplay"
                    class="font-medium"
                  >$0.00</span>
                </div>
                <div class="flex justify-between text-base font-bold">
                  <span>Total:</span><span id="invoiceTotal">$0.00</span>
                </div>
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Notes</label>
                <textarea
                  id="invoiceNotes"
                  rows="2"
                  class="w-full border border-strong rounded-md px-3 py-2"
                ></textarea>
              </div>
            </div>
            <div
              class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
            >
              <button
                type="button"
                id="cancelInvoiceBtn"
                class="btn-secondary py-2 rounded-md"
              >
                Cancel
              </button>
              <button type="submit" class="btn-primary py-2 rounded-md">
                Save
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Generate Invoice Modal -->
      <div
        id="generateInvoiceModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3 class="text-lg font-medium text-primary">
              Generate Invoice from Time Entries
            </h3>
          </div>
          <form id="generateInvoiceForm">
            <div class="p-6 space-y-4">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Customer *</label>
                <select
                  id="generateInvoiceCustomer"
                  required
                  class="w-full border border-strong rounded-md px-3 py-2"
                >
                  <option value="">Select customer...</option>
                </select>
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Title</label>
                <input
                  type="text"
                  id="generateInvoiceTitle"
                  class="w-full border border-strong rounded-md px-3 py-2"
                  placeholder="Time Entry Invoice"
                >
              </div>
              <div class="grid grid-cols-2 gap-4">
                <div>
                  <label
                    class="block text-sm font-medium text-secondary mb-1"
                  >Start Date</label>
                  <input
                    type="date"
                    id="generateInvoiceStartDate"
                    class="w-full border border-strong rounded-md px-3 py-2"
                  >
                </div>
                <div>
                  <label
                    class="block text-sm font-medium text-secondary mb-1"
                  >End Date</label>
                  <input
                    type="date"
                    id="generateInvoiceEndDate"
                    class="w-full border border-strong rounded-md px-3 py-2"
                  >
                </div>
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Hourly Rate *</label>
                <input
                  type="number"
                  id="generateInvoiceRate"
                  required
                  step="0.01"
                  min="0"
                  class="w-full border border-strong rounded-md px-3 py-2"
                >
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-2"
                >Select Tasks *</label>
                <div
                  id="generateInvoiceTasks"
                  class="max-h-48 overflow-y-auto border border-strong rounded-md p-2 space-y-1"
                >
                </div>
              </div>
            </div>
            <div
              class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
            >
              <button
                type="button"
                id="cancelGenerateInvoiceBtn"
                class="btn-secondary py-2 rounded-md"
              >
                Cancel
              </button>
              <button type="submit" class="btn-primary py-2 rounded-md">
                Generate Invoice
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Payment Modal -->
      <div
        id="paymentModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-md w-full mx-4"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3 class="text-lg font-medium text-primary">
              Record Payment
            </h3>
          </div>
          <form id="paymentForm">
            <div class="p-6 space-y-4">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Amount *</label>
                <input
                  type="number"
                  id="paymentAmount"
                  required
                  step="0.01"
                  min="0"
                  class="w-full border border-strong rounded-md px-3 py-2"
                >
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Date *</label>
                <input
                  type="date"
                  id="paymentDate"
                  required
                  class="w-full border border-strong rounded-md px-3 py-2"
                >
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Method</label>
                <select
                  id="paymentMethod"
                  class="w-full border border-strong rounded-md px-3 py-2"
                >
                  <option value="">Select...</option>
                  <option value="bank">Bank Transfer</option>
                  <option value="card">Card</option>
                  <option value="cash">Cash</option>
                  <option value="other">Other</option>
                </select>
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Reference</label>
                <input
                  type="text"
                  id="paymentReference"
                  class="w-full border border-strong rounded-md px-3 py-2"
                  placeholder="Transaction ID, check number, etc."
                >
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Notes</label>
                <textarea
                  id="paymentNotes"
                  rows="2"
                  class="w-full border border-strong rounded-md px-3 py-2"
                ></textarea>
              </div>
            </div>
            <div
              class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
            >
              <button
                type="button"
                id="cancelPaymentBtn"
                class="btn-secondary py-2 rounded-md"
              >
                Cancel
              </button>
              <button type="submit" class="btn-primary py-2 rounded-md">
                Record Payment
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Strategic Levels Builder Modal -->
      <div
        id="strategicLevelsModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-md w-full mx-4"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3
              id="strategicLevelsModalTitle"
              class="text-lg font-medium text-primary"
            >
              New Strategy
            </h3>
          </div>
          <form id="strategicLevelsForm">
            <div class="p-6 space-y-4">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Title</label>
                <input
                  type="text"
                  id="strategicLevelsTitle"
                  required
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                  placeholder="e.g., Product Strategy 2026"
                >
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Date</label>
                <input
                  type="date"
                  id="strategicLevelsDate"
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                >
              </div>
            </div>
            <div
              class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
            >
              <button
                type="button"
                id="cancelStrategicLevelsBtn"
                class="btn-secondary py-2 rounded-md"
              >
                Cancel
              </button>
              <button type="submit" class="btn-primary py-2 rounded-md">
                Save
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Strategic Level Item Modal -->
      <div
        id="strategicLevelModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-md w-full mx-4"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3
              id="strategicLevelModalTitle"
              class="text-lg font-medium text-primary"
            >
              Add Level
            </h3>
          </div>
          <form id="strategicLevelForm">
            <div class="p-6 space-y-4">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Title</label>
                <input
                  type="text"
                  id="strategicLevelTitle"
                  required
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                  placeholder="e.g., Become market leader"
                >
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Description (optional)</label>
                <textarea
                  id="strategicLevelDescription"
                  rows="3"
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                  placeholder="Additional details..."
                ></textarea>
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Level Type</label>
                <select
                  id="strategicLevelType"
                  required
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                >
                  <option value="vision">Vision</option>
                  <option value="mission">Mission</option>
                  <option value="goals">Goals</option>
                  <option value="objectives">Objectives</option>
                  <option value="strategies">Strategies</option>
                  <option value="tactics">Tactics</option>
                </select>
              </div>
              <div id="strategicLevelParentGroup">
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Parent</label>
                <select
                  id="strategicLevelParent"
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1"
                >
                  <option value="">None (Root)</option>
                </select>
              </div>
            </div>
            <div
              class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
            >
              <button
                type="button"
                id="cancelStrategicLevelBtn"
                class="btn-secondary py-2 rounded-md"
              >
                Cancel
              </button>
              <button type="submit" class="btn-primary py-2 rounded-md">
                Save
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Strategic Level Link Modal -->
      <div
        id="strategicLinkModal"
        class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
      >
        <div
          class="bg-primary rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[80vh] flex flex-col"
        >
          <div class="px-6 py-4 border-b border-default">
            <h3
              id="strategicLinkModalTitle"
              class="text-lg font-medium text-primary"
            >
              Link Items
            </h3>
          </div>
          <div class="p-6 space-y-4 overflow-y-auto flex-1">
            <div>
              <h4
                class="text-sm font-medium text-secondary mb-2"
              >
                Tasks
              </h4>
              <div
                id="strategicLinkTasks"
                class="space-y-2 max-h-48 overflow-y-auto border border-default rounded-md p-2"
              >
                <!-- Task checkboxes will be rendered here -->
              </div>
            </div>
            <div>
              <h4
                class="text-sm font-medium text-secondary mb-2"
              >
                Milestones
              </h4>
              <div
                id="strategicLinkMilestones"
                class="space-y-2 max-h-48 overflow-y-auto border border-default rounded-md p-2"
              >
                <!-- Milestone checkboxes will be rendered here -->
              </div>
            </div>
          </div>
          <div
            class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
          >
            <button
              type="button"
              id="cancelStrategicLinkBtn"
              class="btn-secondary py-2 rounded-md"
            >
              Cancel
            </button>
            <button
              type="button"
              id="saveStrategicLinkBtn"
              class="btn-primary py-2 rounded-md"
            >
              Save Links
            </button>
          </div>
        </div>
      </div>

      <!-- Canvas View -->
      <div id="canvasView" class="hidden pb-16">
        <div class="mobile-notice">
          <svg width="32" height="32" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>
          <span>Canvas requires a larger screen.</span>
        </div>
        <div class="bg-primary rounded-lg shadow">
          <div
            class="px-6 py-4 border-b border-default flex justify-between items-center view-header"
          >
            <h2 class="text-lg font-medium text-primary">
              Canvas
            </h2>
            <div class="flex space-x-2">
              <button id="addStickyNoteBtn" class="btn-primary py-2 rounded-lg">
                + Add Sticky Note
              </button>
            </div>
          </div>

          <!-- Canvas Controls -->
          <div
            class="px-6 py-3 bg-secondary border-b border-default"
          >
            <div class="flex items-center space-x-4">
              <div class="flex items-center space-x-2">
                <label class="text-sm text-secondary"
                >Zoom:</label>
                <input
                  type="range"
                  id="canvasZoom"
                  min="0.25"
                  max="2"
                  step="0.25"
                  value="1"
                  class="w-20"
                >
                <span
                  id="zoomLevel"
                  class="text-sm text-secondary"
                >100%</span>
              </div>
            </div>
          </div>

          <!-- Canvas Container -->
          <div
            id="canvasContainer"
            class="relative overflow-hidden bg-secondary canvas-height"
          >
            <div id="canvasViewport" class="absolute inset-0 cursor-grab">
              <div id="canvasGrid" class="absolute inset-0 opacity-20 hidden">
                <!-- Grid pattern will be generated here -->
              </div>
              <div id="canvasContent" class="relative w-full h-full">
                <!-- Sticky notes will be positioned here -->
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Mindmap View -->
      <div id="mindmapView" class="hidden pb-16">
        <div class="mobile-notice">
          <svg width="32" height="32" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>
          <span>Mindmap requires a larger screen.</span>
        </div>
        <div class="bg-primary rounded-lg shadow">
          <div
            class="px-6 py-4 border-b border-default flex justify-between items-center view-header"
          >
            <h2 class="text-lg font-medium text-primary">
              Mindmap
            </h2>
            <div class="flex space-x-2">
              <select
                id="mindmapSelector"
                class="border border-strong rounded-md px-3 py-2 text-sm"
              >
                <option value="">Select Mindmap</option>
              </select>
              <button id="addMindmapBtn" class="btn-primary py-2 rounded-lg">
                + Add Mindmap
              </button>
              <button
                id="editMindmapBtn"
                class="bg-success text-white px-3 py-2 rounded-lg hover:bg-success transition-colors"
                style="display: none"
              >
                Edit
              </button>
              <button
                id="deleteMindmapBtn"
                class="btn-danger py-2 rounded-lg"
                style="display: none"
              >
                Delete
              </button>
            </div>
          </div>

          <!-- Mindmap Controls -->
          <div
            class="px-6 py-3 bg-secondary border-b border-default"
          >
            <div class="flex items-center space-x-4">
              <div class="flex items-center space-x-2">
                <label class="text-sm text-secondary"
                >Zoom:</label>
                <input
                  type="range"
                  id="mindmapZoom"
                  min="0.25"
                  max="2"
                  step="0.25"
                  value="1"
                  class="w-20"
                >
                <span
                  id="mindmapZoomLevel"
                  class="text-sm text-secondary"
                >100%</span>
              </div>
              <div class="flex items-center space-x-2">
                <label class="text-sm text-secondary"
                >Layout:</label>
                <select
                  id="mindmapLayout"
                  class="text-sm border border-strong rounded-md px-2 py-1"
                >
                  <option value="horizontal" selected>Left to Right</option>
                  <option value="vertical">Top to Bottom</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Mindmap Viewport -->
          <div>
              <div
                id="mindmapContainer"
                class="relative overflow-hidden bg-secondary canvas-height"
              >
                <div id="mindmapViewport" class="absolute inset-0 cursor-grab">
                  <div id="mindmapContent" class="relative w-full h-full">
                    <div
                      id="mindmapEmptyState"
                      class="flex items-center justify-center h-full"
                    >
                      <div class="text-center">
                        <svg
                          class="mx-auto h-12 w-12 text-muted"
                          fill="none"
                          viewBox="0 0 24 24"
                          stroke="currentColor"
                        >
                          <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"
                          />
                        </svg>
                        <h3
                          class="mt-2 text-sm font-medium text-primary"
                        >
                          No mindmap data
                        </h3>
                        <p class="mt-1 text-sm text-muted">
                          Add a Mindmap section with ul>li lists to your markdown.
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

          </div>
        </div>
      </div>

      <!-- C4 Architecture View -->
      <div id="c4View" class="hidden pb-16">
        <div class="mobile-notice">
          <svg width="32" height="32" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>
          <span>C4 Architecture requires a larger screen.</span>
        </div>
        <div class="bg-primary rounded-lg shadow">
          <div
            class="px-6 py-4 border-b border-default flex justify-between items-center view-header"
          >
            <div class="flex items-center space-x-4">
              <h2 class="text-lg font-medium text-primary">
                C4 Architecture
              </h2>
              <div
                id="c4Breadcrumb"
                class="flex items-center space-x-2 text-sm text-muted"
              >
                <!-- Breadcrumb will be populated here -->
              </div>
            </div>
            <div class="flex space-x-2">
              <button
                id="c4BackBtn"
                class="bg-inverse text-inverse px-4 py-2 rounded-lg hover:bg-active transition-colors hidden"
              >
                ← Back
              </button>
              <button id="c4AutoLayoutBtn" class="btn-primary py-2 rounded-lg">
                Auto Layout
              </button>
              <button
                id="addC4ComponentBtn"
                class="btn-primary py-2 rounded-lg"
              >
                + Add Component
              </button>
            </div>
          </div>

          <!-- C4 Controls -->
          <div
            class="px-6 py-3 bg-secondary border-b border-default"
          >
            <div class="flex items-center justify-between">
              <div class="flex items-center space-x-4">
                <div class="flex items-center space-x-2">
                  <label class="text-sm text-secondary"
                  >View:</label>
                  <select
                    id="c4ViewMode"
                    class="text-sm border border-strong rounded-md px-2 py-1"
                  >
                    <option value="diagram">Diagram</option>
                    <option value="list">List</option>
                  </select>
                </div>
                <div id="c4DiagramControls" class="flex items-center space-x-2">
                  <label class="text-sm text-secondary"
                  >Zoom:</label>
                  <input
                    type="range"
                    id="c4Zoom"
                    min="0.5"
                    max="2"
                    step="0.1"
                    value="1"
                    class="w-20"
                  >
                  <span
                    id="c4ZoomLevel"
                    class="text-sm text-secondary"
                  >100%</span>
                </div>
              </div>
              <div id="c4DiagramOptions" class="flex items-center space-x-4">
                <label
                  class="flex items-center space-x-2 text-sm text-secondary"
                >
                  <input type="checkbox" id="c4PhysicsToggle" class="rounded">
                  <span>Physics</span>
                </label>
                <div class="text-sm text-secondary">
                  Click components to drill down
                </div>
              </div>
            </div>
          </div>

          <!-- C4 Container -->
          <div
            id="c4Container"
            class="relative overflow-hidden bg-secondary canvas-height cursor-grab"
          >
            <div id="c4Viewport" class="absolute inset-0">
              <div id="c4Content" class="relative w-full h-full">
                <div
                  id="c4EmptyState"
                  class="h-full"
                >
                  <div class="flex items-center justify-center h-full">
                  <div class="text-center">
                    <svg
                      class="mx-auto h-12 w-12 text-muted"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 9a2 2 0 012-2m0 0V5a2 2 0 012 2v2M7 7h10"
                      />
                    </svg>
                    <h3
                      class="mt-2 text-sm font-medium text-primary"
                    >
                      No C4 components
                    </h3>
                    <p class="mt-1 text-sm text-muted">
                      Add components to start building your architecture
                      diagram.
                    </p>
                  </div>
                  </div>
                </div>
                <div id="c4ComponentsContainer" class="hidden">
                  <!-- C4 components will be rendered here -->
                </div>
                <!-- Connections canvas -->
                <svg
                  id="c4Connections"
                  class="absolute inset-0 pointer-events-none w-full h-full"
                  style="z-index: 1"
                >
                  <!-- Connection lines will be drawn here -->
                </svg>
              </div>
            </div>

            <!-- Reset View Button - Outside the viewport -->
            <button
              id="c4ResetViewBtn"
              class="absolute top-4 right-4 bg-inverse text-inverse p-2 rounded-full hover:bg-active transition-colors z-20"
              title="Reset View"
            >
              <svg
                class="w-4 h-4"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"
                >
                </path>
              </svg>
            </button>
          </div>

          <!-- C4 List View -->
          <div id="c4ListView" class="hidden p-6 max-h-[600px] overflow-y-auto">
            <div id="c4ListContent">
              <!-- List view will be rendered here -->
            </div>
          </div>
        </div>
      </div>

      <!-- Timeline View -->
      <div id="timelineView" class="hidden pb-16">
        <div class="mobile-notice">
          <svg width="32" height="32" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>
          <span>Timeline requires a larger screen.</span>
        </div>
        <!-- Timeline Configuration -->
        <div
          class="bg-primary rounded-lg shadow mb-6 p-4 sm:p-6"
        >
          <h2 class="text-lg font-medium text-primary mb-4">
            Timeline Settings
          </h2>
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <div>
              <label
                class="block text-sm font-medium text-secondary mb-1"
              >Project Start Date</label>
              <input
                type="date"
                id="timelineStartDate"
                class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                readonly
              >
              <p class="text-xs text-muted mt-1">
                Configure in Config tab
              </p>
            </div>
            <div>
              <label
                class="block text-sm font-medium text-secondary mb-1"
              >Working Days per Week</label>
              <select
                id="timelineWorkingDays"
                class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent bg-tertiary cursor-not-allowed"
                disabled
              >
                <option value="5">5 days (Mon-Fri)</option>
                <option value="6">6 days (Mon-Sat)</option>
                <option value="7">7 days (Mon-Sun)</option>
              </select>
              <p class="text-xs text-muted mt-1">
                Configure in Config tab
              </p>
            </div>
          </div>
        </div>

        <!-- Timeline Chart -->
        <div class="bg-primary rounded-lg shadow">
          <div class="px-6 py-4 border-b border-default">
            <h2 class="text-lg font-medium text-primary">
              Project Timeline
            </h2>
            <p class="text-sm text-muted mt-1">
              Tasks scheduled based on dependencies and effort
            </p>
          </div>

          <!-- Timeline Content -->
          <div class="p-6">
            <div id="timelineChart" class="overflow-x-auto">
              <div id="timelineContent" class="min-w-full">
                <!-- Timeline will be generated here -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Hidden File Input for CSV Import -->
    <input type="file" id="csvFileInput" accept=".csv" style="display: none">

    <!-- Hidden File Input for Markdown Import -->
    <input
      type="file"
      id="markdownFileInput"
      accept=".md,.markdown"
      style="display: none"
    >

    <!-- Auto-save Indicator -->
    <div id="autoSaveIndicator" class="auto-save-indicator">
      Auto-saved
    </div>

    <!-- Custom Section Modal -->
    <div
      id="customSectionModal"
      class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
    >
      <div
        class="bg-primary rounded-lg shadow-xl max-w-md w-full mx-4"
      >
        <div class="px-6 py-4 border-b border-default">
          <h3 class="text-lg font-medium text-primary">
            Add Custom Section
          </h3>
        </div>
        <div class="p-6">
          <div class="mb-4">
            <label
              class="block text-sm font-medium text-secondary mb-2"
            >Section Type</label>
            <select
              id="customSectionType"
              class="w-full border border-strong rounded-md px-3 py-2 bg-primary text-primary"
            >
              <option value="tabs">Tabs - Organize content in tabs</option>
              <option value="timeline">
                Timeline - Track progress with status
              </option>
              <option value="split-view">
                Split View - Multi-column layout
              </option>
            </select>
          </div>
          <div class="mb-4">
            <label
              class="block text-sm font-medium text-secondary mb-2"
            >Section Title</label>
            <input
              type="text"
              id="customSectionTitle"
              placeholder="Enter section title..."
              class="w-full border border-strong rounded-md px-3 py-2 bg-primary text-primary"
            >
          </div>
        </div>
        <div
          class="px-6 py-4 bg-secondary flex justify-end space-x-3"
        >
          <button
            id="cancelCustomSectionBtn"
            class="px-4 py-2 text-secondary hover:text-primary"
          >
            Cancel
          </button>
          <button
            id="createCustomSectionBtn"
            class="bg-info text-white px-4 py-2 rounded-lg hover:bg-info"
          >
            Create Section
          </button>
        </div>
      </div>
    </div>

    <!-- Note Modal -->
    <div
      id="noteModal"
      class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
    >
      <div
        class="bg-primary rounded-lg shadow-xl max-w-md w-full mx-4"
      >
        <div class="px-6 py-4 border-b border-default">
          <h3
            id="noteModalTitle"
            class="text-lg font-medium text-primary"
          >
            New Note
          </h3>
        </div>
        <form id="noteForm">
          <div class="p-6 space-y-4">
            <div>
              <label
                class="block text-sm font-medium text-secondary mb-1"
              >Title</label>
              <input
                type="text"
                id="noteTitle"
                required
                class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                placeholder="Enter note title..."
              >
            </div>
            <input type="hidden" id="noteContent" value="">

            <div class="p-3 bg-secondary rounded-lg">
              <div class="flex items-center gap-2 mb-2">
                <span
                  class="text-sm font-medium text-secondary"
                >Mode</span>
              </div>
              <div class="flex gap-2">
                <button
                  type="button"
                  id="noteModeBasic"
                  class="flex-1 px-3 py-2 text-sm font-medium rounded-md transition-colors bg-inverse text-inverse"
                >
                  Basic
                </button>
                <button
                  type="button"
                  id="noteModeEnhanced"
                  class="flex-1 px-3 py-2 text-sm font-medium rounded-md transition-colors bg-primary text-secondary border border-strong hover:bg-tertiary"
                >
                  Enhanced
                </button>
              </div>
              <p class="text-xs text-muted mt-2">
                Enhanced: structured blocks, timelines, custom sections
              </p>
            </div>
            <input type="hidden" id="noteEnhancedMode" value="">
          </div>

          <div
            class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary rounded-b-lg"
          >
            <button
              type="button"
              id="cancelNoteBtn"
              class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active transition-colors"
            >
              Cancel
            </button>
            <button
              type="submit"
              class="px-4 py-2 text-sm font-medium text-white bg-inverse rounded-md hover:bg-active transition-colors"
            >
              Create & Edit
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Goal Modal -->
    <div
      id="goalModal"
      class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
    >
      <div
        class="bg-primary rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] flex flex-col"
      >
        <div
          class="px-6 py-4 border-b border-default flex-shrink-0"
        >
          <h3
            id="goalModalTitle"
            class="text-lg font-medium text-primary"
          >
            Add Goal
          </h3>
        </div>
        <form id="goalForm" class="flex flex-col flex-1 overflow-hidden">
          <div class="p-6 space-y-4 overflow-y-auto flex-1">
            <div>
              <label
                class="block text-sm font-medium text-secondary mb-1"
              >Title</label>
              <input
                type="text"
                id="goalTitle"
                required
                class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
              >
            </div>

            <div class="grid grid-cols-2 gap-4">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Type</label>
                <select
                  id="goalType"
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                >
                  <option value="project">Project</option>
                  <option value="enterprise">Enterprise</option>
                </select>
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Status</label>
                <select
                  id="goalStatus"
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                >
                  <option value="planning">Planning</option>
                  <option value="on-track">On Track</option>
                  <option value="at-risk">At Risk</option>
                  <option value="late">Late</option>
                  <option value="success">Success</option>
                  <option value="failed">Failed</option>
                </select>
              </div>
            </div>

            <div>
              <label
                class="block text-sm font-medium text-secondary mb-1"
              >KPI (Key Performance Indicator)</label>
              <input
                type="text"
                id="goalKpi"
                required
                class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                placeholder="e.g., 25% increase in sales, 100% feature completion"
              >
            </div>

            <div class="grid grid-cols-2 gap-4">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Start Date</label>
                <input
                  type="date"
                  id="goalStartDate"
                  required
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                >
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >End Date</label>
                <input
                  type="date"
                  id="goalEndDate"
                  required
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                >
              </div>
            </div>

            <div>
              <label
                class="block text-sm font-medium text-secondary mb-1"
              >Description</label>
              <textarea
                id="goalDescription"
                rows="4"
                class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                placeholder="Describe the goal and what success looks like..."
              ></textarea>
            </div>
          </div>

          <div
            class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary flex-shrink-0"
          >
            <button
              type="button"
              id="cancelGoalBtn"
              class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active transition-colors"
            >
              Cancel
            </button>
            <button
              type="submit"
              class="px-4 py-2 text-sm font-medium text-white bg-inverse rounded-md hover:bg-active transition-colors"
            >
              Save Goal
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Milestone Modal -->
    <div
      id="milestoneModal"
      class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
    >
      <div
        class="bg-primary rounded-lg shadow-xl max-w-md w-full mx-4"
      >
        <div class="px-6 py-4 border-b border-default">
          <h3
            id="milestoneModalTitle"
            class="text-lg font-medium text-primary"
          >
            Add Milestone
          </h3>
        </div>
        <form id="milestoneForm">
          <div class="p-6 space-y-4">
            <div>
              <label
                class="block text-sm font-medium text-secondary mb-1"
              >Name</label>
              <input
                type="text"
                id="milestoneName"
                required
                class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
              >
            </div>
            <div>
              <label
                class="block text-sm font-medium text-secondary mb-1"
              >Target Date</label>
              <input
                type="date"
                id="milestoneTarget"
                class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
              >
            </div>
            <div>
              <label
                class="block text-sm font-medium text-secondary mb-1"
              >Status</label>
              <select
                id="milestoneStatus"
                class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
              >
                <option value="open">Open</option>
                <option value="completed">Completed</option>
              </select>
            </div>
            <div>
              <label
                class="block text-sm font-medium text-secondary mb-1"
              >Description</label>
              <textarea
                id="milestoneDescription"
                rows="3"
                class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
              ></textarea>
            </div>
          </div>
          <div
            class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
          >
            <button
              type="button"
              id="cancelMilestoneBtn"
              class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active transition-colors"
            >
              Cancel
            </button>
            <button
              type="submit"
              class="px-4 py-2 text-sm font-medium text-white bg-inverse rounded-md hover:bg-active transition-colors"
            >
              Save
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Idea Modal -->
    <div
      id="ideaModal"
      class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
    >
      <div
        class="bg-primary rounded-lg shadow-xl max-w-md w-full mx-4"
      >
        <div class="px-6 py-4 border-b border-default">
          <h3
            id="ideaModalTitle"
            class="text-lg font-medium text-primary"
          >
            Add Idea
          </h3>
        </div>
        <form id="ideaForm">
          <div class="p-6 space-y-4">
            <div>
              <label
                class="block text-sm font-medium text-secondary mb-1"
              >Title</label>
              <input
                type="text"
                id="ideaTitle"
                required
                class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
              >
            </div>
            <div class="grid grid-cols-2 gap-4">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Status</label>
                <select
                  id="ideaStatus"
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                >
                  <option value="new">New</option>
                  <option value="considering">Considering</option>
                  <option value="planned">Planned</option>
                  <option value="approved">Approved</option>
                  <option value="rejected">Rejected</option>
                </select>
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Category</label>
                <input
                  type="text"
                  id="ideaCategory"
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                  placeholder="e.g. feature, bug"
                >
              </div>
            </div>
            <div>
              <label
                class="block text-sm font-medium text-secondary mb-1"
              >Description</label>
              <textarea
                id="ideaDescription"
                rows="4"
                class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
              ></textarea>
            </div>
            <div id="ideaLinksSection" class="hidden">
              <label
                class="block text-sm font-medium text-secondary mb-1"
              >Linked Ideas</label>
              <div
                id="ideaLinksDisplay"
                class="flex flex-wrap gap-2 min-h-[32px] p-2 border border-strong rounded-md bg-secondary"
              >
              </div>
              <button
                type="button"
                id="openIdeaLinkPickerBtn"
                class="mt-2 text-sm text-secondary hover:text-primary"
              >
                + Add Links
              </button>
            </div>
          </div>
          <div
            class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
          >
            <button
              type="button"
              id="cancelIdeaBtn"
              class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active transition-colors"
            >
              Cancel
            </button>
            <button
              type="submit"
              class="px-4 py-2 text-sm font-medium text-white bg-inverse rounded-md hover:bg-active transition-colors"
            >
              Save
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Idea Link Picker Modal -->
    <div
      id="ideaLinkPickerModal"
      class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
    >
      <div
        class="bg-primary rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[80vh] flex flex-col"
      >
        <div class="px-6 py-4 border-b border-default">
          <h3 class="text-lg font-medium text-primary">
            Link Ideas (Zettelkasten)
          </h3>
          <input
            type="text"
            id="ideaLinkSearch"
            placeholder="Search ideas..."
            class="mt-2 w-full border border-strong rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-1"
          >
        </div>
        <div id="ideaLinkList" class="flex-1 overflow-y-auto p-4 space-y-2">
        </div>
        <div
          class="px-6 py-4 border-t border-default bg-secondary flex justify-end space-x-3"
        >
          <button
            type="button"
            id="cancelIdeaLinkPickerBtn"
            class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active"
          >
            Cancel
          </button>
          <button
            type="button"
            id="saveIdeaLinksBtn"
            class="px-4 py-2 text-sm font-medium text-white bg-inverse rounded-md hover:bg-active"
          >
            Save Links
          </button>
        </div>
      </div>
    </div>

    <!-- Retrospective Modal -->
    <div
      id="retrospectiveModal"
      class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
    >
      <div
        class="bg-primary rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] flex flex-col"
      >
        <div class="px-6 py-4 border-b border-default">
          <h3
            id="retrospectiveModalTitle"
            class="text-lg font-medium text-primary"
          >
            Add Retrospective
          </h3>
        </div>
        <form
          id="retrospectiveForm"
          class="flex flex-col flex-1 overflow-hidden"
        >
          <div class="p-6 space-y-4 overflow-y-auto flex-1">
            <div class="grid grid-cols-2 gap-4">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Title</label>
                <input
                  type="text"
                  id="retrospectiveTitle"
                  required
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                  placeholder="e.g., Sprint 1 Retrospective"
                >
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Date</label>
                <input
                  type="date"
                  id="retrospectiveDate"
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                >
              </div>
            </div>
            <div>
              <label
                class="block text-sm font-medium text-secondary mb-1"
              >Status</label>
              <select
                id="retrospectiveStatus"
                class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
              >
                <option value="open">Open</option>
                <option value="closed">Closed</option>
              </select>
            </div>
            <div>
              <label
                class="block text-sm font-medium text-success mb-1"
              >Continue (what went well)</label>
              <textarea
                id="retrospectiveContinue"
                rows="3"
                class="w-full border border-success-border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                placeholder="One item per line"
              ></textarea>
            </div>
            <div>
              <label
                class="block text-sm font-medium text-error-text mb-1"
              >Stop (what should stop)</label>
              <textarea
                id="retrospectiveStop"
                rows="3"
                class="w-full border border-error-border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                placeholder="One item per line"
              ></textarea>
            </div>
            <div>
              <label
                class="block text-sm font-medium text-secondary mb-1"
              >Start (what to start doing)</label>
              <textarea
                id="retrospectiveStart"
                rows="3"
                class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                placeholder="One item per line"
              ></textarea>
            </div>
          </div>
          <div
            class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary"
          >
            <button
              type="button"
              id="cancelRetrospectiveBtn"
              class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active transition-colors"
            >
              Cancel
            </button>
            <button
              type="submit"
              class="px-4 py-2 text-sm font-medium text-white bg-inverse rounded-md hover:bg-active transition-colors"
            >
              Save
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Mindmap Modal -->
    <div
      id="mindmapModal"
      class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
    >
      <div
        class="bg-primary rounded-lg shadow-xl max-w-3xl w-full mx-4 flex flex-col max-h-[90vh]"
      >
        <div
          class="px-6 py-4 border-b border-default flex-shrink-0"
        >
          <h3
            id="mindmapModalTitle"
            class="text-lg font-medium text-primary"
          >
            Add Mindmap
          </h3>
        </div>
        <form id="mindmapForm" class="flex flex-col flex-1 overflow-hidden">
          <div class="p-6 space-y-4 overflow-y-auto flex-1">
            <div>
              <label
                class="block text-sm font-medium text-secondary mb-1"
              >Title</label>
              <input
                type="text"
                id="mindmapTitle"
                required
                class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                placeholder="Enter mindmap title..."
              >
            </div>

            <div class="flex gap-4">
              <!-- Editor Panel -->
              <div class="flex-1">
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Structure</label>

                <!-- Toolbar -->
                <div
                  class="flex flex-wrap gap-1 mb-2 p-2 bg-secondary rounded-t-md border border-b-0 border-strong"
                >
                  <button
                    type="button"
                    id="mmAddRootBtn"
                    class="px-2 py-1 text-xs font-medium text-secondary bg-primary border border-strong rounded hover:bg-tertiary"
                    title="Add root node"
                  >
                    + Root
                  </button>
                  <button
                    type="button"
                    id="mmAddChildBtn"
                    class="px-2 py-1 text-xs font-medium text-secondary bg-primary border border-strong rounded hover:bg-tertiary"
                    title="Add child node (Tab)"
                  >
                    + Child
                  </button>
                  <button
                    type="button"
                    id="mmAddSiblingBtn"
                    class="px-2 py-1 text-xs font-medium text-secondary bg-primary border border-strong rounded hover:bg-tertiary"
                    title="Add sibling node (Enter)"
                  >
                    + Sibling
                  </button>
                  <div class="w-px bg-active mx-1"></div>
                  <button
                    type="button"
                    id="mmIndentBtn"
                    class="px-2 py-1 text-xs font-medium text-secondary bg-primary border border-strong rounded hover:bg-tertiary"
                    title="Indent (Tab)"
                  >
                    <svg
                      class="w-3 h-3"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M13 5l7 7-7 7M5 5l7 7-7 7"
                      />
                    </svg>
                  </button>
                  <button
                    type="button"
                    id="mmUnindentBtn"
                    class="px-2 py-1 text-xs font-medium text-secondary bg-primary border border-strong rounded hover:bg-tertiary"
                    title="Unindent (Shift+Tab)"
                  >
                    <svg
                      class="w-3 h-3"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M11 19l-7-7 7-7M19 19l-7-7 7-7"
                      />
                    </svg>
                  </button>
                  <div class="w-px bg-active mx-1"></div>
                  <button
                    type="button"
                    id="mmMoveUpBtn"
                    class="px-2 py-1 text-xs font-medium text-secondary bg-primary border border-strong rounded hover:bg-tertiary"
                    title="Move line up (Alt+Up)"
                  >
                    <svg
                      class="w-3 h-3"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M5 15l7-7 7 7"
                      />
                    </svg>
                  </button>
                  <button
                    type="button"
                    id="mmMoveDownBtn"
                    class="px-2 py-1 text-xs font-medium text-secondary bg-primary border border-strong rounded hover:bg-tertiary"
                    title="Move line down (Alt+Down)"
                  >
                    <svg
                      class="w-3 h-3"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M19 9l-7 7-7-7"
                      />
                    </svg>
                  </button>
                  <button
                    type="button"
                    id="mmDeleteLineBtn"
                    class="px-2 py-1 text-xs font-medium text-error bg-primary border border-strong rounded hover:bg-error-bg/20"
                    title="Delete current line"
                  >
                    <svg
                      class="w-3 h-3"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
                      />
                    </svg>
                  </button>
                </div>

                <textarea
                  id="mindmapStructure"
                  required
                  rows="10"
                  class="w-full border border-strong rounded-b-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent font-mono text-sm"
                  placeholder="- Main Topic&#10;  - Subtopic 1&#10;  - Subtopic 2&#10;    - Detail 1&#10;    - Detail 2"
                ></textarea>

                <!-- Keyboard shortcuts -->
                <div
                  class="mt-2 text-xs text-muted space-y-1"
                >
                  <div class="flex flex-wrap gap-x-4 gap-y-1">
                    <span><kbd
                        class="px-1 py-0.5 bg-tertiary rounded text-[10px]"
                      >Tab</kbd> Indent</span>
                    <span><kbd
                        class="px-1 py-0.5 bg-tertiary rounded text-[10px]"
                      >Shift+Tab</kbd> Unindent</span>
                    <span><kbd
                        class="px-1 py-0.5 bg-tertiary rounded text-[10px]"
                      >Enter</kbd> New sibling</span>
                    <span><kbd
                        class="px-1 py-0.5 bg-tertiary rounded text-[10px]"
                      >Alt+Up/Down</kbd> Move line</span>
                  </div>
                </div>
              </div>

              <!-- Preview Panel -->
              <div class="w-48 flex-shrink-0">
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Preview</label>
                <div
                  id="mindmapPreview"
                  class="h-64 border border-strong rounded-md bg-secondary p-2 overflow-auto text-xs"
                >
                  <div class="text-muted italic">
                    Enter structure to see preview
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div
            class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary flex-shrink-0"
          >
            <button
              type="button"
              id="cancelMindmapBtn"
              class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active transition-colors"
            >
              Cancel
            </button>
            <button
              type="submit"
              class="px-4 py-2 text-sm font-medium text-white bg-inverse rounded-md hover:bg-active transition-colors"
            >
              Save Mindmap
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Sticky Note Modal -->
    <div
      id="stickyNoteModal"
      class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
    >
      <div
        class="bg-primary rounded-lg shadow-xl max-w-md w-full mx-4 flex flex-col max-h-[90vh]"
      >
        <div
          class="px-6 py-4 border-b border-default flex-shrink-0"
        >
          <h3
            id="stickyNoteModalTitle"
            class="text-lg font-medium text-primary"
          >
            Add Sticky Note
          </h3>
        </div>
        <form id="stickyNoteForm" class="flex flex-col flex-1 overflow-hidden">
          <div class="p-6 space-y-4 overflow-y-auto flex-1">
            <div>
              <label
                class="block text-sm font-medium text-secondary mb-1"
              >Content</label>
              <textarea
                id="stickyNoteContent"
                required
                rows="4"
                class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                placeholder="Enter sticky note content..."
              ></textarea>
            </div>

            <div>
              <label
                class="block text-sm font-medium text-secondary mb-1"
              >Color</label>
              <div class="flex space-x-2">
                <button
                  type="button"
                  class="color-option w-8 h-8 rounded border-2 border-strong"
                  data-color="yellow"
                  style="background-color: #fef3c7"
                >
                </button>
                <button
                  type="button"
                  class="color-option w-8 h-8 rounded border-2 border-strong"
                  data-color="pink"
                  style="background-color: #fce7f3"
                >
                </button>
                <button
                  type="button"
                  class="color-option w-8 h-8 rounded border-2 border-strong"
                  data-color="blue"
                  style="background-color: #dbeafe"
                >
                </button>
                <button
                  type="button"
                  class="color-option w-8 h-8 rounded border-2 border-strong"
                  data-color="green"
                  style="background-color: #d1fae5"
                >
                </button>
                <button
                  type="button"
                  class="color-option w-8 h-8 rounded border-2 border-strong"
                  data-color="purple"
                  style="background-color: #e9d5ff"
                >
                </button>
                <button
                  type="button"
                  class="color-option w-8 h-8 rounded border-2 border-strong"
                  data-color="orange"
                  style="background-color: #fed7aa"
                >
                </button>
              </div>
            </div>
          </div>

          <div
            class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary flex-shrink-0"
          >
            <button
              type="button"
              id="cancelStickyNoteBtn"
              class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active transition-colors"
            >
              Cancel
            </button>
            <button
              type="submit"
              class="px-4 py-2 text-sm font-medium text-white bg-inverse rounded-md hover:bg-active transition-colors"
            >
              Add Sticky Note
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- C4 Component Modal -->
    <div
      id="c4ComponentModal"
      class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
    >
      <div
        class="bg-primary rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto"
      >
        <div class="px-6 py-4 border-b border-default">
          <h3
            id="c4ComponentModalTitle"
            class="text-lg font-medium text-primary"
          >
            Add C4 Component
          </h3>
          <div
            id="c4ComponentIdDisplay"
            class="text-xs text-muted mt-1 hidden"
          >
            ID: <span id="c4ComponentIdValue"></span>
          </div>
        </div>
        <form id="c4ComponentForm" class="p-6 space-y-4">
          <div>
            <label
              class="block text-sm font-medium text-secondary mb-1"
            >Component Name</label>
            <input
              type="text"
              id="c4ComponentName"
              required
              class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
              placeholder="e.g., Web Application, Database, API Gateway"
            >
          </div>

          <div class="grid grid-cols-3 gap-4">
            <div>
              <label
                class="block text-sm font-medium text-secondary mb-1"
              >Level</label>
              <select
                id="c4ComponentLevel"
                class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
              >
                <option value="context">Context</option>
                <option value="container">Container</option>
                <option value="component">Component</option>
                <option value="code">Code</option>
              </select>
            </div>
            <div>
              <label
                class="block text-sm font-medium text-secondary mb-1"
              >Type</label>
              <input
                type="text"
                id="c4ComponentType"
                class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                placeholder="e.g., System, Container, Component"
              >
            </div>
            <div>
              <label
                class="block text-sm font-medium text-secondary mb-1"
              >Technology</label>
              <input
                type="text"
                id="c4ComponentTechnology"
                class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                placeholder="e.g., React, PostgreSQL, Node.js"
              >
            </div>
          </div>

          <div>
            <label
              class="block text-sm font-medium text-secondary mb-1"
            >Description</label>
            <textarea
              id="c4ComponentDescription"
              rows="3"
              class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
              placeholder="Brief description of what this component does..."
            ></textarea>
          </div>

          <div class="grid grid-cols-2 gap-4">
            <div>
              <label
                class="block text-sm font-medium text-secondary mb-1"
              >X Position</label>
              <input
                type="number"
                id="c4ComponentX"
                value="100"
                class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
              >
            </div>
            <div>
              <label
                class="block text-sm font-medium text-secondary mb-1"
              >Y Position</label>
              <input
                type="number"
                id="c4ComponentY"
                value="100"
                class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
              >
            </div>
          </div>

          <div>
            <label
              class="block text-sm font-medium text-secondary mb-1"
            >Connections</label>
            <div class="space-y-2" id="c4ConnectionsForm">
              <div class="flex space-x-2">
                <div class="flex-1 relative">
                  <input
                    type="text"
                    placeholder="Target component name"
                    class="c4-target-input w-full border border-strong rounded-md px-3 py-2 text-sm"
                    autocomplete="off"
                  >
                  <div
                    class="c4-target-dropdown hidden absolute top-full left-0 right-0 bg-primary border border-strong rounded-b-md max-h-32 overflow-y-auto z-50"
                  >
                  </div>
                </div>
                <input
                  type="text"
                  placeholder="Relationship label"
                  class="flex-1 border border-strong rounded-md px-3 py-2 text-sm"
                >
                <button
                  type="button"
                  class="px-2 py-2 bg-error text-white rounded-md hover:bg-error text-sm"
                >
                  ×
                </button>
              </div>
            </div>
            <button
              type="button"
              id="addC4ConnectionBtn"
              class="mt-2 px-3 py-1 bg-success text-white rounded-md hover:bg-success text-sm"
            >
              + Add Connection
            </button>
          </div>

          <div class="flex justify-end space-x-3 pt-4">
            <button
              type="button"
              id="cancelC4ComponentBtn"
              class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active transition-colors"
            >
              Cancel
            </button>
            <button
              type="submit"
              class="px-4 py-2 text-sm font-medium text-white bg-inverse rounded-md hover:bg-active transition-colors"
            >
              Add Component
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Task Modal -->
    <div
      id="taskModal"
      class="fixed inset-0 bg-overlay hidden items-center justify-center z-50"
    >
      <div
        class="bg-primary rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] flex flex-col"
      >
        <div
          class="px-6 py-4 border-b border-default flex-shrink-0"
        >
          <h3
            id="modalTitle"
            class="text-lg font-medium text-primary"
          >
            Add Task
          </h3>
        </div>
        <form id="taskForm" class="flex flex-col flex-1 overflow-hidden">
          <div class="p-6 space-y-4 overflow-y-auto flex-1">
            <div>
              <label
                class="block text-sm font-medium text-secondary mb-1"
              >Title</label>
              <input
                type="text"
                id="taskTitle"
                required
                class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
              >
            </div>

            <div class="grid grid-cols-2 gap-4">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Section</label>
                <select
                  id="taskSection"
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                >
                  <!-- Options will be populated dynamically -->
                </select>
              </div>
              <div>
                <label
                  class="flex items-center text-sm font-medium text-secondary mb-1"
                >
                  Priority
                  <span
                    class="help-tip"
                    data-tip="P1 (red) = Critical/Blocker. P2 (orange) = High priority. P3 (yellow) = Normal. P4 (blue) = Low. P5 (gray) = Nice to have."
                  >?</span>
                </label>
                <select
                  id="taskPriority"
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                >
                  <option value="">Select Priority</option>
                  <option value="1">1 - Highest</option>
                  <option value="2">2 - High</option>
                  <option value="3">3 - Medium</option>
                  <option value="4">4 - Low</option>
                  <option value="5">5 - Lowest</option>
                </select>
              </div>
            </div>

            <div class="grid grid-cols-2 gap-4">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Assignee</label>
                <select
                  id="taskAssignee"
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                >
                  <option value="">Select Assignee</option>
                  <!-- Options will be populated dynamically -->
                </select>
              </div>
              <div>
                <label
                  class="flex items-center text-sm font-medium text-secondary mb-1"
                >
                  Effort (days)
                  <span
                    class="help-tip"
                    data-tip="Estimated working days to complete. Used for timeline calculations."
                  >?</span>
                </label>
                <input
                  type="number"
                  id="taskEffort"
                  min="1"
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                >
              </div>
            </div>

            <div>
              <label
                class="block text-sm font-medium text-secondary mb-1"
              >Due Date</label>
              <input
                type="datetime-local"
                id="taskDueDate"
                class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
              >
            </div>

            <div class="grid grid-cols-2 gap-4">
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Planned Start</label>
                <input
                  type="date"
                  id="taskPlannedStart"
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                >
              </div>
              <div>
                <label
                  class="block text-sm font-medium text-secondary mb-1"
                >Planned End</label>
                <input
                  type="date"
                  id="taskPlannedEnd"
                  class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                >
              </div>
            </div>

            <div
              id="timeEntriesSection"
              class="hidden border-t border-default pt-4 mt-4"
            >
              <div class="flex justify-between items-center mb-3">
                <label
                  class="block text-sm font-medium text-secondary"
                >Time Entries</label>
                <button
                  type="button"
                  id="addTimeEntryBtn"
                  class="text-sm text-primary hover:text-secondary underline"
                >
                  + Add Entry
                </button>
              </div>
              <div
                id="timeEntriesList"
                class="space-y-2 max-h-40 overflow-y-auto"
              >
              </div>
              <div
                id="addTimeEntryForm"
                class="hidden mt-3 p-3 bg-secondary rounded-md"
              >
                <div class="grid grid-cols-4 gap-2 mb-2">
                  <input
                    type="date"
                    id="timeEntryDate"
                    class="border border-strong rounded px-2 py-1 text-sm"
                  >
                  <input
                    type="number"
                    id="timeEntryHours"
                    step="0.5"
                    min="0"
                    placeholder="Hours"
                    class="border border-strong rounded px-2 py-1 text-sm"
                  >
                  <select
                    id="timeEntryPerson"
                    class="border border-strong rounded px-2 py-1 text-sm"
                  >
                    <option value="">-- Person --</option>
                  </select>
                  <input
                    type="text"
                    id="timeEntryDescription"
                    placeholder="Description"
                    class="border border-strong rounded px-2 py-1 text-sm"
                  >
                </div>
                <div class="flex justify-end gap-2">
                  <button
                    type="button"
                    id="cancelTimeEntryBtn"
                    class="text-xs text-muted hover:text-secondary"
                  >
                    Cancel
                  </button>
                  <button
                    type="button"
                    id="saveTimeEntryBtn"
                    class="text-xs text-primary hover:text-secondary underline"
                  >
                    Save
                  </button>
                </div>
              </div>
              <div
                id="totalHoursDisplay"
                class="mt-2 text-sm text-secondary"
              >
                Total: <span id="totalHoursValue">0</span>h logged
              </div>
            </div>

            <div>
              <label
                class="block text-sm font-medium text-secondary mb-1"
              >Milestone</label>
              <input
                type="text"
                id="taskMilestone"
                placeholder="e.g., v1.0, Sprint 2, Alpha"
                class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
              >
            </div>

            <div>
              <label
                class="block text-sm font-medium text-secondary mb-1"
              >Tags</label>
              <select
                id="taskTags"
                multiple
                class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                style="min-height: 80px"
              >
                <!-- Options will be populated dynamically -->
              </select>
            </div>

            <div>
              <label
                class="flex items-center text-sm font-medium text-secondary mb-1"
              >
                Blocked By
                <span
                  class="help-tip"
                  data-tip="Tasks that must be completed before this one can start. Used for timeline scheduling."
                >?</span>
              </label>
              <div class="space-y-2">
                <div class="relative">
                  <input
                    type="text"
                    id="taskBlockedBy"
                    placeholder="Type to search tasks..."
                    class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
                    autocomplete="off"
                  >
                  <div
                    id="dependencyDropdown"
                    class="absolute z-10 w-full bg-primary border border-strong rounded-md shadow-lg mt-1 max-h-48 overflow-y-auto hidden"
                  >
                    <!-- Autocomplete options will appear here -->
                  </div>
                </div>
                <div id="selectedDependencies" class="flex flex-wrap gap-2">
                  <!-- Selected dependencies will appear here as chips -->
                </div>
              </div>
            </div>

            <div>
              <label
                class="block text-sm font-medium text-secondary mb-1"
              >Description</label>
              <textarea
                id="taskDescription"
                rows="3"
                class="w-full border border-strong rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-1 focus:border-transparent"
              ></textarea>
            </div>
          </div>

          <div
            class="flex justify-end space-x-3 px-6 py-4 border-t border-default bg-secondary flex-shrink-0"
          >
            <button
              type="button"
              id="cancelBtn"
              class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active transition-colors"
            >
              Cancel
            </button>
            <button
              type="submit"
              class="px-4 py-2 text-sm font-medium text-white bg-inverse rounded-md hover:bg-active transition-colors"
            >
              Save Task
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Task Sidenav Panel -->
    <div id="taskSidenav" class="sidenav-panel sidenav-md">
      <div class="sidenav-header">
        <h2 id="sidenavTaskTitle" class="sidenav-title">Add Task</h2>
        <button
          type="button"
          id="sidenavTaskClose"
          class="sidenav-close"
          aria-label="Close"
        >
          <svg
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M6 18L18 6M6 6l12 12"
            >
            </path>
          </svg>
        </button>
      </div>
      <form id="sidenavTaskForm" class="flex flex-col flex-1 overflow-hidden">
        <div class="sidenav-content">
          <div class="sidenav-section">
            <div class="form-group">
              <label class="form-label">Title</label>
              <input
                type="text"
                id="sidenavTaskTitleInput"
                required
                class="form-input"
              >
            </div>
            <div class="form-group">
              <label class="form-label">Description</label>
              <textarea
                id="sidenavTaskDescription"
                rows="3"
                class="form-textarea"
              ></textarea>
              <div class="task-upload-row">
                <input
                  type="file"
                  id="sidenavFileInput"
                  class="task-file-input-hidden"
                  accept="image/*,.pdf,.txt,.md,.csv,.json"
                  multiple
                >
                <button
                  type="button"
                  id="sidenavAttachBtn"
                  class="btn-secondary"
                >
                  Attach file
                </button>
                <span id="sidenavUploadStatus" class="task-upload-status"></span>
              </div>
            </div>
          </div>

          <div class="sidenav-section">
            <div class="sidenav-section-title">Details</div>
            <div class="sidenav-grid">
              <div class="form-group">
                <label class="form-label">Section</label>
                <select id="sidenavTaskSection" class="form-select"></select>
              </div>
              <div class="form-group">
                <label class="form-label">Priority</label>
                <select id="sidenavTaskPriority" class="form-select">
                  <option value="">None</option>
                  <option value="1">P1 - Critical</option>
                  <option value="2">P2 - High</option>
                  <option value="3">P3 - Medium</option>
                  <option value="4">P4 - Low</option>
                  <option value="5">P5 - Minor</option>
                </select>
              </div>
            </div>
            <div class="sidenav-grid">
              <div class="form-group">
                <label class="form-label">Assignee</label>
                <select id="sidenavTaskAssignee" class="form-select"></select>
              </div>
              <div class="form-group">
                <label class="form-label">Effort (days)</label>
                <input
                  type="number"
                  id="sidenavTaskEffort"
                  min="1"
                  class="form-input"
                >
              </div>
            </div>
          </div>

          <div class="sidenav-section">
            <div class="sidenav-section-title">Schedule</div>
            <div class="form-group">
              <label class="form-label">Due Date</label>
              <input
                type="datetime-local"
                id="sidenavTaskDueDate"
                class="form-input"
              >
            </div>
            <div class="sidenav-grid">
              <div class="form-group">
                <label class="form-label">Planned Start</label>
                <input
                  type="date"
                  id="sidenavTaskPlannedStart"
                  class="form-input"
                >
              </div>
              <div class="form-group">
                <label class="form-label">Planned End</label>
                <input
                  type="date"
                  id="sidenavTaskPlannedEnd"
                  class="form-input"
                >
              </div>
            </div>
          </div>

          <div class="sidenav-section">
            <div class="sidenav-section-title">Organization</div>
            <div class="form-group">
              <label class="form-label">Milestone</label>
              <input
                type="text"
                id="sidenavTaskMilestone"
                list="milestonesList"
                placeholder="e.g., v1.0, Sprint 2"
                class="form-input"
                autocomplete="off"
              >
              <datalist id="milestonesList"></datalist>
            </div>
            <div class="form-group">
              <label class="form-label">Tags</label>
              <select
                id="sidenavTaskTags"
                multiple
                class="form-select"
                style="min-height: 80px"
              >
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Blocked By</label>
              <input
                type="text"
                id="sidenavTaskBlockedBy"
                placeholder="Search tasks..."
                class="form-input"
                autocomplete="off"
              >
              <div
                id="sidenavDependencyDropdown"
                class="absolute z-10 w-full bg-primary border border-strong rounded-md shadow-lg mt-1 max-h-48 overflow-y-auto hidden"
              >
              </div>
              <div
                id="sidenavSelectedDependencies"
                class="flex flex-wrap gap-2 mt-2"
              >
              </div>
            </div>
          </div>
        </div>

        <div class="sidenav-footer">
          <button
            type="button"
            id="sidenavTaskCancel"
            class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active"
          >
            Cancel
          </button>
          <button
            type="submit"
            class="px-4 py-2 text-sm font-medium text-white bg-inverse rounded-md hover:bg-active"
          >
            Save Task
          </button>
        </div>
      </form>
    </div>

    <!-- Note Sidenav Panel -->
    <div id="noteSidenav" class="sidenav-panel sidenav-md">
      <div class="sidenav-header">
        <h2 id="noteSidenavHeader" class="sidenav-title">New Note</h2>
        <div class="flex items-center gap-2">
          <span id="noteSidenavSaveStatus" class="text-xs hidden"></span>
          <button
            type="button"
            id="noteSidenavClose"
            class="sidenav-close"
            aria-label="Close"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              >
              </path>
            </svg>
          </button>
        </div>
      </div>
      <div class="sidenav-content">
        <div class="sidenav-section">
          <div class="form-group">
            <label class="form-label">Title</label>
            <input
              type="text"
              id="noteSidenavTitle"
              class="form-input"
              placeholder="Note title"
            >
          </div>
        </div>

        <div class="sidenav-section">
          <div class="sidenav-section-title">Mode</div>
          <div class="flex gap-2">
            <button
              type="button"
              id="noteSidenavModeBasic"
              class="px-4 py-2 text-sm font-medium rounded-md bg-inverse text-inverse"
            >
              Basic
            </button>
            <button
              type="button"
              id="noteSidenavModeEnhanced"
              class="px-4 py-2 text-sm font-medium rounded-md bg-primary text-secondary border border-strong"
            >
              Enhanced
            </button>
          </div>
        </div>

        <!-- Basic Editor -->
        <div id="noteSidenavBasicEditor" class="sidenav-section">
          <div class="form-group">
            <label class="form-label">Content</label>
            <textarea
              id="noteSidenavEditor"
              rows="15"
              class="form-textarea font-mono text-sm"
              placeholder="Write your note content here..."
            ></textarea>
          </div>
        </div>

        <!-- Enhanced Editor -->
        <div id="noteSidenavEnhancedEditor" class="sidenav-section hidden">
          <!-- Toolbar -->
          <div class="flex items-center justify-between mb-3 flex-wrap gap-2">
            <span class="text-sm font-medium text-secondary"
            >Paragraphs</span>
            <div class="flex flex-wrap gap-1">
              <button
                type="button"
                id="noteSidenavAddParagraph"
                class="px-2 py-1 text-xs font-medium bg-inverse text-inverse rounded hover:bg-active"
              >
                + Text
              </button>
              <button
                type="button"
                id="noteSidenavAddCode"
                class="px-2 py-1 text-xs font-medium bg-inverse text-inverse rounded hover:bg-inverse"
              >
                + Code
              </button>
              <button
                type="button"
                id="noteSidenavMultiSelect"
                class="px-2 py-1 text-xs font-medium bg-tertiary text-secondary rounded hover:bg-active"
                title="Multi-select mode"
              >
                Select
              </button>
              <button
                type="button"
                id="noteSidenavImportMd"
                class="px-2 py-1 text-xs font-medium bg-tertiary text-secondary rounded hover:bg-active"
                title="Import markdown file"
              >
                Import
              </button>
              <input
                type="file"
                id="noteSidenavFileInput"
                accept=".md,.txt"
                class="hidden"
              >
            </div>
          </div>

          <!-- Bulk Actions (hidden by default) -->
          <div
            id="noteSidenavBulkActions"
            class="hidden flex items-center gap-2 mb-3 p-2 bg-info-bg rounded-lg border border-info-border"
          >
            <span class="text-xs text-info"
            >Bulk:</span>
            <button
              type="button"
              id="noteSidenavMoveUp"
              class="px-2 py-1 text-xs bg-primary border border-info-border text-info rounded hover:bg-tertiary"
            >
              Move Up
            </button>
            <button
              type="button"
              id="noteSidenavMoveDown"
              class="px-2 py-1 text-xs bg-primary border border-info-border text-info rounded hover:bg-tertiary"
            >
              Move Down
            </button>
            <button
              type="button"
              id="noteSidenavBulkDelete"
              class="px-2 py-1 text-xs bg-error-bg/30 border border-error-border text-error-text rounded hover:bg-error-bg"
            >
              Delete
            </button>
          </div>

          <!-- Drop Zone -->
          <div
            id="noteSidenavDropZone"
            class="mb-3 p-4 border-2 border-dashed border-strong rounded-lg text-center text-sm text-muted hover:border-strong transition-colors"
          >
            Drop .md or .txt file here to import
          </div>

          <!-- Paragraphs Container -->
          <div id="noteSidenavParagraphs" class="space-y-3">
            <!-- Paragraphs rendered here -->
          </div>

          <!-- Custom Sections -->
          <div class="mt-4 pt-4 border-t border-default">
            <div class="flex items-center justify-between mb-3">
              <span
                class="text-sm font-medium text-info"
              >Custom Sections</span>
              <button
                type="button"
                id="noteSidenavAddSection"
                class="px-2 py-1 text-xs font-medium bg-tertiary/30 text-info rounded hover:bg-active"
              >
                + Section
              </button>
            </div>
            <div id="noteSidenavCustomSections">
              <!-- Custom sections rendered here -->
            </div>
          </div>
        </div>
      </div>
      <div class="sidenav-footer">
        <button
          type="button"
          id="noteSidenavDelete"
          class="px-4 py-2 text-sm font-medium text-error hover:text-error-text hidden"
        >
          Delete
        </button>
        <button
          type="button"
          id="noteSidenavFullEditor"
          class="px-3 py-2 text-xs font-medium text-secondary hover:text-primary"
          title="Open in full editor"
        >
          Full Editor
        </button>
        <div class="flex-1"></div>
        <button
          type="button"
          id="noteSidenavCancel"
          class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active"
        >
          Close
        </button>
      </div>
    </div>

    <!-- Goal Sidenav -->
    <div id="goalSidenav" class="sidenav-panel sidenav-md">
      <div class="sidenav-header">
        <h2 id="goalSidenavHeader" class="sidenav-title">New Goal</h2>
        <div class="flex items-center gap-2">
          <span id="goalSidenavSaveStatus" class="text-xs hidden"></span>
          <button
            type="button"
            id="goalSidenavClose"
            class="sidenav-close"
            aria-label="Close"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              >
              </path>
            </svg>
          </button>
        </div>
      </div>
      <form id="goalSidenavForm" class="flex flex-col flex-1 overflow-hidden">
        <div class="sidenav-content">
          <div class="sidenav-section">
            <div class="form-group">
              <label class="form-label">Title</label>
              <input
                type="text"
                id="goalSidenavTitle"
                required
                class="form-input"
              >
            </div>
            <div class="form-group">
              <label class="form-label">Description</label>
              <textarea
                id="goalSidenavDescription"
                rows="3"
                class="form-textarea"
              ></textarea>
            </div>
          </div>
          <div class="sidenav-section">
            <div class="sidenav-section-title">Details</div>
            <div class="sidenav-grid">
              <div class="form-group">
                <label class="form-label">Type</label>
                <select id="goalSidenavType" class="form-select">
                  <option value="project">Project</option>
                  <option value="enterprise">Enterprise</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">Status</label>
                <select id="goalSidenavStatus" class="form-select">
                  <option value="planning">Planning</option>
                  <option value="on-track">On Track</option>
                  <option value="at-risk">At Risk</option>
                  <option value="late">Late</option>
                  <option value="success">Success</option>
                  <option value="failed">Failed</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">KPI</label>
              <input
                type="text"
                id="goalSidenavKpi"
                class="form-input"
                placeholder="e.g., Revenue $1M"
              >
            </div>
            <div class="sidenav-grid">
              <div class="form-group">
                <label class="form-label">Start Date</label>
                <input type="date" id="goalSidenavStartDate" class="form-input">
              </div>
              <div class="form-group">
                <label class="form-label">End Date</label>
                <input type="date" id="goalSidenavEndDate" class="form-input">
              </div>
            </div>
          </div>
        </div>
        <div class="sidenav-footer">
          <button
            type="button"
            id="goalSidenavDelete"
            class="btn-danger-ghost hidden"
          >
            Delete
          </button>
          <div class="flex-1"></div>
          <button
            type="button"
            id="goalSidenavCancel"
            class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active"
          >
            Cancel
          </button>
          <button type="submit" class="btn btn-primary ml-2">Save</button>
        </div>
      </form>
    </div>

    <!-- Milestone Sidenav -->
    <div id="milestoneSidenav" class="sidenav-panel sidenav-md">
      <div class="sidenav-header">
        <h2 id="milestoneSidenavHeader" class="sidenav-title">New Milestone</h2>
        <div class="flex items-center gap-2">
          <span id="milestoneSidenavSaveStatus" class="text-xs hidden"></span>
          <button
            type="button"
            id="milestoneSidenavClose"
            class="sidenav-close"
            aria-label="Close"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              >
              </path>
            </svg>
          </button>
        </div>
      </div>
      <form
        id="milestoneSidenavForm"
        class="flex flex-col flex-1 overflow-hidden"
      >
        <div class="sidenav-content">
          <div class="sidenav-section">
            <div class="form-group">
              <label class="form-label">Name</label>
              <input
                type="text"
                id="milestoneSidenavName"
                required
                class="form-input"
              >
            </div>
            <div class="form-group">
              <label class="form-label">Description</label>
              <textarea
                id="milestoneSidenavDescription"
                rows="3"
                class="form-textarea"
              ></textarea>
            </div>
          </div>
          <div class="sidenav-section">
            <div class="sidenav-section-title">Details</div>
            <div class="sidenav-grid">
              <div class="form-group">
                <label class="form-label">Target Date</label>
                <input
                  type="date"
                  id="milestoneSidenavTarget"
                  class="form-input"
                >
              </div>
              <div class="form-group">
                <label class="form-label">Status</label>
                <select id="milestoneSidenavStatus" class="form-select">
                  <option value="pending">Pending</option>
                  <option value="in-progress">In Progress</option>
                  <option value="completed">Completed</option>
                </select>
              </div>
            </div>
          </div>
          <div id="milestoneSidenavProgress" class="sidenav-section hidden">
            <div class="sidenav-section-title">Progress</div>
            <div
              class="text-sm text-secondary mb-2"
              id="milestoneSidenavProgressText"
            >
              0/0 tasks (0%)
            </div>
            <div class="w-full bg-active rounded-full h-2">
              <div
                id="milestoneSidenavProgressBar"
                class="bg-inverse h-2 rounded-full"
                style="width: 0%"
              >
              </div>
            </div>
          </div>
        </div>
        <div class="sidenav-footer">
          <button
            type="button"
            id="milestoneSidenavDelete"
            class="btn-danger-ghost hidden"
          >
            Delete
          </button>
          <div class="flex-1"></div>
          <button
            type="button"
            id="milestoneSidenavCancel"
            class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active"
          >
            Cancel
          </button>
          <button type="submit" class="btn btn-primary ml-2">Save</button>
        </div>
      </form>
    </div>

    <!-- Retrospective Sidenav -->
    <div id="retroSidenav" class="sidenav-panel sidenav-lg">
      <div class="sidenav-header">
        <h2 id="retroSidenavHeader" class="sidenav-title">New Retrospective</h2>
        <div class="flex items-center gap-2">
          <span id="retroSidenavSaveStatus" class="text-xs hidden"></span>
          <button
            type="button"
            id="retroSidenavClose"
            class="sidenav-close"
            aria-label="Close"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              >
              </path>
            </svg>
          </button>
        </div>
      </div>
      <form id="retroSidenavForm" class="flex flex-col flex-1 overflow-hidden">
        <div class="sidenav-content">
          <div class="sidenav-section">
            <div class="form-group">
              <label class="form-label">Title</label>
              <input
                type="text"
                id="retroSidenavTitle"
                required
                class="form-input"
                placeholder="e.g., Sprint 5 Retrospective"
              >
            </div>
            <div class="sidenav-grid">
              <div class="form-group">
                <label class="form-label">Date</label>
                <input type="date" id="retroSidenavDate" class="form-input">
              </div>
              <div class="form-group">
                <label class="form-label">Status</label>
                <select id="retroSidenavStatus" class="form-select">
                  <option value="open">Open</option>
                  <option value="closed">Closed</option>
                </select>
              </div>
            </div>
          </div>
          <div class="sidenav-section">
            <div class="sidenav-section-title">Continue (What went well)</div>
            <textarea
              id="retroSidenavContinue"
              rows="4"
              class="form-textarea"
              placeholder="One item per line"
            ></textarea>
          </div>
          <div class="sidenav-section">
            <div class="sidenav-section-title">Stop (What to improve)</div>
            <textarea
              id="retroSidenavStop"
              rows="4"
              class="form-textarea"
              placeholder="One item per line"
            ></textarea>
          </div>
          <div class="sidenav-section">
            <div class="sidenav-section-title">Start (New ideas)</div>
            <textarea
              id="retroSidenavStart"
              rows="4"
              class="form-textarea"
              placeholder="One item per line"
            ></textarea>
          </div>
        </div>
        <div class="sidenav-footer">
          <button
            type="button"
            id="retroSidenavDelete"
            class="btn-danger-ghost hidden"
          >
            Delete
          </button>
          <div class="flex-1"></div>
          <button
            type="button"
            id="retroSidenavCancel"
            class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active"
          >
            Cancel
          </button>
          <button type="submit" class="btn btn-primary ml-2">Save</button>
        </div>
      </form>
    </div>

    <!-- Mindmap Sidenav -->
    <div id="mindmapSidenav" class="sidenav-panel sidenav-lg">
      <div class="sidenav-header">
        <h2 id="mindmapSidenavHeader" class="sidenav-title">New Mindmap</h2>
        <div class="flex items-center gap-2">
          <span id="mindmapSidenavSaveStatus" class="text-xs hidden"></span>
          <button
            type="button"
            id="mindmapSidenavClose"
            class="sidenav-close"
            aria-label="Close"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              >
              </path>
            </svg>
          </button>
        </div>
      </div>
      <form
        id="mindmapSidenavForm"
        class="flex flex-col flex-1 overflow-hidden"
      >
        <div class="sidenav-content">
          <div class="sidenav-section">
            <div class="form-group">
              <label class="form-label">Title</label>
              <input
                type="text"
                id="mindmapSidenavTitle"
                required
                class="form-input"
              >
            </div>
          </div>
          <div class="sidenav-section">
            <div class="sidenav-section-title">Structure</div>
            <div class="flex flex-wrap gap-1 mb-2">
              <button
                type="button"
                id="mmSidenavAddRoot"
                class="px-2 py-1 text-xs bg-tertiary rounded hover:bg-active"
              >
                + Root
              </button>
              <button
                type="button"
                id="mmSidenavAddChild"
                class="px-2 py-1 text-xs bg-tertiary rounded hover:bg-active"
              >
                + Child
              </button>
              <button
                type="button"
                id="mmSidenavAddSibling"
                class="px-2 py-1 text-xs bg-tertiary rounded hover:bg-active"
              >
                + Sibling
              </button>
              <button
                type="button"
                id="mmSidenavIndent"
                class="px-2 py-1 text-xs bg-tertiary rounded hover:bg-active"
              >
                Indent
              </button>
              <button
                type="button"
                id="mmSidenavUnindent"
                class="px-2 py-1 text-xs bg-tertiary rounded hover:bg-active"
              >
                Unindent
              </button>
              <button
                type="button"
                id="mmSidenavMoveUp"
                class="px-2 py-1 text-xs bg-tertiary rounded hover:bg-active"
              >
                Up
              </button>
              <button
                type="button"
                id="mmSidenavMoveDown"
                class="px-2 py-1 text-xs bg-tertiary rounded hover:bg-active"
              >
                Down
              </button>
              <button
                type="button"
                id="mmSidenavDeleteLine"
                class="px-2 py-1 text-xs bg-error-bg text-error-text rounded hover:bg-error-bg"
              >
                Delete
              </button>
            </div>
            <textarea
              id="mindmapSidenavStructure"
              rows="10"
              class="form-textarea font-mono text-sm"
              placeholder="- Root Node&#10;  - Child 1&#10;    - Grandchild&#10;  - Child 2"
            ></textarea>
          </div>
          <div class="sidenav-section">
            <div class="sidenav-section-title">Preview</div>
            <div
              id="mindmapSidenavPreview"
              class="p-3 bg-secondary rounded-lg border border-default max-h-48 overflow-auto text-sm"
            >
              <div class="text-muted italic">
                Enter structure to see preview
              </div>
            </div>
          </div>
        </div>
        <div class="sidenav-footer">
          <button
            type="button"
            id="mindmapSidenavDelete"
            class="btn-danger-ghost hidden"
          >
            Delete
          </button>
          <div class="flex-1"></div>
          <button
            type="button"
            id="mindmapSidenavCancel"
            class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active"
          >
            Cancel
          </button>
          <button type="submit" class="btn btn-primary ml-2">Save</button>
        </div>
      </form>
    </div>

    <!-- Sticky Note Sidenav -->
    <div id="stickySidenav" class="sidenav-panel sidenav-sm">
      <div class="sidenav-header">
        <h2 id="stickySidenavHeader" class="sidenav-title">New Sticky Note</h2>
        <div class="flex items-center gap-2">
          <span id="stickySidenavSaveStatus" class="text-xs hidden"></span>
          <button
            type="button"
            id="stickySidenavClose"
            class="sidenav-close"
            aria-label="Close"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              >
              </path>
            </svg>
          </button>
        </div>
      </div>
      <form id="stickySidenavForm" class="flex flex-col flex-1 overflow-hidden">
        <div class="sidenav-content">
          <div class="sidenav-section">
            <div class="form-group">
              <label class="form-label">Content</label>
              <textarea
                id="stickySidenavContent"
                rows="6"
                required
                class="form-textarea"
                placeholder="Enter sticky note content..."
              ></textarea>
            </div>
          </div>
          <div class="sidenav-section">
            <div class="sidenav-section-title">Color</div>
            <div class="flex gap-2 flex-wrap">
              <button
                type="button"
                class="color-option w-8 h-8 rounded-full bg-warning-bg ring-2 ring-offset-2 ring-2 selected"
                data-color="yellow"
              >
              </button>
              <button
                type="button"
                class="color-option w-8 h-8 rounded-full" style="background-color: #fbcfe8"
                data-color="pink"
              >
              </button>
              <button
                type="button"
                class="color-option w-8 h-8 rounded-full bg-info-bg"
                data-color="blue"
              >
              </button>
              <button
                type="button"
                class="color-option w-8 h-8 rounded-full bg-success-bg"
                data-color="green"
              >
              </button>
              <button
                type="button"
                class="color-option w-8 h-8 rounded-full bg-active"
                data-color="purple"
              >
              </button>
              <button
                type="button"
                class="color-option w-8 h-8 rounded-full bg-warning-bg"
                data-color="orange"
              >
              </button>
            </div>
          </div>
        </div>
        <div class="sidenav-footer">
          <button
            type="button"
            id="stickySidenavDelete"
            class="btn-danger-ghost hidden"
          >
            Delete
          </button>
          <div class="flex-1"></div>
          <button
            type="button"
            id="stickySidenavCancel"
            class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active"
          >
            Cancel
          </button>
          <button type="submit" class="btn btn-primary ml-2">Save</button>
        </div>
      </form>
    </div>

    <!-- Fundraising — SAFE Agreement Sidenav -->
    <div id="safe-sidenav" class="sidenav-panel sidenav-lg">
      <div class="sidenav-header">
        <h2 id="safe-sidenav-header" class="sidenav-title">New SAFE Agreement</h2>
        <div class="flex items-center gap-2">
          <span id="safe-sidenav-status" class="text-xs hidden"></span>
          <button type="button" id="safe-sidenav-close" class="sidenav-close" aria-label="Close">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>
      </div>
      <div class="flex flex-col flex-1 overflow-hidden">
        <div class="sidenav-content">
          <div class="sidenav-section">
            <div class="form-group">
              <label class="form-label">Investor Name</label>
              <input type="text" id="safe-sidenav-investor" class="form-input" placeholder="e.g. Jane Smith">
            </div>
            <div class="form-group">
              <label class="form-label">Amount ($)</label>
              <input type="number" id="safe-sidenav-amount" class="form-input" placeholder="e.g. 500000" min="0">
            </div>
            <div class="form-group">
              <label class="form-label">Valuation Cap ($)</label>
              <input type="number" id="safe-sidenav-valuation_cap" class="form-input" placeholder="e.g. 5000000" min="0">
            </div>
            <div class="form-group">
              <label class="form-label">Discount (%)</label>
              <input type="number" id="safe-sidenav-discount" class="form-input" placeholder="e.g. 20" min="0" max="100">
            </div>
            <div class="form-group">
              <label class="form-label">Type</label>
              <select id="safe-sidenav-type" class="form-input">
                <option value="post-money">Post-Money</option>
                <option value="pre-money">Pre-Money</option>
                <option value="mfn">MFN</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Date</label>
              <input type="date" id="safe-sidenav-date" class="form-input">
            </div>
            <div class="form-group">
              <label class="form-label">Status</label>
              <select id="safe-sidenav-status" class="form-input">
                <option value="draft">Draft</option>
                <option value="signed">Signed</option>
                <option value="converted">Converted</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Notes</label>
              <textarea id="safe-sidenav-notes" class="form-input" rows="3"></textarea>
            </div>
          </div>
        </div>
        <div class="sidenav-footer">
          <button type="button" id="safe-sidenav-delete" class="btn-danger-ghost hidden">Delete</button>
          <div class="flex-1"></div>
          <button type="button" id="safe-sidenav-cancel" class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active">Cancel</button>
          <button type="button" id="safe-sidenav-save" class="btn">Save</button>
        </div>
      </div>
    </div>

    <!-- Fundraising — Investor Pipeline Sidenav -->
    <div id="pipeline-sidenav" class="sidenav-panel sidenav-lg">
      <div class="sidenav-header">
        <h2 id="pipeline-sidenav-header" class="sidenav-title">New Investor</h2>
        <div class="flex items-center gap-2">
          <span id="pipeline-sidenav-status" class="text-xs hidden"></span>
          <button type="button" id="pipeline-sidenav-close" class="sidenav-close" aria-label="Close">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>
      </div>
      <div class="flex flex-col flex-1 overflow-hidden">
        <div class="sidenav-content">
          <div class="sidenav-section">
            <div class="form-group">
              <label class="form-label">Name</label>
              <input type="text" id="pipeline-sidenav-name" class="form-input" placeholder="e.g. Sequoia Capital">
            </div>
            <div class="form-group">
              <label class="form-label">Type</label>
              <select id="pipeline-sidenav-type" class="form-input">
                <option value="vc">VC</option>
                <option value="angel">Angel</option>
                <option value="family_office">Family Office</option>
                <option value="corporate">Corporate</option>
                <option value="accelerator">Accelerator</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Stage</label>
              <select id="pipeline-sidenav-stage" class="form-input">
                <option value="lead">Lead</option>
                <option value="associate">Associate</option>
                <option value="partner">Partner</option>
                <option value="passed">Passed</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Status</label>
              <select id="pipeline-sidenav-status" class="form-input">
                <option value="not_started">Not Started</option>
                <option value="in_progress">In Progress</option>
                <option value="term_sheet">Term Sheet</option>
                <option value="passed">Passed</option>
                <option value="invested">Invested</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Target Amount ($)</label>
              <input type="number" id="pipeline-sidenav-amount_target" class="form-input" placeholder="e.g. 1000000" min="0">
            </div>
            <div class="form-group">
              <label class="form-label">Contact Email</label>
              <input type="email" id="pipeline-sidenav-contact" class="form-input" placeholder="e.g. partner@firm.com">
            </div>
            <div class="form-group">
              <label class="form-label">Intro Date</label>
              <input type="date" id="pipeline-sidenav-intro_date" class="form-input">
            </div>
            <div class="form-group">
              <label class="form-label">Last Contact</label>
              <input type="date" id="pipeline-sidenav-last_contact" class="form-input">
            </div>
            <div class="form-group">
              <label class="form-label">Notes</label>
              <textarea id="pipeline-sidenav-notes" class="form-input" rows="3"></textarea>
            </div>
          </div>
        </div>
        <div class="sidenav-footer">
          <button type="button" id="pipeline-sidenav-delete" class="btn-danger-ghost hidden">Delete</button>
          <div class="flex-1"></div>
          <button type="button" id="pipeline-sidenav-cancel" class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active">Cancel</button>
          <button type="button" id="pipeline-sidenav-save" class="btn">Save</button>
        </div>
      </div>
    </div>

    <!-- Fundraising — KPI Snapshot Sidenav -->
    <div id="kpi-sidenav" class="sidenav-panel sidenav-lg">
      <div class="sidenav-header">
        <h2 id="kpi-sidenav-header" class="sidenav-title">New KPI Period</h2>
        <div class="flex items-center gap-2">
          <span id="kpi-sidenav-status" class="text-xs hidden"></span>
          <button type="button" id="kpi-sidenav-close" class="sidenav-close" aria-label="Close">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>
      </div>
      <div class="flex flex-col flex-1 overflow-hidden">
        <div class="sidenav-content">
          <div class="sidenav-section">
            <div class="form-group">
              <label class="form-label">Period (YYYY-MM)</label>
              <input type="text" id="kpi-sidenav-period" class="form-input" placeholder="e.g. 2026-02" pattern="\d{4}-\d{2}">
            </div>
            <div class="form-group">
              <label class="form-label">MRR ($)</label>
              <input type="number" id="kpi-sidenav-mrr" class="form-input" placeholder="Monthly Recurring Revenue" min="0">
              <p id="kpi-sidenav-arr-preview" class="kpi-arr-preview">ARR: —</p>
            </div>
            <div class="form-group">
              <label class="form-label">Churn Rate (%)</label>
              <input type="number" id="kpi-sidenav-churn_rate" class="form-input" placeholder="e.g. 2.5" min="0" step="0.1">
            </div>
            <div class="form-group">
              <label class="form-label">LTV ($)</label>
              <input type="number" id="kpi-sidenav-ltv" class="form-input" placeholder="Customer Lifetime Value" min="0">
            </div>
            <div class="form-group">
              <label class="form-label">CAC ($)</label>
              <input type="number" id="kpi-sidenav-cac" class="form-input" placeholder="Customer Acquisition Cost" min="0">
            </div>
            <div class="form-group">
              <label class="form-label">MoM Growth Rate (%)</label>
              <input type="number" id="kpi-sidenav-growth_rate" class="form-input" placeholder="e.g. 15" step="0.1">
            </div>
            <div class="form-group">
              <label class="form-label">Active Users</label>
              <input type="number" id="kpi-sidenav-active_users" class="form-input" placeholder="e.g. 1200" min="0">
            </div>
            <div class="form-group">
              <label class="form-label">NRR — Net Revenue Retention (%)</label>
              <input type="number" id="kpi-sidenav-nrr" class="form-input" placeholder="e.g. 110" min="0" step="0.1">
            </div>
            <div class="form-group">
              <label class="form-label">Gross Margin (%)</label>
              <input type="number" id="kpi-sidenav-gross_margin" class="form-input" placeholder="e.g. 72" min="0" max="100" step="0.1">
            </div>
            <div class="form-group">
              <label class="form-label">Notes</label>
              <textarea id="kpi-sidenav-notes" class="form-input" rows="3"></textarea>
            </div>
          </div>
        </div>
        <div class="sidenav-footer">
          <button type="button" id="kpi-sidenav-delete" class="btn-danger-ghost hidden">Delete</button>
          <div class="flex-1"></div>
          <button type="button" id="kpi-sidenav-cancel" class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active">Cancel</button>
          <button type="button" id="kpi-sidenav-save" class="btn">Save</button>
        </div>
      </div>
    </div>

    <!-- MoSCoW Analysis Sidenav -->
    <div id="moscowSidenav" class="sidenav-panel sidenav-lg">
      <div class="sidenav-header">
        <h2 id="moscowSidenavHeader" class="sidenav-title">New MoSCoW Analysis</h2>
        <div class="flex items-center gap-2">
          <span id="moscowSidenavSaveStatus" class="text-xs hidden"></span>
          <button type="button" id="moscowSidenavClose" class="sidenav-close" aria-label="Close">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>
      </div>
      <div class="flex flex-col flex-1 overflow-hidden">
        <div class="sidenav-content">
          <div class="sidenav-section">
            <div class="form-group">
              <label class="form-label">Title</label>
              <input type="text" id="moscowSidenavTitle" required class="form-input">
            </div>
            <div class="form-group">
              <label class="form-label">Date</label>
              <input type="date" id="moscowSidenavDate" class="form-input">
            </div>
          </div>
          <div class="sidenav-section">
            <div class="sidenav-section-title flex justify-between items-center">
              Must Have
              <button type="button" id="moscowSidenav_add_must" class="text-sm text-secondary hover:text-primary">+ Add</button>
            </div>
            <div id="moscowSidenav_must" class="space-y-1"></div>
          </div>
          <div class="sidenav-section">
            <div class="sidenav-section-title flex justify-between items-center">
              Should Have
              <button type="button" id="moscowSidenav_add_should" class="text-sm text-secondary hover:text-primary">+ Add</button>
            </div>
            <div id="moscowSidenav_should" class="space-y-1"></div>
          </div>
          <div class="sidenav-section">
            <div class="sidenav-section-title flex justify-between items-center">
              Could Have
              <button type="button" id="moscowSidenav_add_could" class="text-sm text-secondary hover:text-primary">+ Add</button>
            </div>
            <div id="moscowSidenav_could" class="space-y-1"></div>
          </div>
          <div class="sidenav-section">
            <div class="sidenav-section-title flex justify-between items-center">
              Won't Have
              <button type="button" id="moscowSidenav_add_wont" class="text-sm text-secondary hover:text-primary">+ Add</button>
            </div>
            <div id="moscowSidenav_wont" class="space-y-1"></div>
          </div>
        </div>
        <div class="sidenav-footer">
          <button type="button" id="moscowSidenavDelete" class="btn-danger-ghost hidden">Delete</button>
          <div class="flex-1"></div>
          <button type="button" id="moscowSidenavCancel"
            class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active">
            Cancel
          </button>
        </div>
      </div>
    </div>

    <!-- Eisenhower Matrix Sidenav -->
    <div id="eisenhowerSidenav" class="sidenav-panel sidenav-lg">
      <div class="sidenav-header">
        <h2 id="eisenhowerSidenavHeader" class="sidenav-title">New Eisenhower Matrix</h2>
        <div class="flex items-center gap-2">
          <span id="eisenhowerSidenavSaveStatus" class="text-xs hidden"></span>
          <button type="button" id="eisenhowerSidenavClose" class="sidenav-close" aria-label="Close">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>
      </div>
      <div class="flex flex-col flex-1 overflow-hidden">
        <div class="sidenav-content">
          <div class="sidenav-section">
            <div class="form-group">
              <label class="form-label">Title</label>
              <input type="text" id="eisenhowerSidenavTitle" required class="form-input">
            </div>
            <div class="form-group">
              <label class="form-label">Date</label>
              <input type="date" id="eisenhowerSidenavDate" class="form-input">
            </div>
          </div>
          <div class="sidenav-section">
            <div class="sidenav-section-title flex justify-between items-center">
              Do First (Urgent + Important)
              <button type="button" id="eisenhowerSidenav_add_urgentImportant" class="text-sm text-secondary hover:text-primary">+ Add</button>
            </div>
            <div id="eisenhowerSidenav_urgentImportant" class="space-y-1"></div>
          </div>
          <div class="sidenav-section">
            <div class="sidenav-section-title flex justify-between items-center">
              Schedule (Not Urgent + Important)
              <button type="button" id="eisenhowerSidenav_add_notUrgentImportant" class="text-sm text-secondary hover:text-primary">+ Add</button>
            </div>
            <div id="eisenhowerSidenav_notUrgentImportant" class="space-y-1"></div>
          </div>
          <div class="sidenav-section">
            <div class="sidenav-section-title flex justify-between items-center">
              Delegate (Urgent + Not Important)
              <button type="button" id="eisenhowerSidenav_add_urgentNotImportant" class="text-sm text-secondary hover:text-primary">+ Add</button>
            </div>
            <div id="eisenhowerSidenav_urgentNotImportant" class="space-y-1"></div>
          </div>
          <div class="sidenav-section">
            <div class="sidenav-section-title flex justify-between items-center">
              Eliminate (Not Urgent + Not Important)
              <button type="button" id="eisenhowerSidenav_add_notUrgentNotImportant" class="text-sm text-secondary hover:text-primary">+ Add</button>
            </div>
            <div id="eisenhowerSidenav_notUrgentNotImportant" class="space-y-1"></div>
          </div>
        </div>
        <div class="sidenav-footer">
          <button type="button" id="eisenhowerSidenavDelete" class="btn-danger-ghost hidden">Delete</button>
          <div class="flex-1"></div>
          <button type="button" id="eisenhowerSidenavCancel"
            class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active">
            Cancel
          </button>
        </div>
      </div>
    </div>

    <!-- SWOT Analysis Sidenav -->
    <div id="swotSidenav" class="sidenav-panel sidenav-lg">
      <div class="sidenav-header">
        <h2 id="swotSidenavHeader" class="sidenav-title">New SWOT Analysis</h2>
        <div class="flex items-center gap-2">
          <span id="swotSidenavSaveStatus" class="text-xs hidden"></span>
          <button
            type="button"
            id="swotSidenavClose"
            class="sidenav-close"
            aria-label="Close"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              >
              </path>
            </svg>
          </button>
        </div>
      </div>
      <div class="sidenav-content">
        <div class="sidenav-section">
          <div class="sidenav-grid">
            <div class="form-group">
              <label class="form-label">Title</label><input
                type="text"
                id="swotSidenavTitle"
                class="form-input"
                required
              >
            </div>
            <div class="form-group">
              <label class="form-label">Date</label><input
                type="date"
                id="swotSidenavDate"
                class="form-input"
              >
            </div>
          </div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Strengths</span><button
              type="button"
              id="swotSidenav_add_strengths"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="swotSidenav_strengths"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Weaknesses</span><button
              type="button"
              id="swotSidenav_add_weaknesses"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="swotSidenav_weaknesses"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Opportunities</span><button
              type="button"
              id="swotSidenav_add_opportunities"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="swotSidenav_opportunities"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Threats</span><button
              type="button"
              id="swotSidenav_add_threats"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="swotSidenav_threats"></div>
        </div>
      </div>
      <div class="sidenav-footer">
        <button
          type="button"
          id="swotSidenavDelete"
          class="btn-danger-ghost hidden"
        >
          Delete
        </button>
        <div class="flex-1"></div>
        <button
          type="button"
          id="swotSidenavCancel"
          class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active"
        >
          Close
        </button>
      </div>
    </div>

    <!-- Risk Analysis Sidenav -->
    <div id="riskSidenav" class="sidenav-panel sidenav-lg">
      <div class="sidenav-header">
        <h2 id="riskSidenavHeader" class="sidenav-title">New Risk Analysis</h2>
        <div class="flex items-center gap-2">
          <span id="riskSidenavSaveStatus" class="text-xs hidden"></span>
          <button
            type="button"
            id="riskSidenavClose"
            class="sidenav-close"
            aria-label="Close"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              >
              </path>
            </svg>
          </button>
        </div>
      </div>
      <div class="sidenav-content">
        <div class="sidenav-section">
          <div class="sidenav-grid">
            <div class="form-group">
              <label class="form-label">Title</label><input
                type="text"
                id="riskSidenavTitle"
                class="form-input"
                required
              >
            </div>
            <div class="form-group">
              <label class="form-label">Date</label><input
                type="date"
                id="riskSidenavDate"
                class="form-input"
              >
            </div>
          </div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title"
            >High Impact / High Probability</span><button
              type="button"
              id="riskSidenav_add_highImpactHighProb"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="riskSidenav_highImpactHighProb"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title"
            >High Impact / Low Probability</span><button
              type="button"
              id="riskSidenav_add_highImpactLowProb"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="riskSidenav_highImpactLowProb"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title"
            >Low Impact / High Probability</span><button
              type="button"
              id="riskSidenav_add_lowImpactHighProb"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="riskSidenav_lowImpactHighProb"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title"
            >Low Impact / Low Probability</span><button
              type="button"
              id="riskSidenav_add_lowImpactLowProb"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="riskSidenav_lowImpactLowProb"></div>
        </div>
      </div>
      <div class="sidenav-footer">
        <button
          type="button"
          id="riskSidenavDelete"
          class="btn-danger-ghost hidden"
        >
          Delete
        </button>
        <div class="flex-1"></div>
        <button
          type="button"
          id="riskSidenavCancel"
          class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active"
        >
          Close
        </button>
      </div>
    </div>

    <!-- Lean Canvas Sidenav -->
    <div id="leanCanvasSidenav" class="sidenav-panel sidenav-lg">
      <div class="sidenav-header">
        <h2 id="leanCanvasSidenavHeader" class="sidenav-title">
          New Lean Canvas
        </h2>
        <div class="flex items-center gap-2">
          <span id="leanCanvasSidenavSaveStatus" class="text-xs hidden"></span>
          <button
            type="button"
            id="leanCanvasSidenavClose"
            class="sidenav-close"
            aria-label="Close"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              >
              </path>
            </svg>
          </button>
        </div>
      </div>
      <div class="sidenav-content">
        <div class="sidenav-section">
          <div class="sidenav-grid">
            <div class="form-group">
              <label class="form-label">Title</label><input
                type="text"
                id="leanCanvasSidenavTitle"
                class="form-input"
                required
              >
            </div>
            <div class="form-group">
              <label class="form-label">Date</label><input
                type="date"
                id="leanCanvasSidenavDate"
                class="form-input"
              >
            </div>
          </div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Problem</span><button
              type="button"
              id="leanSidenav_add_problem"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="leanSidenav_problem"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Solution</span><button
              type="button"
              id="leanSidenav_add_solution"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="leanSidenav_solution"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title"
            >Unique Value Proposition</span><button
              type="button"
              id="leanSidenav_add_uniqueValueProp"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="leanSidenav_uniqueValueProp"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Unfair Advantage</span><button
              type="button"
              id="leanSidenav_add_unfairAdvantage"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="leanSidenav_unfairAdvantage"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Customer Segments</span><button
              type="button"
              id="leanSidenav_add_customerSegments"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="leanSidenav_customerSegments"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title"
            >Existing Alternatives</span><button
              type="button"
              id="leanSidenav_add_existingAlternatives"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="leanSidenav_existingAlternatives"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Key Metrics</span><button
              type="button"
              id="leanSidenav_add_keyMetrics"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="leanSidenav_keyMetrics"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">High-Level Concept</span><button
              type="button"
              id="leanSidenav_add_highLevelConcept"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="leanSidenav_highLevelConcept"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Channels</span><button
              type="button"
              id="leanSidenav_add_channels"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="leanSidenav_channels"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Early Adopters</span><button
              type="button"
              id="leanSidenav_add_earlyAdopters"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="leanSidenav_earlyAdopters"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Cost Structure</span><button
              type="button"
              id="leanSidenav_add_costStructure"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="leanSidenav_costStructure"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Revenue Streams</span><button
              type="button"
              id="leanSidenav_add_revenueStreams"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="leanSidenav_revenueStreams"></div>
        </div>
      </div>
      <div class="sidenav-footer">
        <button
          type="button"
          id="leanCanvasSidenavDelete"
          class="btn-danger-ghost hidden"
        >
          Delete
        </button>
        <div class="flex-1"></div>
        <button
          type="button"
          id="leanCanvasSidenavCancel"
          class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active"
        >
          Close
        </button>
      </div>
    </div>

    <!-- Business Model Canvas Sidenav -->
    <div id="bmcSidenav" class="sidenav-panel sidenav-lg">
      <div class="sidenav-header">
        <h2 id="bmcSidenavHeader" class="sidenav-title">
          New Business Model Canvas
        </h2>
        <div class="flex items-center gap-2">
          <span id="bmcSidenavSaveStatus" class="text-xs hidden"></span>
          <button
            type="button"
            id="bmcSidenavClose"
            class="sidenav-close"
            aria-label="Close"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              >
              </path>
            </svg>
          </button>
        </div>
      </div>
      <div class="sidenav-content">
        <div class="sidenav-section">
          <div class="sidenav-grid">
            <div class="form-group">
              <label class="form-label">Title</label><input
                type="text"
                id="bmcSidenavTitle"
                class="form-input"
                required
              >
            </div>
            <div class="form-group">
              <label class="form-label">Date</label><input
                type="date"
                id="bmcSidenavDate"
                class="form-input"
              >
            </div>
          </div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Key Partners</span><button
              type="button"
              id="bmcSidenav_add_keyPartners"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="bmcSidenav_keyPartners"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Key Activities</span><button
              type="button"
              id="bmcSidenav_add_keyActivities"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="bmcSidenav_keyActivities"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Key Resources</span><button
              type="button"
              id="bmcSidenav_add_keyResources"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="bmcSidenav_keyResources"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Value Proposition</span><button
              type="button"
              id="bmcSidenav_add_valueProposition"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="bmcSidenav_valueProposition"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title"
            >Customer Relationships</span><button
              type="button"
              id="bmcSidenav_add_customerRelationships"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="bmcSidenav_customerRelationships"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Channels</span><button
              type="button"
              id="bmcSidenav_add_channels"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="bmcSidenav_channels"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Customer Segments</span><button
              type="button"
              id="bmcSidenav_add_customerSegments"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="bmcSidenav_customerSegments"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Cost Structure</span><button
              type="button"
              id="bmcSidenav_add_costStructure"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="bmcSidenav_costStructure"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Revenue Streams</span><button
              type="button"
              id="bmcSidenav_add_revenueStreams"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="bmcSidenav_revenueStreams"></div>
        </div>
      </div>
      <div class="sidenav-footer">
        <button
          type="button"
          id="bmcSidenavDelete"
          class="btn-danger-ghost hidden"
        >
          Delete
        </button>
        <div class="flex-1"></div>
        <button
          type="button"
          id="bmcSidenavCancel"
          class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active"
        >
          Close
        </button>
      </div>
    </div>

    <!-- Project Value Board Sidenav -->
    <div id="pvbSidenav" class="sidenav-panel sidenav-md">
      <div class="sidenav-header">
        <h2 id="pvbSidenavHeader" class="sidenav-title">
          New Project Value Board
        </h2>
        <div class="flex items-center gap-2">
          <span id="pvbSidenavSaveStatus" class="text-xs hidden"></span>
          <button
            type="button"
            id="pvbSidenavClose"
            class="sidenav-close"
            aria-label="Close"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              >
              </path>
            </svg>
          </button>
        </div>
      </div>
      <div class="sidenav-content">
        <div class="sidenav-section">
          <div class="sidenav-grid">
            <div class="form-group">
              <label class="form-label">Title</label><input
                type="text"
                id="pvbSidenavTitle"
                class="form-input"
                required
              >
            </div>
            <div class="form-group">
              <label class="form-label">Date</label><input
                type="date"
                id="pvbSidenavDate"
                class="form-input"
              >
            </div>
          </div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Customer Segments</span><button
              type="button"
              id="pvbSidenav_add_customerSegments"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="pvbSidenav_customerSegments"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Problem</span><button
              type="button"
              id="pvbSidenav_add_problem"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="pvbSidenav_problem"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Solution</span><button
              type="button"
              id="pvbSidenav_add_solution"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="pvbSidenav_solution"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Benefit</span><button
              type="button"
              id="pvbSidenav_add_benefit"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="pvbSidenav_benefit"></div>
        </div>
      </div>
      <div class="sidenav-footer">
        <button
          type="button"
          id="pvbSidenavDelete"
          class="btn-danger-ghost hidden"
        >
          Delete
        </button>
        <div class="flex-1"></div>
        <button
          type="button"
          id="pvbSidenavCancel"
          class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active"
        >
          Close
        </button>
      </div>
    </div>

    <!-- Brief Sidenav -->
    <div id="briefSidenav" class="sidenav-panel sidenav-lg">
      <div class="sidenav-header">
        <h2 id="briefSidenavHeader" class="sidenav-title">New Brief</h2>
        <div class="flex items-center gap-2">
          <span id="briefSidenavSaveStatus" class="text-xs hidden"></span>
          <button
            type="button"
            id="briefSidenavClose"
            class="sidenav-close"
            aria-label="Close"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              >
              </path>
            </svg>
          </button>
        </div>
      </div>
      <div class="sidenav-content">
        <div class="sidenav-section">
          <div class="sidenav-grid">
            <div class="form-group">
              <label class="form-label">Title</label><input
                type="text"
                id="briefSidenavTitle"
                class="form-input"
                required
              >
            </div>
            <div class="form-group">
              <label class="form-label">Date</label><input
                type="date"
                id="briefSidenavDate"
                class="form-input"
              >
            </div>
          </div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Summary</span><button
              type="button"
              id="briefSidenav_add_summary"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="briefSidenav_summary"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Mission</span><button
              type="button"
              id="briefSidenav_add_mission"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="briefSidenav_mission"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Responsible</span><button
              type="button"
              id="briefSidenav_add_responsible"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="briefSidenav_responsible"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Accountable</span><button
              type="button"
              id="briefSidenav_add_accountable"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="briefSidenav_accountable"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Consulted</span><button
              type="button"
              id="briefSidenav_add_consulted"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="briefSidenav_consulted"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Informed</span><button
              type="button"
              id="briefSidenav_add_informed"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="briefSidenav_informed"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">High Level Budget</span><button
              type="button"
              id="briefSidenav_add_highLevelBudget"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="briefSidenav_highLevelBudget"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title"
            >High Level Timeline</span><button
              type="button"
              id="briefSidenav_add_highLevelTimeline"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="briefSidenav_highLevelTimeline"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Culture</span><button
              type="button"
              id="briefSidenav_add_culture"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="briefSidenav_culture"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Change Capacity</span><button
              type="button"
              id="briefSidenav_add_changeCapacity"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="briefSidenav_changeCapacity"></div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Guiding Principles</span><button
              type="button"
              id="briefSidenav_add_guidingPrinciples"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="briefSidenav_guidingPrinciples"></div>
        </div>
      </div>
      <div class="sidenav-footer">
        <button
          type="button"
          id="briefSidenavDelete"
          class="btn-danger-ghost hidden"
        >
          Delete
        </button>
        <div class="flex-1"></div>
        <button
          type="button"
          id="briefSidenavCancel"
          class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active"
        >
          Close
        </button>
      </div>
    </div>

    <!-- Footer -->
    <footer
      id="app-footer"
      class="fixed bottom-0 left-0 right-0 bg-primary border-t border-default py-2 px-4 text-xs text-muted flex justify-between items-center z-40"
    >
      <div class="flex items-center gap-2">
        <span id="versionDisplay">MD Planner v0.1.0</span>
        <span
          id="updateBadge"
          class="hidden px-1.5 py-0.5 bg-success-bg text-success-text rounded text-xs cursor-pointer hover:bg-success-bg"
          onclick="window.open('https://github.com/studiowebux/mdplanner/releases', '_blank')"
        >Update available</span>
      </div>
      <a
        href="https://github.com/studiowebux/mdplanner"
        target="_blank"
        rel="noopener noreferrer"
        class="hover:text-primary underline transition-colors"
      >GitHub</a>
    </footer>

    <!-- Focus Mode Container -->
    <div id="focusModeContainer" class="hidden"></div>

    <!-- Portfolio Detail Panel -->
    <div id="portfolioDetailPanel" class="sidenav-panel sidenav-md">
      <div class="sidenav-header">
        <h2 class="sidenav-title" id="portfolioDetailTitle">Project Details</h2>
        <button
          type="button"
          id="portfolioDetailClose"
          class="sidenav-close"
          aria-label="Close"
        >
          <svg
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M6 18L18 6M6 6l12 12"
            >
            </path>
          </svg>
        </button>
      </div>
      <div class="sidenav-content" id="portfolioDetailContent">
        <!-- Content rendered by JS -->
      </div>
      <div class="sidenav-footer">
        <button type="button" id="portfolioDetailSave" class="btn btn-primary">
          Save Changes
        </button>
      </div>
    </div>

    <!-- Idea Sidenav -->
    <!-- Meeting Sidenav -->
    <div id="meetingSidenav" class="sidenav-panel sidenav-md">
      <div class="sidenav-header">
        <h2 id="meetingSidenavHeader" class="sidenav-title">New Meeting</h2>
        <div class="flex items-center gap-2">
          <span id="meetingSidenavSaveStatus" class="text-xs hidden"></span>
          <button type="button" id="meetingSidenavClose" class="sidenav-close" aria-label="Close">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>
      </div>
      <div class="flex flex-col flex-1 overflow-hidden">
        <div class="sidenav-content">
          <div class="sidenav-section">
            <div class="form-group">
              <label class="form-label" for="meetingSidenavTitle">Title</label>
              <input id="meetingSidenavTitle" type="text" class="form-input" placeholder="Meeting title" />
            </div>
            <div class="form-group">
              <label class="form-label" for="meetingSidenavDate">Date</label>
              <input id="meetingSidenavDate" type="date" class="form-input" />
            </div>
            <div class="form-group">
              <label class="form-label" for="meetingSidenavAttendeeInput">Attendees</label>
              <div id="meetingSidenavAttendeePicker" class="attendee-tag-picker">
                <input id="meetingSidenavAttendeeInput" type="text" class="attendee-tag-input" placeholder="Add person..." autocomplete="off" />
              </div>
            </div>
            <div class="form-group">
              <label class="form-label" for="meetingSidenavAgenda">Agenda</label>
              <textarea id="meetingSidenavAgenda" class="form-textarea" rows="2" placeholder="Meeting agenda..."></textarea>
            </div>
            <div class="form-group">
              <label class="form-label" for="meetingSidenavNotes">Notes</label>
              <textarea id="meetingSidenavNotes" class="form-textarea" rows="6" placeholder="Meeting notes (markdown supported)..."></textarea>
            </div>
          </div>
          <div class="sidenav-section">
            <div class="sidenav-section-title">Action Items</div>
            <div class="meeting-action-input-row">
              <input id="meetingSidenavActionInput" type="text" class="form-input" placeholder="Action description" />
              <div class="meeting-action-meta-inputs">
                <input id="meetingSidenavActionOwner" type="text" class="form-input" placeholder="Owner" autocomplete="off" />
                <input id="meetingSidenavActionDue" type="date" class="form-input" />
                <button id="meetingSidenavActionAdd" class="btn-primary py-2 rounded-lg">Add</button>
              </div>
            </div>
            <div id="meetingSidenavActionList"></div>
          </div>
        </div>
        <div class="sidenav-footer">
          <button type="button" id="meetingSidenavDelete" class="btn-danger-ghost hidden">Delete</button>
          <div class="flex-1"></div>
          <button type="button" id="meetingSidenavCancel" class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active">Cancel</button>
        </div>
      </div>
    </div>

    <!-- Onboarding Template Sidenav -->
    <div id="onboardingTemplateSidenav" class="sidenav-panel sidenav-md">
      <div class="sidenav-header">
        <h2 id="onboardingTemplateSidenavHeader" class="sidenav-title">New Template</h2>
        <div class="flex items-center gap-2">
          <span id="onboardingTemplateSidenavSaveStatus" class="text-xs hidden"></span>
          <button type="button" id="onboardingTemplateSidenavClose" class="sidenav-close" aria-label="Close">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>
      </div>
      <div class="flex flex-col flex-1 overflow-hidden">
        <div class="sidenav-content">
          <div class="sidenav-section">
            <div class="form-group">
              <label class="form-label" for="onboardingTemplateName">Template Name</label>
              <input id="onboardingTemplateName" type="text" class="form-input" placeholder="e.g. Engineering Onboarding" />
            </div>
            <div class="form-group">
              <label class="form-label" for="onboardingTemplateDescription">Description (optional)</label>
              <input id="onboardingTemplateDescription" type="text" class="form-input" placeholder="Short description..." />
            </div>
          </div>
          <div class="sidenav-section">
            <div class="sidenav-section-title">Steps</div>
            <div id="onboardingTemplateStepsList" class="onboarding-steps-list"></div>
            <div class="onboarding-add-step">
              <input id="onboardingTemplateNewStepTitle" type="text" class="form-input" placeholder="Step title..." />
              <select id="onboardingTemplateNewStepCategory" class="form-input" style="max-width:8rem">
                <option value="equipment">Equipment</option>
                <option value="accounts">Accounts</option>
                <option value="docs">Docs</option>
                <option value="training">Training</option>
                <option value="intro">Intro</option>
                <option value="other">Other</option>
              </select>
              <button id="onboardingTemplateAddStepBtn" class="btn-primary py-2 rounded-lg">Add</button>
            </div>
          </div>
        </div>
        <div class="sidenav-footer">
          <button type="button" id="onboardingTemplateDeleteBtn" class="btn-danger-ghost hidden">Delete</button>
          <div class="flex-1"></div>
          <button type="button" id="onboardingTemplateSidenavSave" class="btn-primary py-2 rounded-lg">Save</button>
        </div>
      </div>
    </div>

    <!-- Onboarding Create/Edit Sidenav (metadata only) -->
    <div id="onboardingSidenav" class="sidenav-panel sidenav-md">
      <div class="sidenav-header">
        <h2 id="onboardingSidenavHeader" class="sidenav-title">New Onboarding</h2>
        <div class="flex items-center gap-2">
          <span id="onboardingSidenavSaveStatus" class="text-xs hidden"></span>
          <button type="button" id="onboardingSidenavClose" class="sidenav-close" aria-label="Close">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>
      </div>
      <div class="flex flex-col flex-1 overflow-hidden">
        <div class="sidenav-content">
          <div class="sidenav-section">
            <div class="form-group">
              <label class="form-label" for="onboardingSidenavName">Employee Name</label>
              <input id="onboardingSidenavName" type="text" class="form-input" placeholder="Full name" />
            </div>
            <div class="form-group">
              <label class="form-label" for="onboardingSidenavRole">Role / Title</label>
              <input id="onboardingSidenavRole" type="text" class="form-input" placeholder="e.g. Software Engineer" />
            </div>
            <div class="form-group">
              <label class="form-label" for="onboardingSidenavStartDate">Start Date</label>
              <input id="onboardingSidenavStartDate" type="date" class="form-input" />
            </div>
            <div class="form-group">
              <label class="form-label" for="onboardingSidenavPersonId">People Registry ID (optional)</label>
              <input id="onboardingSidenavPersonId" type="text" class="form-input" placeholder="person_..." />
            </div>
            <div class="form-group">
              <label class="form-label" for="onboardingSidenavNotes">Notes</label>
              <textarea id="onboardingSidenavNotes" class="form-textarea" rows="3" placeholder="Additional notes..."></textarea>
            </div>
          </div>
          <div class="sidenav-section">
            <div class="sidenav-section-title">Load from Template</div>
            <div class="onboarding-template-load-row">
              <select id="onboardingTemplateSelect" class="form-input">
                <option value="">— pick a template —</option>
              </select>
              <button id="onboardingLoadTemplateBtn" class="btn-secondary py-2 rounded-lg" style="white-space:nowrap">Load</button>
            </div>
          </div>
        </div>
        <div class="sidenav-footer">
          <button type="button" id="onboardingDeleteBtn" class="btn-danger-ghost hidden">Delete</button>
          <div class="flex-1"></div>
          <button type="button" id="onboardingSidenavSave" class="btn-primary py-2 rounded-lg">Save</button>
        </div>
      </div>
    </div>

    <!-- Onboarding Detail Sidenav (checklist) -->
    <div id="onboardingDetailSidenav" class="sidenav-panel sidenav-lg">
      <div class="sidenav-header">
        <div>
          <h2 id="onboardingDetailName" class="sidenav-title"></h2>
          <p id="onboardingDetailMeta" class="text-sm text-secondary"></p>
        </div>
        <div class="flex items-center gap-2">
          <button type="button" id="onboardingDetailEditBtn" class="btn-secondary py-1 rounded-lg" style="font-size:var(--font-size-sm)">Edit</button>
          <button type="button" id="onboardingDetailClose" class="sidenav-close" aria-label="Close">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>
      </div>
      <div class="flex flex-col flex-1 overflow-hidden">
        <div class="sidenav-content">
          <div class="onboarding-detail-progress">
            <div class="onboarding-progress-bar">
              <div id="onboardingDetailProgressFill" class="onboarding-progress-fill"></div>
            </div>
            <span id="onboardingDetailProgressLabel" class="onboarding-progress-label"></span>
          </div>
          <div id="onboardingDetailChecklist" class="onboarding-checklist"></div>
          <div class="sidenav-section" style="margin-top:1rem">
            <div class="sidenav-section-title">Add Step</div>
            <div class="onboarding-add-step">
              <input id="onboardingDetailNewStep" type="text" class="form-input" placeholder="Step title..." />
              <select id="onboardingDetailNewCategory" class="form-input" style="max-width:8rem">
                <option value="equipment">Equipment</option>
                <option value="accounts">Accounts</option>
                <option value="docs">Docs</option>
                <option value="training">Training</option>
                <option value="intro">Intro</option>
                <option value="other">Other</option>
              </select>
              <button id="onboardingDetailAddStepBtn" class="btn-primary py-2 rounded-lg">Add</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="ideaSidenav" class="sidenav-panel sidenav-md">
      <div class="sidenav-header">
        <h2 id="ideaSidenavHeader" class="sidenav-title">New Idea</h2>
        <div class="flex items-center gap-2">
          <span id="ideaSidenavSaveStatus" class="text-xs hidden"></span>
          <button
            type="button"
            id="ideaSidenavClose"
            class="sidenav-close"
            aria-label="Close"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              >
              </path>
            </svg>
          </button>
        </div>
      </div>
      <div class="sidenav-content">
        <div class="sidenav-section">
          <div class="form-group">
            <label class="form-label">Title</label>
            <input
              type="text"
              id="ideaSidenavTitle"
              class="form-input"
              required
              placeholder="What's your idea?"
            >
          </div>
          <div class="sidenav-grid">
            <div class="form-group">
              <label class="form-label">Status</label>
              <select id="ideaSidenavStatus" class="form-input">
                <option value="new">New</option>
                <option value="considering">Considering</option>
                <option value="planned">Planned</option>
                <option value="approved">Approved</option>
                <option value="rejected">Rejected</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Priority</label>
              <select id="ideaSidenavPriority" class="form-input">
                <option value="">None</option>
                <option value="high">High</option>
                <option value="medium">Medium</option>
                <option value="low">Low</option>
              </select>
            </div>
          </div>
          <div class="sidenav-grid">
            <div class="form-group">
              <label class="form-label">Category</label>
              <input
                type="text"
                id="ideaSidenavCategory"
                class="form-input"
                placeholder="e.g., feature, bug"
              >
            </div>
            <div class="form-group">
              <label class="form-label">Resources</label>
              <input
                type="text"
                id="ideaSidenavResources"
                class="form-input"
                placeholder="e.g., 2 devs, $5k"
              >
            </div>
          </div>
          <div class="sidenav-grid">
            <div class="form-group">
              <label class="form-label">Start Date</label>
              <input
                type="date"
                id="ideaSidenavStartDate"
                class="form-input"
              >
            </div>
            <div class="form-group">
              <label class="form-label">End Date</label>
              <input
                type="date"
                id="ideaSidenavEndDate"
                class="form-input"
              >
            </div>
          </div>
          <div class="form-group">
            <label class="form-label">Subtasks</label>
            <div class="flex gap-2 mb-2">
              <input
                type="text"
                id="ideaSidenavSubtaskInput"
                class="form-input"
                placeholder="Add a subtask and press Enter"
              >
              <button type="button" id="ideaSidenavSubtaskAdd" class="btn-secondary">Add</button>
            </div>
            <div id="ideaSidenavSubtaskList"></div>
          </div>
          <div class="form-group">
            <label class="form-label">Description</label>
            <textarea
              id="ideaSidenavDescription"
              class="form-input"
              rows="4"
              placeholder="Describe the idea..."
            ></textarea>
          </div>
        </div>
        <div id="ideaSidenavLinksSection" class="sidenav-section hidden">
          <button
            type="button"
            id="ideaSidenavToggleLinks"
            class="flex justify-between items-center w-full text-left"
          >
            <span class="sidenav-section-title"
            >Linked Ideas (Zettelkasten)</span>
            <svg
              id="ideaSidenavToggleLinksIcon"
              class="w-4 h-4 text-muted transform transition-transform"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M19 9l-7 7-7-7"
              >
              </path>
            </svg>
          </button>
          <div id="ideaSidenavLinksContent" class="mt-3">
            <div class="mb-3">
              <label class="text-xs text-muted mb-1 block"
              >Current Links</label>
              <div
                id="ideaSidenavLinkedList"
                class="border border-default rounded p-2 bg-secondary min-h-[40px]"
              >
              </div>
            </div>
            <div>
              <label class="text-xs text-muted mb-1 block"
              >Add Link</label>
              <input
                type="text"
                id="ideaSidenavLinkSearch"
                class="form-input mb-2"
                placeholder="Search ideas..."
              >
              <div
                id="ideaSidenavLinkOptions"
                class="border border-default rounded max-h-[200px] overflow-y-auto"
              >
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="sidenav-footer">
        <button
          type="button"
          id="ideaSidenavDelete"
          class="btn-danger-ghost hidden"
        >
          Delete
        </button>
        <div class="flex-1"></div>
        <button
          type="button"
          id="ideaSidenavCancel"
          class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active"
        >
          Close
        </button>
      </div>
    </div>

    <!-- C4 Component Sidenav -->
    <div id="c4Sidenav" class="sidenav-panel sidenav-md">
      <div class="sidenav-header">
        <h2 id="c4SidenavHeader" class="sidenav-title">New C4 Component</h2>
        <div class="flex items-center gap-2">
          <span id="c4SidenavSaveStatus" class="text-xs hidden"></span>
          <button
            type="button"
            id="c4SidenavClose"
            class="sidenav-close"
            aria-label="Close"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              >
              </path>
            </svg>
          </button>
        </div>
      </div>
      <div class="sidenav-content">
        <div class="sidenav-section">
          <div
            id="c4SidenavIdDisplay"
            class="text-xs text-muted mb-2 hidden"
          >
            ID: <span id="c4SidenavIdValue"></span>
          </div>
          <div class="form-group">
            <label class="form-label">Component Name</label>
            <input
              type="text"
              id="c4SidenavName"
              class="form-input"
              required
              placeholder="e.g., Web Application, API Gateway"
            >
          </div>
          <div class="sidenav-grid grid-cols-3">
            <div class="form-group">
              <label class="form-label">Level</label>
              <select id="c4SidenavLevel" class="form-input">
                <option value="context">Context</option>
                <option value="container">Container</option>
                <option value="component">Component</option>
                <option value="code">Code</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Type</label>
              <input
                type="text"
                id="c4SidenavType"
                class="form-input"
                placeholder="e.g., System"
              >
            </div>
            <div class="form-group">
              <label class="form-label">Technology</label>
              <input
                type="text"
                id="c4SidenavTechnology"
                class="form-input"
                placeholder="e.g., React"
              >
            </div>
          </div>
          <div class="form-group">
            <label class="form-label">Description</label>
            <textarea
              id="c4SidenavDescription"
              class="form-input"
              rows="3"
              placeholder="What does this component do?"
            ></textarea>
          </div>
          <div class="sidenav-grid">
            <div class="form-group">
              <label class="form-label">X Position</label>
              <input
                type="number"
                id="c4SidenavX"
                class="form-input"
                value="100"
              >
            </div>
            <div class="form-group">
              <label class="form-label">Y Position</label>
              <input
                type="number"
                id="c4SidenavY"
                class="form-input"
                value="100"
              >
            </div>
          </div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Connections</span>
            <button
              type="button"
              id="c4SidenavAddConnection"
              class="text-xs text-secondary hover:text-primary"
            >
              + Add
            </button>
          </div>
          <div id="c4SidenavConnections" class="space-y-2"></div>
        </div>
      </div>
      <div class="sidenav-footer">
        <button
          type="button"
          id="c4SidenavDelete"
          class="btn-danger-ghost hidden"
        >
          Delete
        </button>
        <div class="flex-1"></div>
        <button
          type="button"
          id="c4SidenavCancel"
          class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active"
        >
          Close
        </button>
      </div>
    </div>

    <!-- Strategic Levels Sidenav -->
    <div id="strategicSidenav" class="sidenav-panel sidenav-md">
      <div class="sidenav-header">
        <h2 id="strategicSidenavHeader" class="sidenav-title">
          Strategic Levels
        </h2>
        <div class="flex items-center gap-2">
          <span id="strategicSidenavSaveStatus" class="text-xs hidden"></span>
          <button
            type="button"
            id="strategicSidenavClose"
            class="sidenav-close"
            aria-label="Close"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              >
              </path>
            </svg>
          </button>
        </div>
      </div>
      <div class="sidenav-content" id="strategicSidenavContent">
        <!-- Dynamic content rendered by JS -->
      </div>
      <div class="sidenav-footer">
        <button
          type="button"
          id="strategicSidenavDelete"
          class="btn-danger-ghost hidden"
        >
          Delete
        </button>
        <div class="flex-1"></div>
        <button
          type="button"
          id="strategicSidenavCancel"
          class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active"
        >
          Close
        </button>
      </div>
    </div>

    <!-- Billing Entity Sidenav -->
    <div id="billingSidenav" class="sidenav-panel sidenav-lg">
      <div class="sidenav-header">
        <h2 id="billingSidenavHeader" class="sidenav-title">Billing</h2>
        <div class="flex items-center gap-2">
          <span id="billingSidenavSaveStatus" class="text-xs hidden"></span>
          <button
            type="button"
            id="billingSidenavClose"
            class="sidenav-close"
            aria-label="Close"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              >
              </path>
            </svg>
          </button>
        </div>
      </div>
      <div class="sidenav-content" id="billingSidenavContent">
        <!-- Dynamic content rendered by JS -->
      </div>
      <div class="sidenav-footer">
        <button
          type="button"
          id="billingSidenavDelete"
          class="btn-danger-ghost hidden"
        >
          Delete
        </button>
        <div class="flex-1"></div>
        <button
          type="button"
          id="billingSidenavCancel"
          class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active"
        >
          Close
        </button>
      </div>
    </div>

    <!-- CRM Entity Sidenav -->
    <div id="crmSidenav" class="sidenav-panel sidenav-md">
      <div class="sidenav-header">
        <h2 id="crmSidenavHeader" class="sidenav-title">CRM</h2>
        <div class="flex items-center gap-2">
          <span id="crmSidenavSaveStatus" class="text-xs hidden"></span>
          <button
            type="button"
            id="crmSidenavClose"
            class="sidenav-close"
            aria-label="Close"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              >
              </path>
            </svg>
          </button>
        </div>
      </div>
      <div class="sidenav-content" id="crmSidenavContent">
        <!-- Dynamic content rendered by JS -->
      </div>
      <div class="sidenav-footer">
        <button
          type="button"
          id="crmSidenavDelete"
          class="btn-danger-ghost hidden"
        >
          Delete
        </button>
        <div class="flex-1"></div>
        <button
          type="button"
          id="crmSidenavCancel"
          class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active"
        >
          Close
        </button>
      </div>
    </div>

    <!-- Capacity Plan Sidenav -->
    <div id="capacitySidenav" class="sidenav-panel sidenav-md">
      <div class="sidenav-header">
        <h2 id="capacitySidenavHeader" class="sidenav-title">
          New Capacity Plan
        </h2>
        <div class="flex items-center gap-2">
          <span id="capacitySidenavSaveStatus" class="text-xs hidden"></span>
          <button
            type="button"
            id="capacitySidenavClose"
            class="sidenav-close"
            aria-label="Close"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              >
              </path>
            </svg>
          </button>
        </div>
      </div>
      <div class="sidenav-content">
        <div class="sidenav-section">
          <div class="form-group">
            <label class="form-label">Plan Title</label>
            <input
              type="text"
              id="capacitySidenavTitle"
              class="form-input"
              required
              placeholder="e.g., Q1 2026 Capacity"
            >
          </div>
          <div class="sidenav-grid">
            <div class="form-group">
              <label class="form-label">Date</label>
              <input type="date" id="capacitySidenavDate" class="form-input">
            </div>
            <div class="form-group">
              <label class="form-label">Budget (hours)</label>
              <input
                type="number"
                id="capacitySidenavBudget"
                class="form-input"
                min="0"
                placeholder="Optional"
              >
            </div>
          </div>
        </div>
        <div class="sidenav-section">
          <div class="flex justify-between items-center mb-2">
            <span class="sidenav-section-title">Team Members</span>
            <div class="flex gap-2">
              <button
                type="button"
                id="capacitySidenav_importAssignees"
                class="text-xs text-secondary hover:text-primary"
              >
                Import
              </button>
              <button
                type="button"
                id="capacitySidenav_addMember"
                class="text-xs text-secondary hover:text-primary"
              >
                + Add
              </button>
            </div>
          </div>
          <div id="capacitySidenav_memberForm"></div>
          <div id="capacitySidenav_members"></div>
        </div>
      </div>
      <div class="sidenav-footer">
        <button
          type="button"
          id="capacitySidenavDelete"
          class="btn-danger-ghost hidden"
        >
          Delete
        </button>
        <div class="flex-1"></div>
        <button
          type="button"
          id="capacitySidenavCancel"
          class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active"
        >
          Close
        </button>
      </div>
    </div>

    <!-- Org Chart Sidenav -->
    <div id="orgchartSidenav" class="sidenav-panel sidenav-md">
      <div class="sidenav-header">
        <h2 id="orgchartSidenavHeader" class="sidenav-title">
          New Team Member
        </h2>
        <div class="flex items-center gap-2">
          <span id="orgchartSidenavSaveStatus" class="text-xs hidden"></span>
          <button
            type="button"
            id="orgchartSidenavClose"
            class="sidenav-close"
            aria-label="Close"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              >
              </path>
            </svg>
          </button>
        </div>
      </div>
      <form
        id="orgchartSidenavForm"
        class="flex flex-col flex-1 overflow-hidden"
      >
        <div class="sidenav-content">
          <div class="sidenav-section">
            <div class="form-group">
              <label class="form-label">Name *</label>
              <input
                type="text"
                id="orgchartSidenavName"
                required
                class="form-input"
              >
            </div>
            <div class="form-group">
              <label class="form-label">Title *</label>
              <input
                type="text"
                id="orgchartSidenavTitle"
                required
                class="form-input"
                placeholder="e.g., Engineering Manager"
              >
            </div>
            <div class="form-group">
              <label class="form-label">Departments *</label>
              <div id="orgchartDeptChips" class="flex flex-wrap gap-1 mb-1"></div>
              <div class="flex gap-1">
                <input
                  type="text"
                  id="orgchartSidenavDeptInput"
                  class="form-input flex-1"
                  placeholder="Type department name..."
                  list="orgchartDeptSuggestions"
                >
                <datalist id="orgchartDeptSuggestions"></datalist>
                <button type="button" id="orgchartAddDeptBtn" class="btn-ghost text-sm px-2">+ Add</button>
              </div>
              <input type="hidden" id="orgchartSidenavDepartments">
            </div>
            <div class="form-group">
              <label class="form-label">Reports To</label>
              <select id="orgchartSidenavReportsTo" class="form-select">
                <option value="">None (Top Level)</option>
              </select>
            </div>
          </div>
          <div class="sidenav-section">
            <div class="sidenav-section-title">Contact Info</div>
            <div class="form-group">
              <label class="form-label">Email</label>
              <input
                type="email"
                id="orgchartSidenavEmail"
                class="form-input"
                placeholder="name@example.com"
              >
            </div>
            <div class="form-group">
              <label class="form-label">Phone</label>
              <input
                type="tel"
                id="orgchartSidenavPhone"
                class="form-input"
                placeholder="+1-555-0100"
              >
            </div>
          </div>
          <div class="sidenav-section">
            <div class="sidenav-section-title">Additional Info</div>
            <div class="form-group">
              <label class="form-label">Start Date</label>
              <input
                type="date"
                id="orgchartSidenavStartDate"
                class="form-input"
              >
            </div>
            <div class="form-group">
              <label class="form-label">Notes</label>
              <textarea
                id="orgchartSidenavNotes"
                rows="3"
                class="form-textarea"
              ></textarea>
            </div>
          </div>
        </div>
        <div class="sidenav-footer">
          <button
            type="button"
            id="orgchartSidenavDelete"
            class="btn-danger-ghost hidden"
          >
            Delete
          </button>
          <div class="flex-1"></div>
          <button
            type="button"
            id="orgchartSidenavCancel"
            class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active"
          >
            Cancel
          </button>
          <button type="submit" class="btn btn-primary ml-2">Save</button>
        </div>
      </form>
    </div>

    <!-- People Sidenav -->
    <div id="peopleSidenav" class="sidenav-panel sidenav-md">
      <div class="sidenav-header">
        <h2 id="peopleSidenavHeader" class="sidenav-title">
          New Person
        </h2>
        <div class="flex items-center gap-2">
          <span id="peopleSidenavSaveStatus" class="text-xs hidden"></span>
          <button
            type="button"
            id="peopleSidenavClose"
            class="sidenav-close"
            aria-label="Close"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              >
              </path>
            </svg>
          </button>
        </div>
      </div>
      <form
        id="peopleSidenavForm"
        class="flex flex-col flex-1 overflow-hidden"
      >
        <div class="sidenav-content">
          <div class="sidenav-section">
            <div class="form-group">
              <label class="form-label">Name *</label>
              <input
                type="text"
                id="peopleSidenavName"
                required
                class="form-input"
              >
            </div>
            <div class="form-group">
              <label class="form-label">Title</label>
              <input
                type="text"
                id="peopleSidenavTitle"
                class="form-input"
                placeholder="e.g., Engineering Manager"
              >
            </div>
            <div class="form-group">
              <label class="form-label">Role</label>
              <input
                type="text"
                id="peopleSidenavRole"
                class="form-input"
                placeholder="e.g., Backend Developer"
              >
            </div>
            <div class="form-group">
              <label class="form-label">Departments</label>
              <input
                type="text"
                id="peopleSidenavDepartments"
                class="form-input"
                placeholder="e.g., Engineering, Product"
              >
              <p class="text-xs text-muted mt-1">
                Comma-separated for multiple departments
              </p>
            </div>
            <div class="form-group">
              <label class="form-label">Reports To</label>
              <select id="peopleSidenavReportsTo" class="form-select">
                <option value="">None</option>
              </select>
            </div>
          </div>
          <div class="sidenav-section">
            <div class="sidenav-section-title">Contact Info</div>
            <div class="form-group">
              <label class="form-label">Email</label>
              <input
                type="email"
                id="peopleSidenavEmail"
                class="form-input"
                placeholder="name@example.com"
              >
            </div>
            <div class="form-group">
              <label class="form-label">Phone</label>
              <input
                type="tel"
                id="peopleSidenavPhone"
                class="form-input"
                placeholder="+1-555-0100"
              >
            </div>
          </div>
          <div class="sidenav-section">
            <div class="sidenav-section-title">Work Schedule</div>
            <div class="form-group">
              <label class="form-label">Hours Per Day</label>
              <input
                type="number"
                id="peopleSidenavHoursPerDay"
                class="form-input"
                value="8"
                min="1"
                max="24"
                step="0.5"
              >
            </div>
            <div class="form-group">
              <label class="form-label">Working Days</label>
              <input
                type="text"
                id="peopleSidenavWorkingDays"
                class="form-input"
                value="Mon, Tue, Wed, Thu, Fri"
              >
              <p class="text-xs text-muted mt-1">
                Comma-separated day abbreviations
              </p>
            </div>
            <div class="form-group">
              <label class="form-label">Start Date</label>
              <input
                type="date"
                id="peopleSidenavStartDate"
                class="form-input"
              >
            </div>
          </div>
          <div class="sidenav-section">
            <div class="sidenav-section-title">Notes</div>
            <div class="form-group">
              <textarea
                id="peopleSidenavNotes"
                rows="3"
                class="form-textarea"
              ></textarea>
            </div>
          </div>
        </div>
        <div class="sidenav-footer">
          <button
            type="button"
            id="peopleSidenavDelete"
            class="btn-danger-ghost hidden"
          >
            Delete
          </button>
          <div class="flex-1"></div>
          <button
            type="button"
            id="peopleSidenavCancel"
            class="px-4 py-2 text-sm font-medium text-secondary bg-tertiary rounded-md hover:bg-active"
          >
            Cancel
          </button>
          <button type="submit" class="btn btn-primary ml-2">Save</button>
        </div>
      </form>
    </div>

    <!-- Help Panel -->
    <div id="helpPanel" class="sidenav-panel sidenav-sm">
      <div class="sidenav-header">
        <h2 class="sidenav-title">Help</h2>
        <button
          type="button"
          id="helpPanelClose"
          class="sidenav-close"
          aria-label="Close"
        >
          <svg
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M6 18L18 6M6 6l12 12"
            >
            </path>
          </svg>
        </button>
      </div>
      <div class="sidenav-content">
        <section id="helpContextSection" class="sidenav-section"></section>
        <section id="helpTipsSection" class="sidenav-section"></section>
        <section id="helpShortcutsSection" class="sidenav-section"></section>
        <section id="helpDocsSection" class="sidenav-section"></section>
      </div>
      <div class="sidenav-footer help-footer">
        <span class="help-footer-hint"
        >Press <kbd class="help-kbd">?</kbd> to toggle help</span>
      </div>
    </div>

    <!-- Meeting View Modal -->
    <div id="meetingViewModal" class="meeting-view-modal hidden">
      <div class="meeting-view-content">
        <div class="meeting-view-header">
          <div>
            <h2 id="meetingViewTitle" class="meeting-view-title"></h2>
            <div id="meetingViewMeta" class="meeting-view-meta"></div>
          </div>
          <button id="meetingViewClose" class="meeting-view-close" aria-label="Close">
            <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>
        <div class="meeting-view-body">
          <div id="meetingViewAgenda"></div>
          <div id="meetingViewNotes"></div>
          <div id="meetingViewActions"></div>
        </div>
      </div>
    </div>

    <!-- Confirm Modal -->
    <div id="confirmModalOverlay" class="confirm-modal-overlay hidden" role="dialog" aria-modal="true" aria-labelledby="confirmModalMessage">
      <div class="confirm-modal-box">
        <p id="confirmModalMessage" class="confirm-modal-message"></p>
        <div class="confirm-modal-footer">
          <button id="confirmModalCancel" class="btn">Cancel</button>
          <button id="confirmModalConfirm" class="btn-danger">Delete</button>
        </div>
      </div>
    </div>

    <script src="vendor/marked/marked.min.js"></script>

    <!-- OllamaUI vendors (highlight.js + marked-highlight; reuses marked above) -->
    <script src="vendors/ollamaui/highlight.min.js"></script>
    <script src="vendors/ollamaui/marked-highlight.umd.js"></script>

    <!-- OllamaUI modules (load order matters: state first, input last) -->
    <script src="modules/features/ollamaui/state.js"></script>
    <script src="modules/features/ollamaui/markdown.js"></script>
    <script src="modules/features/ollamaui/config.js"></script>
    <script src="modules/features/ollamaui/messages.js"></script>
    <script src="modules/features/ollamaui/chat.js"></script>
    <script src="modules/features/ollamaui/actions.js"></script>
    <script src="modules/features/ollamaui/input.js"></script>

    <script type="module" src="app.js"></script>

    <!-- Finances Sidenav -->
    <div id="financesSidenav" class="sidenav-panel sidenav-md">
      <div class="sidenav-header">
        <h2 id="financesSidenavHeader" class="sidenav-title">New Period</h2>
        <div class="flex items-center gap-2">
          <span id="financesSidenavSaveStatus" class="text-xs hidden"></span>
          <button type="button" id="financesSidenavClose" class="sidenav-close" aria-label="Close">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>
      </div>
      <div class="flex flex-col flex-1 overflow-hidden">
        <div class="sidenav-content">
          <div class="sidenav-section">
            <div class="form-group">
              <label class="form-label" for="financesSidenavPeriod">Period (YYYY-MM)</label>
              <input id="financesSidenavPeriod" type="text" class="form-input" placeholder="2026-01" />
            </div>
            <div class="form-group">
              <label class="form-label" for="financesSidenavCash">Cash on Hand ($)</label>
              <input id="financesSidenavCash" type="number" class="form-input" placeholder="0" min="0" />
            </div>
          </div>
          <div class="sidenav-section">
            <div class="finances-sidenav-section">
              <div class="finances-sidenav-section-label">Revenue</div>
              <div id="financesRevenueItems"></div>
              <button type="button" id="financesAddRevenueBtn" class="finances-add-item-btn">+ Add revenue item</button>
            </div>
          </div>
          <div class="sidenav-section">
            <div class="finances-sidenav-section">
              <div class="finances-sidenav-section-label">Expenses</div>
              <div id="financesExpenseItems"></div>
              <button type="button" id="financesAddExpenseBtn" class="finances-add-item-btn">+ Add expense item</button>
            </div>
          </div>
          <div class="sidenav-section">
            <div class="form-group">
              <label class="form-label" for="financesSidenavNotes">Notes</label>
              <textarea id="financesSidenavNotes" class="form-input" rows="3" placeholder="Optional notes..."></textarea>
            </div>
          </div>
        </div>
        <div class="sidenav-footer">
          <button type="button" id="financesDeleteBtn" class="btn-danger hidden">Delete</button>
          <button type="button" id="financesSidenavSave" class="btn-primary">Save</button>
        </div>
      </div>
    </div>
    <!-- Global Search Overlay -->
    <div id="globalSearchOverlay" class="search-overlay hidden" role="dialog" aria-modal="true" aria-label="Search">
      <div class="search-box">
        <div class="search-input-row">
          <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
          </svg>
          <input
            id="globalSearchInput"
            type="text"
            class="search-input-field"
            placeholder="Search tasks, notes, goals, ideas…"
            autocomplete="off"
            spellcheck="false"
          >
          <span class="search-kbd-hint">Esc</span>
        </div>
        <div id="globalSearchResults" role="listbox" aria-label="Search results"></div>
      </div>
    </div>
  </body>
</html>
